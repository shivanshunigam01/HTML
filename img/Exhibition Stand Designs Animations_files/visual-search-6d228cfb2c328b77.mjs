(self.modernJsonp=self.modernJsonp||[]).push([["91533"],{151219:function(e,t,a){var l,i,n;a.r(t),a.d(t,{default:()=>s});let o={fragment:{argumentDefinitions:l=[{defaultValue:null,kind:"LocalArgument",name:"pinId"}],kind:"Fragment",metadata:null,name:"MobileFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:i=[{kind:"Variable",name:"pin",variableName:"pinId"}],concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MobileFlashlightPageFetchData_pin"}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"MobileFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:i,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"736x")'},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}]},params:{id:"7cd65bb908c0282c47af2a2dc30819668fdb6b1e8614019a84c0ea7e8c4cad07",metadata:{},name:"MobileFlashlightPageFetchDataPinQuery",operationKind:"query",text:null}};o.hash="a0953a7ea15ce447a2452bbeca8586ba";let s=o},302609:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MobileFlashlightPageFetchData_pin",selections:[{args:null,kind:"FragmentSpread",name:"MobileFlashlightPage_pin"}],type:"Pin",abstractKey:null};l.hash="df8cf9d2521b1a82156cc4ecd7b04884";let i=l},875516:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MobileFlashlightPage_pin",selections:[{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"736x")'},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],type:"Pin",abstractKey:null};l.hash="a4c8c4488bd813d69ca9e96072e3d2d7";let i=l},40571:function(e,t,a){a.d(t,{Z:()=>i});var l=a(785893);let i=(0,l.jsx)("svg",{fill:"none",height:"5",viewBox:"0 0 37 5",width:"37",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("rect",{fill:"#E9E9E9",height:"5",rx:"2.5",width:"37"})})},835531:function(e,t,a){a.d(t,{Z:()=>s});var l=a(686659),i=a(667294),n=a(232079),o=a(785893);function s({alt:e,children:t,color:a,elementTiming:s,fetchPriority:r,isActive:c=!1,naturalHeight:u,naturalWidth:d,onLoad:h,src:p,fit:g="none",srcSet:m,..._}){(0,i.useEffect)(()=>{(0,l.Z)("ImageWithPerfTiming","/app/packages/pwt-logger/ImageWithPerfTiming.tsx")},[]);let f=(0,i.useRef)(null),y=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(p!==f.current||c&&c!==y.current){f.current=p??null;let e=document.querySelector(`img[src="${p}"]`)||null;e?.complete&&h()}y.current=c},[p,h,c]),(0,o.jsx)(n.Z,{..._,alt:e,color:a,elementTiming:s,fetchPriority:r,fit:g,naturalHeight:u,naturalWidth:d,onLoad:h,src:p,srcSet:m,children:t})}},415927:function(e,t,a){a.d(t,{Z:()=>i});var l=a(667294);let i=()=>{let e=(0,l.useRef)(!1);return(0,l.useEffect)(()=>(e.current=!0,()=>{e.current=!1}),[]),e}},962906:function(e,t,a){a.d(t,{DL:()=>d,ZP:()=>g,bh:()=>h,rv:()=>p});var l=a(686659),i=a(667294),n=a(740097),o=a(351736),s=a(935059),r=a(501010),c=a(254889),u=a(785893);let d=20,h=3,p=2;function g({handleBackClick:e,viewParameter:t,viewType:a}){(0,i.useEffect)(()=>{(0,l.Z)("MobileVisualSearchBackButton","/app/www/VisualSearch/mobile/MobileVisualSearchBackButton.tsx")},[]);let{checkExperiment:d}=(0,r.Z)(),g=(0,o.vs)(),{isAuth:m}=(0,s.Z)(),_=m&&d("mweb_onebar_hybrid_search",{dangerouslySkipActivation:!0}).anyEnabled;return(0,u.jsx)(n.xu,{"data-test-id":"cancelButton",left:!0,margin:p,position:"fixed",right:!0,top:!0,width:"fit-content",children:(0,u.jsx)(c.default,{bgColor:_?"white":"transparent",color:g||_?"darkGray":"white",disableRedirect:!0,icon:"cancel",isVisualSearch:!0,onTouch:e,padding:h,size:"lg",viewParameter:t,viewType:a})})}},304961:function(e,t,a){a.d(t,{AK:()=>u,R$:()=>n,S2:()=>c,Z3:()=>d,_z:()=>r,pV:()=>i,xZ:()=>o,zg:()=>s});var l=a(962906);let i=.6,n=.4,o=50,s=.1,r=l.DL+4*l.bh*2+4*l.rv*2,c=4,u=4.25,d=2.5},949221:function(e,t,a){a.d(t,{Z:()=>A});var l=a(686659),i=a(667294),n=a(740097),o=a(759271),s=a(24246),r=a(433069),c=a(835531),u=a(23641),d=a(774838),h=a(730448),p=a(739405),g=a(893957),m=a(530786),_=a(40763),f=a(785893);function y({children:e,isImagePinForUnauthOnTablet:t}){(0,i.useEffect)(()=>{(0,l.Z)("ClickthroughOverlay","/app/www/closeup/duplo/ClickthroughOverlay.tsx")},[]);let{isAuthenticated:a}=(0,d.B)(),o=(0,_.Z)({skipExpActivation:!0});return(0,f.jsxs)(n.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:"pointer",width:t?"40vw":void 0}},display:"flex",justifyContent:"center",left:!0,position:"absolute",right:!t||void 0,top:!0,zIndex:a?void 0:m.eu,children:[(0,f.jsx)(n.xu,{bottom:!0,dangerouslySetInlineStyle:{__style:{backgroundColor:"#000",borderRadius:o?void 0:"6px 6px 0 0",WebkitTransition:"opacity .04s linear",transition:"opacity .04s linear"}},left:!0,opacity:.4,position:"absolute",right:!0,top:!0}),e]})}var x=a(501010),b=a(923298),w=a(935833),S=a(736328),v=a(473687),P=a(671220);function k({setShowClickthroughOverlay:e,isEligibleForPdp:t,isEligibleForDesktopSocialInviteOverlay:a,inviterFirstName:o}){(0,i.useEffect)(()=>{(0,l.Z)("UnauthClickthroughOverlayContent","/app/www/closeup/duplo/unauth/UnauthClickthroughOverlayContent.tsx")},[]);let r=(0,s.Z)(),c=(0,S.Z)(),u=(0,b.Z)(),d=(0,i.useRef)(null),h="desktop"===(0,p.ZP)(),g=o&&a,m=g&&(r._('Sign up to join {{ name }} on Pinterest', 'pin.closeup.wash.desktop.shareNotification', 'Clickthrough overlay for desktop users that a sender ({{ name }}) shared a Pin to them, name: username')).replace("{{ name }}",o),_=r._('Click to make the most out of this idea with a free account', 'web.unauth.plp.clickable_wash.header', 'Copy shown on hover to sign up for an account'),y=r._('Tap to make the most out of this idea with a free account', 'mweb.unauth.plp.clickable_wash.header', 'Pin clickable wash header text'),k=(0,v.Z)(),{checkExperiment:T}=(0,x.Z)();return(0,f.jsx)(n.iP,{onMouseEnter:()=>{g&&(0,w.My)("dweb.main_pin.social.wash.view"),(0,w.My)("dweb.pin.wash.view")},onMouseLeave:()=>{g?c({action:"dismiss",item:"main-pin-social-wash"}):c({action:"dismiss",item:"main-pin-wash"})},onTap:({event:e})=>{h&&(e.preventDefault(),c({action:"click",item:"pin-image"}),a&&o&&c({action:"click",item:"main-pin-social-wash"}),c({action:"click",item:"main-pin-image-signup-modal"}),T("migration_upsell_manager_redux").anyEnabled||T("migration_upsell_manager_redux_dweb").anyEnabled||T("migration_upsell_manager_redux_mweb").anyEnabled||T("migration_upsell_manager_redux_dweb_global").anyEnabled||T("migration_upsell_manager_redux_mweb_global").anyEnabled?k((0,P.QA)()):u({reason:"UPSELL_LOGIN_OR_SIGNUP",attributionLabel:"click_closeup",desktopOptions:{modalType:"signup",modalOptions:{source:"defaultSource",container:"pinWash"}}}),t&&c({action:"click",item:"pdp-pin-image"}))},children:(0,f.jsxs)(n.xu,{zIndex:new n.Ry(2),children:[(0,f.jsx)(n.xu,{ref:d,alignItems:"center",bottom:!0,"data-test-id":"main-pin-hover-overlay",direction:"column",display:"flex",height:"100%",justifyContent:a?"center":void 0,left:!0,position:"absolute",right:!0,top:!0,width:"100%",children:(0,f.jsx)(n.xu,{alignItems:"center",direction:"column",display:"flex",maxWidth:240,paddingY:10,children:(0,f.jsx)(n.xu,{marginTop:8,children:(0,f.jsx)(n.qd,{align:"center",color:"light",size:g?"600":"400",children:h?m||_:y})})})}),!h&&(0,f.jsx)(n.xu,{marginEnd:4,marginTop:4,position:"absolute",right:!0,top:!0,children:(0,f.jsx)(n.hU,{accessibilityLabel:r._('Close pin clickable wash', 'mweb.unauth.plp.clickable_wash.close_button', 'Close button'),icon:"cancel",iconColor:"white",onClick:({event:t})=>{t.stopPropagation(),e&&(e(!1),c({action:"dismiss",item:"main-pin-hover-overlay"}))},size:"md"})})]})})}var T=a(407678),j=a(411657),F=a(767415),C=a(484807);let A=e=>{(0,i.useEffect)(()=>{(0,l.Z)("CloseupImage","/app/www/closeup/duplo/CloseupImage.tsx")},[]);let t=(0,s.Z)(),{alt:a,clickthroughOverlayOptions:m,color:x,isFlashlightPage:b,naturalHeight:w,naturalWidth:S,placeholder:v,pwtElementTimingId:P,setShowClickthroughOverlay:A,showSpinner:Z,src:E,stickyFooter:I,isEligibleForPdp:M}=e,D=!(0,r.b)(),{isAuthenticated:L}=(0,d.B)(),R=(0,p.ZP)(),z=(0,i.useRef)(null),H=(0,_.Z)({skipExpActivation:!0}),O=(0,i.useRef)(!1),{mWebCloseupRedesignEnabled:V}=(0,o.Z)(),[K,N]=(0,i.useState)(!D||!!E&&!!v&&v===E),B=(0,i.useRef)(""),W=()=>{(0,u.Nx)("PinPageMainImageRendered"),O.current||((0,F.nP)("mweb.closeup.closeup_image.load"),O.current=!0)};(0,i.useEffect)(()=>{let e=new Image;e.onload=()=>N(!0),e.src=E},[]);let U=(0,i.useRef)((0,j.u)()?.setHasScrolledPastMainContent);(0,i.useEffect)(()=>{let e=(0,h.Z)(()=>{if(z.current){let t=window.scrollY>z.current.offsetTop+z.current.offsetHeight;U.current?.(t),t&&window.removeEventListener("scroll",e)}},10);window.addEventListener("scroll",e)},[]),(0,g.Z)(()=>{E||(0,F.nP)("mweb.closeup.closeup_image.no_image_url"),(0===w||0===S)&&(0,F.nP)("mweb.closeup.closeup_image.invalid_dimensions")});let G=!b&&"tablet"===R,q=D?(0,f.jsx)(c.Z,{alt:a,color:x,elementTiming:P,naturalHeight:w,naturalWidth:S,onLoad:W,src:v}):null,$=T.Hg;return(b||"phone"===R||H)&&($="100%"),(0,f.jsx)(C.Z,{metricName:"CloseupImage",children:(0,f.jsxs)(n.xu,{ref:z,"data-test-id":"pin-closeup-image",maxHeight:"100%",maxWidth:"tablet"===R?T.g6:void 0,minHeight:"auto",overflow:I?void 0:"hidden",position:"relative",rounding:6*(!b&&"phone"!==R),width:$,children:[!L&&m&&(0,f.jsx)(y,{isImagePinForUnauthOnTablet:!1,children:(0,f.jsx)(k,{inviterFirstName:B.current,isEligibleForPdp:M,setShowClickthroughOverlay:A})}),q&&(G?(0,f.jsx)(n.xu,{overflow:"hidden",rounding:6,children:q}):q),(0,f.jsx)(n.xu,{bottom:!0,dangerouslySetInlineStyle:{__style:{opacity:+!!K,transition:K&&"desktop"!==R?"opacity .5s ease-in-out":void 0,backgroundColor:x}},left:!0,overflow:G?"hidden":void 0,position:D?"absolute":"relative",right:!0,rounding:G?6:5,top:!0,children:D?(0,f.jsx)(n.Ee,{alt:a,fetchPriority:V?"high":void 0,naturalHeight:w,naturalWidth:S,role:V?"img":void 0,src:E}):(0,f.jsx)(c.Z,{alt:a,color:x,elementTiming:P,fetchPriority:"high",naturalHeight:w,naturalWidth:S,onLoad:W,src:E})}),Z&&(0,f.jsx)(n.xu,{bottom:!0,dangerouslySetInlineStyle:{__style:{opacity:+!K,transition:K?"opacity .5s ease-in-out":void 0}},display:"flex",justifyContent:"center",left:!0,position:"absolute",right:!0,top:!0,children:!K&&(0,f.jsx)(n.kC,{alignItems:"center",justifyContent:"start",children:(0,f.jsx)(n.xH,{accessibilityLabel:t._('Loading image', 'Loading higher resolution image', 'Loading higher resolution image'),show:!0})})}),I]})})}},407678:function(e,t,a){a.d(t,{$K:()=>o,Hg:()=>i,g6:()=>n,w6:()=>l});let l=(e,t)=>Array.from({length:t-e},(t,a)=>a+e),i=508,n=600;function o(e){return null!=e}},847499:function(e,t,a){a.d(t,{By:()=>u,IT:()=>c,N6:()=>i,br:()=>n,jq:()=>s,lU:()=>r,tq:()=>o});var l=a(47755);let i=(e,t)=>({type:"UPDATE_CURRENT_SEARCH",payload:{query:e,scope:t}}),n=(e,t)=>({type:"UPDATE_RECENT_SEARCHES",payload:{query:e,scope:t}}),o=e=>({type:"UPDATE_RECENT_SEARCHES_BATCH",payload:{data:e}}),s=(e,t,a)=>({type:"UPDATE_TYPEAHEAD_CACHE",payload:{items:e,term:t,recent_queries_tags:a}}),r=(e,t,a)=>i=>{(0,l.Z)({url:"/v3/search/recent/",method:"DELETE",data:{vertical:e||void 0}}).then(t,a),i("PERSONAL"===e?{type:"CLEAR_RECENT_PERSONAL_SEARCHES"}:{type:"CLEAR_RECENT_SEARCHES"})},c=(e,t,a,i,n)=>o=>{a||(0,l.Z)({url:"/v3/search/recent/",method:"DELETE",data:{query:e,vertical:t||void 0}}).then(i,n),o("PERSONAL"===t?{type:"CLEAR_RECENT_PERSONAL_SEARCH",payload:{query:e}}:{type:"CLEAR_RECENT_SEARCH",payload:{query:e}})},u=e=>t=>{t({type:"RELOAD_VISUAL_SEARCH_ANNOTATIONS",payload:{pinId:e}})}},219043:function(e,t,a){a.d(t,{Z:()=>h});var l=a(686659),i=a(667294),n=a(740097),o=a(320197),s=a(609252),r=a(936367),c=a(986475),u=a(640200),d=a(785893);function h({oneBarModules:e,showIndicator:t,setProductFiltersModalIsOpen:a,showProductFilters:h=!1}){(0,i.useEffect)(()=>{(0,l.Z)("OneBar","/app/www/search/OneBar.tsx")},[]);let p=(0,i.useRef)(null),g=(0,i.useRef)(null),m=(0,i.useRef)(null),[_,f]=(0,i.useState)(0),y=e.map(e=>(0,c.Z)(u.Z,!0)(e));!function({pillsRef:e,oneBarModules:t,latestSelectedGuideX:a,setLatestSelectedGuideX:l}){(0,i.useEffect)(()=>{if(0!==a)return;let i=t.findIndex(e=>e.display?.isSelected);if(-1===i)return;let n=e.current;if(!n)return;let{children:o,clientWidth:s}=n,r=Array.from(o).slice(0,i+1).reduce((e,t)=>e+t.offsetWidth,0);r>s&&l(r)},[a,t,e,l])}({pillsRef:m,oneBarModules:y,latestSelectedGuideX:_,setLatestSelectedGuideX:f}),(0,i.useEffect)(()=>{setTimeout(()=>{g.current?.scrollTo({top:0,left:_,behavior:"smooth"})},1e3)},[_]);let x=new r.ZP;return(0,i.useEffect)(()=>{let e=p.current;return e&&s.Z.addObstruction("top",e),()=>{e&&s.Z.removeObstruction("top",e)}}),(0,d.jsx)(n.xu,{ref:p,color:"default","data-root-margin":"search-one-bar",height:54,overflow:"hidden",children:(0,d.jsx)(n.xu,{ref:g,"data-test-id":"mweb-onebar-search",height:64,overflow:"auto",children:(0,d.jsx)(n.kC,{ref:m,gap:1,maxWidth:"100%",children:y.map((e,l)=>(0,d.jsx)(o.Z,{hasProductFiltersApplied:t,impressionsFramework:x,index:l,module:e,oneBarModulesKey:null,onFilterButtonClick:()=>{h&&a?.(!0)},setLatestSelectedGuideX:f,showMWebProductFilters:h},`OneBarModule-${e.id||""}`))})})})}},859602:function(e,t,a){a.d(t,{Nu:()=>n,q:()=>i,r:()=>o,z5:()=>l});let l=["board_shop_tool_module","shop_tab_upsell","story_pins_search_upsell","structured_search_bubble","user_style_story_v2","search_story_separator","search_story_landing_page_header"],i="checklist_education_feed_card",n=["#CFFFCA","#D7EDFF","#DAD4FF","#DAFFF6","#FFE2EB","#FFE4C1","#FFFD92"],o={"#d7edff":"blueStrong","#002966":"blueStrong","#cfffca":"greenStrong","#ffe0e0":"redStrong","#800000":"redStrong","#dafff6":"blueWeak","#fffd92":"greenWeak","#c3f9c2":"greenWeak","#005f3e":"greenWeak","#ffe4c1":"orangeWeak","#842000":"orangeWeak","#ffe2eb":"redWeak","#e9e4ff":"purpleWeak","#400387":"purpleWeak","#dad4ff":"purpleWeak","#efefef":"base"}},3455:function(e,t,a){a.d(t,{Z:()=>eB});var l,i,n,o=a(686659),s=a(667294),r=a(935059),c=a(739405),u=a(119497);a(167912);var d=a(740097),h=a(183e3),p=a(631155),g=a(24246),m=a(661376),_=a(854897),f=a(228612),y=a(581722),x=a(312048),b=a(28031),w=a(400962),S=a(59111),v=a(134136),P=a(501010),k=a(112658),T=a(116980),j=a(575820),F=a(893957),C=a(128608),A=a(473156),Z=a(619784),E=a(958306),I=a(603284),M=a(919203),D=a(847499),L=a(104999),R=a(360033),z=a(40571),H=a(609252),O=a(774838),V=a(564377),K=a(935833),N=a(736328),B=a(211129),W=a(785893);function U(e,t,a){var l;return(t="symbol"==typeof(l=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var l=a.call(e,t||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?l:l+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}let G={baseStyles:{transitionProperty:"transform, opacity",transitionTimingFunction:"ease-out",transformOrigin:"bottom",touchAction:"none"}};class q extends s.Component{constructor(...e){super(...e),U(this,"state",{currentDistanceFromTop:this.props.maxDistanceFromTop?this.props.maxDistanceFromTop:-1,headerHeight:this.props.headerHeight||0,isAtTop:!1,scrollDirection:0,shouldAnimate:!1,startY:0,canScrollOnChildren:!1}),U(this,"onTouchStart",e=>{let{clientY:t}=e.touches[0];this.setState({startY:t,shouldAnimate:!1,scrollDirection:0})}),U(this,"onTouchMove",e=>{let{clientY:t}=e.touches[0],{startY:a,currentDistanceFromTop:l}=this.state,{canMoveModal:i,maxDistanceFromTop:n}=this.props,o=t-a;i&&void 0!==n&&(o>0&&l>=0&&l<n&&window.scrollY<=0||o<0&&l<=n&&l>=0)&&this.setModalPosition(t)}),U(this,"onTouchEnd",()=>{let{entryPoint:e,minDistanceFromTop:t,canMoveModal:a}=this.props;this.props.shouldSnapToEnds&&2===this.state.scrollDirection?(this.header&&H.Z.removeObstruction("top",this.header),this.setState({canScrollOnChildren:!1,currentDistanceFromTop:this.props.maxDistanceFromTop,shouldAnimate:!0,isAtTop:!1}),e&&(0,K.My)(`mweb.${e}.snap_to_bottom`)):this.props.shouldSnapToEnds&&1===this.state.scrollDirection&&(this.state.isAtTop?this.setState({currentDistanceFromTop:0,shouldAnimate:!0}):this.setState({canScrollOnChildren:!!a,currentDistanceFromTop:t||0,shouldAnimate:!0,isAtTop:!0}),this.header&&H.Z.addObstruction("top",this.header),e&&(0,K.My)(`mweb.${e}.sliding_modal.snap_to_top`))}),U(this,"handleHandleMove",e=>{let{clientY:t}=e.touches[0],{canMoveModal:a,maxDistanceFromTop:l,minDistanceFromTop:i}=this.props,{startY:n,currentDistanceFromTop:o}=this.state;a&&o<=(i||0)&&t-n>0&&(e.stopPropagation(),this.setState({canScrollOnChildren:!1,currentDistanceFromTop:l,isAtTop:!1,scrollDirection:0,shouldAnimate:!0,startY:0}))}),U(this,"handleHeaderTouch",()=>{let{maxDistanceFromTop:e,minDistanceFromTop:t,entryPoint:a,canMoveModal:l}=this.props,{currentDistanceFromTop:i,scrollDirection:n}=this.state;0===n&&(i===e?(this.setState({canScrollOnChildren:!!l,currentDistanceFromTop:t||0,shouldAnimate:!0,isAtTop:!0}),(0,K.My)(`mweb.${a}.sliding_modal.header_touch.snap_to_top`)):e&&(this.setState({canScrollOnChildren:!1,currentDistanceFromTop:e,shouldAnimate:!0,isAtTop:!1}),(0,K.My)(`mweb.${a}.sliding_modal.header_touch.snap_to_bottom`)))}),U(this,"handleCloseIconTouch",e=>{let{currentDistanceFromTop:t}=this.state,{onDismiss:a,logContextEvent:l,maxDistanceFromTop:i,viewParameter:n,viewType:o}=this.props;e.stopPropagation(),a&&(l({aux_data:{commerce_data:JSON.stringify({snapped_top:0===t})},element:75,event_type:102,view_parameter:n,view_type:o}),this.setState({currentDistanceFromTop:i,startY:0,scrollDirection:0},()=>a(e)))}),U(this,"getModalStyles",()=>{let{shouldSnapToEnds:e}=this.props,{currentDistanceFromTop:t,shouldAnimate:a,canScrollOnChildren:l}=this.state,{baseStyles:i}=G;return{...i,animation:"modalReveal 0.3s ease-out both",position:l?"absolute":"fixed",top:t>-1?t:void 0,bottom:0,width:"100vw",...e&&a?{transitionDuration:"500ms",transitionProperty:"transform, opacity, top"}:Object.freeze({})}}),U(this,"setModalPosition",e=>{let{startY:t,currentDistanceFromTop:a}=this.state,{maxDistanceFromTop:l,snapToEndThreshold:i,entryPoint:n}=this.props;if(l){let o=e-t,s=Math.floor("CloseupShop"===n||"CloseUpMainPinDrawer"===n?Math.max(0,a+o):Math.min(l,Math.max(0,a+o))),r=0;if(void 0!==i&&i>=0){let e=Math.floor(i*l),t=Math.floor((1-i)*l);o<0?r=s>t?2:1:o>0&&(r=s>e?2:1)}this.setState({startY:e,currentDistanceFromTop:s,scrollDirection:r})}})}componentDidMount(){let{isOpen:e}=this.props;e&&H.Z.pause()}componentDidUpdate(e,t){let{domainFilters:a,priceFilters:l,cropSource:i,isOpen:n,logContextEvent:o,maxDistanceFromTop:s,setHasDraggedDrawerToFullScreen:r,minDistanceFromTop:c,entryPoint:u}=this.props,{currentDistanceFromTop:d}=this.state;n&&!e.isOpen?H.Z.pause():!n&&e.isOpen&&H.Z.resume(),"CloseUpMainPinDrawer"===u&&s<e.maxDistanceFromTop&&d>s&&this.handleHeaderTouch(),t.currentDistanceFromTop!==(e.minDistanceFromTop||0)&&d===(c||0)&&r&&r(!0),a&&l&&(!(0,R.ZP)(a,e.domainFilters)||!(0,R.ZP)(l,e.priceFilters))&&o({event_type:13,view_parameter:"related_products"===(0,B.Z)(i)?3455:3456,view_type:72,element:11735})}componentWillUnmount(){let{isOpen:e}=this.props;this.header&&H.Z.removeObstruction("top",this.header),e&&H.Z.resume()}render(){let{children:e,headerChildren:t,heading:a,isAuth:l,isInHSObjLevelOneBarExp:i,isOpen:n,isRTL:o,mobileAccessibilityCloseIconLabel:s,mobileHideCloseIcon:r,noDivider:c,showHandle:u}=this.props,{headerHeight:h,canScrollOnChildren:p}=this.state,g=p||!l||i?"0":"32px 32px 0 0";return n?(0,W.jsx)(V.Z,{children:(0,W.jsx)(d.xu,{"aria-label":a,role:"dialog",children:(0,W.jsx)(d.xu,{color:"default",dangerouslySetInlineStyle:{__style:{...this.getModalStyles(),borderRadius:g}},"data-test-id":"sliding-modal-events-handler",onTouchEnd:this.onTouchEnd,onTouchMove:this.onTouchMove,onTouchStart:this.onTouchStart,children:(0,W.jsxs)(d.iP,{accessibilityLabel:this.props.i18n._('View all search results', 'SlidingModal.Header.a11yLabel', 'Accessibility label for header of search results in flashlight'),onTap:this.handleHeaderTouch,children:[(0,W.jsxs)(d.Le,{top:h||0,children:[u&&(0,W.jsx)(d.xu,{color:"default",dangerouslySetInlineStyle:{__style:{padding:"8px 0 24px 0",borderRadius:g}},"data-test-id":"slidingModalHandle",display:"flex",justifyContent:"center",onTouchMove:this.handleHandleMove,children:z.Z}),i&&(0,W.jsxs)(d.xu,{alignItems:"center",color:"default",display:this.state.isAtTop?"flex":"none",height:60,justifyContent:"center",opacity:+!!this.state.isAtTop,position:"relative",children:[(0,W.jsx)(d.xu,{alignItems:"center",display:"flex",left:!0,marginStart:2,padding:3,position:"absolute",children:(0,W.jsx)(d.JO,{accessibilityLabel:this.props.i18n._('Close sliding modal', 'slidingModal.hybridSearch.closeModal', 'Accessibility label for close icon on top of slider modal'),color:"default",icon:"arrow-down",size:"20"})}),(0,W.jsx)(d.kC,{alignItems:"stretch",flex:"grow",justifyContent:"center",children:(0,W.jsx)(d.xe,{size:"300",weight:"bold",children:this.props.i18n._('More like this', 'slidingModal.hybridSearch.moreLikeThis', 'top of slider modal to show similar pins with hybrid search')})})]}),!r&&(0,W.jsxs)(d.xu,{ref:e=>{this.header=e},color:"default",rounding:2,children:[(0,W.jsxs)(d.kC,{alignItems:"center",flex:"grow",justifyContent:"start",children:[(0,W.jsx)(d.kC,{alignItems:"center",justifyContent:"start",children:(0,W.jsx)(d.hU,{accessibilityLabel:s||"Close visual search results",dataTestId:"close-visual-search-results",icon:"arrow-back",iconColor:"subtle",onClick:({event:e})=>this.handleCloseIconTouch(e),padding:5,size:"lg"})}),(0,W.jsx)(d.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:function({filterIconShown:e,isRTL:t}){let a=t?"marginRight":"marginLeft",l=t?"marginLeft":"marginRight";return e?{[a]:38,[l]:50,marginTop:15,marginBottom:15}:{[a]:-10,[l]:50,marginTop:15,marginBottom:15}}({isRTL:o})},"data-test-id":"slidingModalHeader",display:"flex",flex:"grow",justifyContent:"center",children:(0,W.jsx)(d.qd,{accessibilityLevel:2,align:"center",size:"400",children:a})})]}),t||null,!c&&(0,W.jsx)(d.iz,{})]})]}),(0,W.jsx)(d.xu,{overflow:p?"auto":"visible",children:e})]})})})}):null}}function $(e){(0,s.useEffect)(()=>{(0,o.Z)("SlidingModal","/app/www/SlidingModal.tsx")},[]);let t=(0,g.Z)(),a=(0,L.Z)(),{isRTL:l}=(0,O.B)(),i=(0,N.Z)(),{isAuth:n}=(0,r.Z)(),{checkExperiment:c}=(0,P.Z)(),u=n&&c("mweb_onebar_hybrid_search",{dangerouslySkipActivation:!0}).anyEnabled;return(0,W.jsx)(q,{...e,i18n:t,isAuth:n,isInHSObjLevelOneBarExp:u,isRTL:l,logContextEvent:a,trackInteraction:i})}var Q=a(304961),J=a(806513),Y=a(285676),X=a(658337),ee=a(645479),et=a(838855),ea=a(230201),el=a(978387);function ei(){let[e,t]=(0,s.useState)(0),[a,l]=(0,s.useState)(0),[i,n]=(0,s.useState)(!1),[o,r]=(0,s.useState)(!1),[c,u]=(0,s.useState)(void 0);function d(){r(!1),n(!1),u(void 0)}function h(e,t){"vertical"!==t&&e.stopPropagation()}return{onCarouselTouchStart:function(e){let{clientX:a,clientY:i}=e.touches[0];t(a),l(i),d()},onCarouselTouchMove:function(t){let{clientX:l,clientY:s}=t.touches[0],d=Math.abs(l-e);Math.abs(s-a)>10&&n(!0),d>10&&r(!0),o&&i?u(e=>e||"vertical"):o?u(e=>e||"horizontal"):i?u(e=>e||"vertical"):u(void 0),h(t,c)},onCarouselTouchEnd:function(e){h(e,c),d()}}}function en({data:e,pinId:t,surfaceType:a,viewParameter:l,viewType:i}){(0,s.useEffect)(()=>{(0,o.Z)("MobileVisualSearchCarousel","/app/www/VisualSearch/mobile/Feed/MobileVisualSearchCarousel.tsx")},[]);let n=(0,c.Wb)(),r=(0,g.Z)(),{logContextEvent:u}=(0,ea.u)(),{width:h}=(0,b.Z)()||{},{onCarouselTouchStart:p,onCarouselTouchMove:m,onCarouselTouchEnd:_}=ei(),f=(e?.results||[]).find(e=>"story"===e.type),{url:y=`/pin/${t}`,text:x=""}=f?.action||{},w=r._('Shop similar', 'mobileFlashlight.productUpsellTitle', 'Shop similar products from the image.');function S(){u({component:14339,element:179,event_type:102,view_parameter:l,view_type:i})}return f&&"stl"!==a?(0,W.jsxs)(d.xu,{children:[(0,W.jsxs)(d.xu,{alignItems:"center",direction:"row",display:"flex",justifyContent:"between",marginBottom:2,paddingX:Q.S2,children:[(0,W.jsx)(d.Tg,{href:y,onTap:({event:e})=>{e.stopPropagation(),S()},tapStyle:"compress",children:(0,W.jsx)(d.qd,{accessibilityLevel:2,size:"400",children:w})}),(0,W.jsx)(d.I_,{accessibilityLabel:x||r._('See more', 'headerModule.headerModuleActionButton.iconButton', 'An right arrow icon button to show more similar pins to the user in a new page'),bgColor:"transparent",dataTestId:"product-upsell-action-button",href:y,icon:"arrow-forward",iconColor:"default",onClick:S,size:"sm"})]}),(0,W.jsx)(d.xu,{dangerouslySetInlineStyle:{__style:{touchAction:"pan-x",overflowY:"hidden"}},onTouchEnd:_,onTouchMove:m,onTouchStart:p,children:(0,W.jsx)(el.default,{component:14339,contentVisibleItemCountOverride:n?Q.AK:Q.Z3,disableHeader:!0,story:f,storyKey:f?{type:"Legacy",data:f}:null,surface:"ShoppingDynamicHeightGrid",view:i,viewParameter:l,width:h})})]}):null}var eo=a(433100),es=a(986475),er=a(640200),ec=a(148),eu=a(219043);function ed({auxData:e}){(0,s.useEffect)(()=>{(0,o.Z)("MobileVisualSearchOneBar","/app/www/VisualSearch/mobile/Feed/MobileVisualSearchOneBar.tsx")},[]);let{onCarouselTouchStart:t,onCarouselTouchMove:a,onCarouselTouchEnd:l}=ei(),i=e?.metadata?.one_bar_modules,n=(0,es.Z)(er.Z,!0)(i);return n&&n.length>0?(0,W.jsx)(ec.v,{children:(0,W.jsx)(eo.f,{children:(0,W.jsx)(d.xu,{marginBottom:4,onTouchEnd:l,onTouchMove:a,onTouchStart:t,paddingX:2,children:(0,W.jsx)(d.iP,{onTap:({event:e})=>e.stopPropagation(),children:(0,W.jsx)(eu.Z,{oneBarModules:n})})})})}):null}function eh({auxData:e,isShopTheLookFeed:t,pinId:a,searchResourceOptions:l,surfaceType:i,viewParameter:n,viewType:r}){(0,s.useEffect)(()=>{(0,o.Z)("MobileVisualSearchFeed","/app/www/VisualSearch/mobile/Feed/MobileVisualSearchFeed.tsx")},[]);let c=(0,g.Z)(),{auxData:u,data:h,fetchMore:p,isAtEnd:_,isFetching:f,isLoaded:y}=(0,m.Z)({name:"VisualSearchFlashlightUnifiedResource",options:l}),x=(h?.results||[]).flatMap(e=>"pin"===e.type?e:[]),b=c._('Image search', 'mobileFlashlight.organicFeedTitle', 'Search results from the image.'),w=c._('Shop the look', 'mobileFlashlight.shopTheLookFeedTitle', 'Shop the look for similar products from the cropped image.');return y?(0,W.jsxs)(s.Fragment,{children:[(0,W.jsx)(ed,{auxData:u}),(0,W.jsx)(en,{data:h,pinId:a,surfaceType:i,viewParameter:n,viewType:r}),(0,W.jsx)(d.xu,{"data-test-id":t?"shop-the-look-feed-title":"organic-feed-title",marginBottom:3,paddingX:Q.S2,children:(0,W.jsx)(d.qd,{accessibilityLevel:2,size:"400",children:t?w:b})}),(0,W.jsx)(d.xu,{color:"default",dangerouslySetInlineStyle:{__style:{touchAction:"pan-y"}},"data-test-id":t?"shop-the-look-feed":"organic-feed",paddingX:J.D6,children:(0,W.jsx)(et.Z,{feedItems:x,feedKey:(0,X.J)("VisualSearchFlashlightUnifiedResource",l)??"",pagination:{loadNext:p||(()=>void 0),hasNext:!_,isLoadingNext:f||!1,refetch:()=>void 0},renderFeedItem:(a,l)=>(0,W.jsx)(ee.Z,{children:(0,W.jsx)(Y.Z,{auxData:e,componentType:0,duploQueryRef:null,pinId:a.id??"",slotIndex:l,trackingParams:a.tracking_params||void 0,trafficSource:t?"shop_feed":void 0,viewParameter:n,viewType:r})})})})]}):(0,W.jsx)(d.xH,{accessibilityLabel:c._('Loading visual search results', 'mobileFlashlightPage.loadingSpinner', 'Spinner for loading the visual search result'),show:!0})}function ep({isShopTheLookFeed:e,searchResourceOptions:t,viewParameter:a,viewType:l}){(0,s.useEffect)(()=>{(0,o.Z)("UnauthMobileVisualSearchFeed","/app/www/VisualSearch/mobile/Feed/UnauthMobileVisualSearchFeed.tsx")},[]);let{data:i,fetchMore:n,isAtEnd:r,isFetching:c}=(0,m.Z)(e?{name:"VisualSearchFlashlightUnifiedResource",options:t}:{name:"VisualLiveSearchResource",options:t});return(0,W.jsx)(d.xu,{color:"default",paddingX:J.D6,children:(0,W.jsx)(et.Z,{feedItems:i?.results??[],feedKey:(0,X.J)("VisualLiveSearchResource",t)??"",pagination:{loadNext:n||(()=>void 0),hasNext:!r,isLoadingNext:c||!1,refetch:()=>void 0},renderFeedItem:(e,t)=>(0,W.jsx)(ee.Z,{children:(0,W.jsx)(Y.Z,{componentType:0,duploQueryRef:null,pinId:e.id??"",slotIndex:t,trackingParams:e.tracking_params,trafficSource:"flashlight",viewParameter:a,viewType:l})})})})}var eg=a(962906),em=a(407678);function e_(){return Math.min(em.g6,window.innerWidth)}function ef(e,t){return Math.floor(e_()/t*e)}var ey=a(415927),ex=a(976892),eb=a(47239),ew=a(615440),eS=a(743222),ev=a(949221);function eP({pinDominantColor:e,url:t,closeupImageWidth:a,closeupImageHeight:l}){(0,s.useEffect)(()=>{(0,o.Z)("CropperCloseupImage","/app/www/VisualSearch/mobile/CropperCloseupImage.tsx")},[]);let i=(0,g.Z)();return(0,W.jsx)(ev.Z,{alt:i._('Pin image', 'flashlight.cropper.closeupImage', 'Pin closeup image'),color:e,isFlashlightPage:!0,naturalHeight:l,naturalWidth:a,placeholder:t,pwtElementTimingId:"cropper-closeup-image",showSpinner:!1,src:t})}let ek=e=>{(0,s.useEffect)(()=>{(0,o.Z)("CropperHandle","/app/www/VisualSearch/mobile/CropperHandle.tsx")},[]);let{alt:t,src:a,top:l,left:i}=e;return(0,W.jsx)(d.xu,{dangerouslySetInlineStyle:{__style:{top:l,left:i}},height:24,position:"absolute",width:24,children:(0,W.jsx)(d.Ee,{alt:t,color:"transparent",naturalHeight:24,naturalWidth:24,src:a})})},eT={backgroundColor:"#000000",opacity:"0.4"};function ej({closeupImageUrl:e,closeupImageDims:t,cropArea:{x:a,y:l,w:i,h:n},disableBorder:r,disableHandles:c,handleBackClick:u,onTouchEnd:h,onTouchMove:p,onTouchStart:m,pinDominantColor:_,showBackButton:f,viewParameter:y}){(0,s.useEffect)(()=>{(0,o.Z)("Cropper","/app/www/VisualSearch/mobile/Cropper.tsx")},[]);let x=(0,g.Z)(),{closeupImageWidth:b,closeupImageHeight:w}=t,S=Math.floor(w*l),v=Math.floor(b*a),P=Math.floor(w*n),k=Math.floor(b*i),T=v+k,j=S+P;return(0,W.jsxs)(d.xu,{"data-test-id":"cropper-container",onTouchEnd:h,onTouchMove:p,onTouchStart:m,position:"relative",children:[(0,W.jsx)(eP,{closeupImageHeight:w,closeupImageWidth:b,pinDominantColor:_,url:e??""}),(0,W.jsx)(d.xu,{dangerouslySetInlineStyle:{__style:eT},height:S,left:!0,position:"absolute",top:!0,width:"100%"}),(0,W.jsx)(d.xu,{dangerouslySetInlineStyle:{__style:{...eT,top:S}},height:P,left:!0,position:"absolute",width:v}),(0,W.jsx)(d.xu,{dangerouslySetInlineStyle:{__style:{...eT,top:S,left:T}},height:P,position:"absolute",right:!0}),(0,W.jsx)(d.xu,{bottom:!0,dangerouslySetInlineStyle:{__style:{...eT,top:j}},left:!0,position:"absolute",width:"100%"}),!c&&(0,W.jsxs)(d.xu,{"data-test-id":"CropperHandles",children:[(0,W.jsx)(ek,{alt:x._('Top left cropper handle', 'flashlight.cropper.topLeftHandle', 'top left handle for cropping image'),left:v-9,src:ew,top:S-9}),(0,W.jsx)(ek,{alt:x._('Top right cropper handle', 'flashlight.cropper.topRightHandle', 'top right handle for cropping image'),left:T-15,src:eS,top:S-9}),(0,W.jsx)(ek,{alt:x._('Bottom left cropper handle', 'flashlight.cropper.bottomLeftHandle', 'bottom left handle for cropping image'),left:v-9,src:ex,top:j-15}),(0,W.jsx)(ek,{alt:x._('Bottom right cropper handle', 'flashlight.Cropper.BottomLeftHandle', 'bottom right handle for cropping image'),left:T-15,src:eb,top:j-15})]}),(0,W.jsx)(d.xu,{dangerouslySetInlineStyle:{__style:{top:S-2,left:v-2,border:r?void 0:"2px solid #ffffff"}},"data-test-id":"CroppedArea",height:P+4,position:"absolute",rounding:2,width:k+4}),f&&(0,W.jsx)(eg.ZP,{handleBackClick:u,viewParameter:y,viewType:427})]})}var eF=a(383903);function eC({auxData:e,onClick:t,shouldLogDotRender:a,showNoHalo:l,style:i,viewParameter:n,x:r,y:c}){(0,s.useEffect)(()=>{(0,o.Z)("Dot","/app/www/VisualSearch/mobile/Dot.tsx")},[]);let u=(0,g.Z)(),h=(0,L.Z)();return(0,F.Z)(()=>{a&&h({aux_data:e,element:1221,event_type:120,view_parameter:n,view_type:72})}),(0,W.jsx)("div",{"aria-label":u._('Select a specific item on image', 'dot.accessibilityLabel', 'Accessibility label for <Dot /> component'),"data-test-id":"dot",onClick:t,onKeyPress:t,role:"button",style:{position:"absolute",top:c-16,left:r-16,outline:"none",...i},tabIndex:0,children:(0,W.jsx)(d.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:l?void 0:"rgba(0, 0, 0, 0.1)",width:32,height:32,border:"none",borderRadius:32,cursor:t?"pointer":"default"}},children:(0,W.jsx)(d.xu,{alignItems:"center",color:"light",dangerouslySetInlineStyle:{__style:{boxShadow:"none",width:16,height:16,border:"none",borderRadius:16,top:8,left:8}},display:"flex",justifyContent:"center",padding:0,position:"absolute"})})})}var eA=a(496102);let eZ="flashlightDotPop",eE=(0,eA.Ll)([`
  ${eZ} {
      0% {
          opacity: 0;
          transform: scale(0);
      }

      100% {
          opacity: 1;
          transform: scale(1);
      }
  }
`,`labelReveal {
    0% {
      transform: scale(0, 1)
    }

    100% {
      transform: scale(1, 1)
    }
  }
`]);function eI({closeupImageTop:e,imageHeight:t,imageTop:a,imageWidth:l,onDotTap:i,pinId:n,pinImageSignature:r,setCropArea:c,shouldLogDotRender:u,showNoHalo:d,viewParameter:h,visualObjects:p,visualObjectToHide:g}){(0,s.useEffect)(()=>{(0,o.Z)("Dots","/app/www/VisualSearch/mobile/Dots.tsx")},[]);let m=(0,L.Z)();return(0,W.jsxs)(s.Fragment,{children:[(0,W.jsx)(S.Z,{unsafeCSS:eE}),p.map((o,s)=>{if(s===g)return null;let{x:_=0,y:f=0,w:y=0,h:x=0}=o,b={x:_,y:f,h:x,w:y},w=(0,eF.Z)({cropArea:{x:_,y:f,w:y,h:x},scaledWidth:l,scaledHeight:t}),S=Math.floor(w.x+w.w/2),v=Math.floor(w.y+a+w.h/2),P=(e=>{let t=parseFloat((.1*e).toFixed(2));return{animation:`${eZ} 0.3s ease-out ${t}s both`}})(s),k={pin_id:n,image_signature:r,visual_objects:JSON.stringify([b]),commerce_data:JSON.stringify({entrypoint:"flashlight",pin_is_stela:"false"})};return(0,W.jsx)(eC,{auxData:k,onClick:function(){m({aux_data:k,element:1221,event_type:102,view_parameter:h,view_type:72}),i({cropArea:b,cropSource:4,visualObjects:p}),c?.(b)},shouldLogDotRender:u,showNoHalo:d,style:P,viewParameter:h,x:S,y:v-e},JSON.stringify(b))})]})}function eM({closeupImageUrl:e,closeupImageDims:t,cropArea:a,handleBackClick:l,handleChangeCloseupImageTop:i,handleCropperChange:n,headerHeight:c,pinDominantColor:u,pinId:h,pinImageSignature:p,showBackButton:g,viewParameter:m,visualObjects:_,visualObjectToHide:f}){(0,s.useEffect)(()=>{(0,o.Z)("VisualSearch","/app/www/VisualSearch/mobile/VisualSearch.tsx")},[]);let y=(0,L.Z)(),{isAuth:x}=(0,r.Z)(),b=(0,s.useRef)(null),[w,S]=(0,s.useState)(0),[v,P]=(0,s.useState)(0),[k,T]=(0,s.useState)(10),[j,F]=(0,s.useState)(a),{current:C}=(0,ey.Z)(),{x:A,y:Z,w:E,h:I}=j,{closeupImageTop:M,closeupImageMinTop:D,closeupImageWidth:R,closeupImageHeight:z,minCropperWidthRatio:H,minCropperHeightRatio:O}=t,V=c||0;return(0,W.jsx)(d.kC,{justifyContent:"center",width:"100vw",children:(0,W.jsxs)(d.xu,{ref:b,dangerouslySetInlineStyle:{__style:{top:M,touchAction:"none"}},maxWidth:em.g6,overflow:"hidden",position:"fixed",width:"100%",children:[(0,W.jsx)(ej,{closeupImageDims:t,closeupImageUrl:e,cropArea:j,handleBackClick:l,onTouchEnd:()=>{[10,0].includes(k)||(y({event_type:1===k?7603:7604,view_parameter:m,view_type:72}),n({cropArea:j,cropSource:6,visualObjects:_}))},onTouchMove:e=>{let{clientX:t,clientY:a}=e.touches[0];if(S(t),P(a),10===k&&T(((e,t)=>{let a=t-M,l=e-(b.current?b.current.getBoundingClientRect().left:0),i=z*Z,n=z*(Z+I),o=R*A,s=R*(E+A);if(a>i+12&&a<n-12&&l>o+12&&l<s-12)return 1;if(l<=o+12&&l>=o-12&&a>=i+15&&a<=n-15)return 2;if(l<=s+12&&l>=s-12&&a>=i+15&&a<=n-15)return 3;if(l<=s-15&&l>=o+15&&a>=i-12&&a<=i+12)return 4;if(l<=s-15&&l>=o+15&&a>=n-12&&a<=n+12)return 5;if(l<=o-9+24&&l>=o-12&&a>=i-12&&a<=i+24-9)return 6;if(l<=s+12&&l>=s-15&&a>=i-12&&a<=i+24-9)return 7;else if(l<=o-9+24&&l>=o-12&&a>=n-15&&a<=n+12)return 8;else if(l<=s+12&&l>=s-15&&a>=n-15&&a<=n+12)return 9;else return 0})(t,a)),null!=H&&null!=O&&null!=D){let e=a-v,l=(t-w)/R,n=e/z,o=Math.min(A+E-H,Math.max(0,A+l)),s=E+(A-o),r=Math.min(Z+I-O,Math.max(0,Z+n)),c=I+(Z-r),u=Math.min(1-A,Math.max(H,E+l)),d=Math.min(1-Z,Math.max(O,I+n));switch(k){case 0:i(Math.floor(Math.max(D,Math.min(V,M+e))));break;case 1:F(e=>({...e,x:Math.max(0,Math.min(1-E,A+l)),y:Math.max(0,Math.min(1-I,Z+n))}));break;case 2:F(e=>({...e,x:o,w:s}));break;case 3:F(e=>({...e,w:u}));break;case 4:F(e=>({...e,y:r,h:c}));break;case 5:F(e=>({...e,h:d}));break;case 6:F({x:o,w:s,y:r,h:c});break;case 7:F(e=>({...e,w:u,y:r,h:c}));break;case 8:F(e=>({...e,h:d,x:o,w:s}));break;case 9:F(e=>({...e,h:d,w:u}))}}},onTouchStart:e=>{let{clientX:t,clientY:a}=e.touches[0];S(t),P(a),T(10)},pinDominantColor:u,showBackButton:g,viewParameter:m}),!!_.length&&0!==z&&0!==R&&(0,W.jsx)(d.xu,{"data-test-id":"FlashlightDots",children:(0,W.jsx)(eI,{closeupImageTop:M,imageHeight:z,imageTop:M,imageWidth:R,onDotTap:n,pinId:h,pinImageSignature:p,setCropArea:F,shouldLogDotRender:!C,showNoHalo:x,viewParameter:m,visualObjects:_,visualObjectToHide:f})})]})})}let eD=`
  html, body {
    overscroll-behavior: none;
  }
`,eL=(void 0!==l||(l=a(875516)).hash&&"a4c8c4488bd813d69ca9e96072e3d2d7"!==l.hash&&console.error("The definition of 'MobileFlashlightPage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function eR({pinKey:e}){(0,s.useEffect)(()=>{(0,o.Z)("MobileFlashlightPage","/app/www/VisualSearch/mobile/MobileFlashlightPage.tsx")},[]);let t=(0,g.Z)(),a=(0,y.I0)(),l=(0,x.s0)(),{previous:i}=(0,w.ou)(),n=(0,x.TH)(),{isAuth:u}=(0,r.Z)(),{width:p}=(0,b.Z)()||{},m=(0,c.ZP)(),_=(0,h.Z)(eL,e),{checkExperiment:f}=(0,P.Z)(),L=u&&f("mweb_onebar_hybrid_search",{dangerouslySkipActivation:!0}).anyEnabled,R=(0,j.mB)(n.search),{cropSource:z,filters:H,hybrid_search_param:O,journey_depth:V,search_query:K,source_module_id:N,x:B,y:U,h:G,w:q,surfaceType:J,requestParams:Y}=R,X=J||"flashlight",ee=!u&&(0,T.x9)(m)||void 0,[et,ea]=(0,s.useState)(()=>{var e,t,a;let l,i,n=function({headerHeight:e,pinImageHeight:t,pinImageWidth:a}){let l=0,i=0,n=0;return t&&a&&(l=e_(),i=ef(t,a),n=Math.min(Math.floor(Q.pV*window.innerHeight),ef(t,a))),{closeupImageWidth:l,closeupImageHeight:i,closeupImageMinTop:n-i,closeupImageTop:e||0,minCropperWidthRatio:l?Q.xZ/l:0,minCropperHeightRatio:i?Q.xZ/i:0,modalTop:n}}({headerHeight:ee,pinImageHeight:_.imageSpec_736x?.height,pinImageWidth:_.imageSpec_736x?.width}),{closeupImageHeight:o,modalTop:s}=n,r=(e=Number(G),t=Number(U),a=ee||0,l=e?Number(e):Q.R$,i=t?Number(t):Q.zg,o>0&&s>0&&(e||(l=(s-2*s*Q.zg-a)/o),t||(i=s*Q.zg/o)),{h:l,y:i});return{closeupImageDims:n,x:B?Number(B):Q.zg,w:q?Number(q):1-2*Q.zg,y:r.y,h:r.h}}),[el,ei]=(0,s.useState)(()=>(0,A.Z)(Number(z))||(B&&U&&G&&q?6:5)),en={x:et.x,y:et.y,w:et.w,h:et.h},eo="stl"===X&&4===el,es=function({cropSource:e,surfaceType:t,isProductPage:a,queryEntrypoint:l}){return l||("stl"===t&&4===e?"shop_the_look_module":a?"feed_module":null)}({cropSource:el,isProductPage:!1,surfaceType:X,queryEntrypoint:R.entrypoint}),er={pin_id:_?.entityId,crop:en,crop_source:el,is_shopping:eo,entry_source:eo?"shopping":"flashlight",entrypoint:es,filters:H,hybrid_search_param:O,journey_depth:parseInt(V,10)||void 0,search_query:K,source_module_id:N},ec=(_.visualObjects??[]).filter(e=>e.isStela).map(E.Z),[eu,ed]=(0,s.useState)((0,C.Z)(ec,en)),{isCropAreaOnDotArea:em,indexToHide:ey}=eu,{closeupImageWidth:ex,modalTop:eb}=et.closeupImageDims,ew=_?.imageSpec_736x?.url??"",eS=!p||p-Q._z<ex&&u,ev=!eS&&u,eP=u?L?0:Q._z:ee,ek=t._('Visual search', 'Visual search results', 'Visual search results'),{auxData:eT,viewType:ej,viewParameter:eF}=function({cropSource:e,isAuth:t,isCropAreaOnDotArea:a,isProductPage:l,surfaceType:i}){let n=t||"stl"===i,o=4===e||a,s=l?"product":"stl"===i?o?"product":"organic":t&&o?"unified":"organic";return{auxData:(()=>{let e=e=>({commerce_data:JSON.stringify({is_product_only_feed:e})});return"product"===s?e(!0):"unified"===s||n?e(!1):void 0})(),viewType:"product"===s?427:72,viewParameter:"organic"===s?3050:3462}}({cropSource:el,isAuth:u,isCropAreaOnDotArea:em,isProductPage:!1,surfaceType:X}),eC=e=>a({type:"SET_FLASHLIGHT_CROP_SOURCE",payload:{cropSource:e}});function eA(){if(0===i.length)return void l(`/pin/${_.entityId}/`,{replace:!0});l(-1)}return((0,F.Z)(()=>{eC(el)}),0===eb)?null:(0,W.jsxs)(s.Fragment,{children:[(0,W.jsx)(S.Z,{unsafeCSS:eD}),(0,W.jsx)(I.Z,{auxData:eT,viewParameter:eF,viewType:ej,children:(0,W.jsx)(k.Z,{view:ej,children:(0,W.jsxs)(v.default,{hasFixedHeader:!0,hasGutter:!1,children:[(0,W.jsx)(M.Z,{text:t._('Visual Search Page', 'flashlight.accessibilityhiddenheading.fullpage', 'accessibility label for flashlight page')}),(0,W.jsx)(d.xu,{color:"dark",height:"100vh",width:"100vw"}),(0,W.jsx)(eM,{closeupImageDims:et.closeupImageDims,closeupImageUrl:ew,cropArea:en,handleBackClick:eA,handleChangeCloseupImageTop:function(e){ea(t=>({...t,closeupImageDims:{...t.closeupImageDims,closeupImageTop:e}}))},handleCropperChange:function({cropArea:e,cropSource:t,visualObjects:i}){let n;eC(t),n=_.entityId,a((0,D.By)(n)),ed((0,C.Z)(i,e)),ei(t),ea(t=>({...t,...e})),l((0,Z.Z)({cropArea:e,cropSource:t,isProductPage:!1,pinId:_.entityId,requestParams:Y,surfaceType:X}),{replace:!0})},headerHeight:ee,pinDominantColor:_.dominantColor||"#efefef",pinId:_.entityId,pinImageSignature:_.imageSignature,showBackButton:eS,viewParameter:eF,visualObjects:ec,visualObjectToHide:ey}),ev&&(0,W.jsx)(eg.ZP,{handleBackClick:eA,viewParameter:eF,viewType:ej}),(0,W.jsx)($,{canMoveModal:!0,cropSource:el,entryPoint:"flashlight",headerHeight:ee,heading:ek,isOpen:!0,location:n,maxDistanceFromTop:eb||0,minDistanceFromTop:eP,mobileAccessibilityCloseIconLabel:t._('Close visual search results', 'close visual search results and go back to pin', 'close visual search results and go back to pin'),mobileHideCloseIcon:u,noBorder:!0,noDivider:!0,noMaskOnBackground:!0,onDismiss:eA,pinId:_.entityId,shouldSnapToEnds:!0,showHandle:u,snapToEndThreshold:.3,viewParameter:eF,viewType:ej,children:u?(0,W.jsx)(eh,{auxData:eT,isShopTheLookFeed:eo,pinId:_.entityId,searchResourceOptions:er,surfaceType:X,viewParameter:eF,viewType:ej}):(0,W.jsx)(ep,{isShopTheLookFeed:eo,searchResourceOptions:er,viewParameter:eF,viewType:ej})})]})})})]})}var ez=a(520803);let eH=(void 0!==i||(i=a(302609)).hash&&"df8cf9d2521b1a82156cc4ecd7b04884"!==i.hash&&console.error("The definition of 'MobileFlashlightPageFetchData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i),eO=(void 0!==n||(n=a(151219)).hash&&"a0953a7ea15ce447a2452bbeca8586ba"!==n.hash&&console.error("The definition of 'MobileFlashlightPageFetchDataPinQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function eV(){let e=(0,ez.Z)(),{pinId:t}=(0,_.Z)(e.params.id||""),a=(0,p.Z)({strategy:"Legacy",query:eO,variables:{pinId:t},useGetLegacyData:({pinId:e})=>{let{data:t}=(0,m.Z)({name:"PinResource",options:{id:e,field_set_key:"detailed",fetch_visual_search_objects:!0,is_mobile_fork:!0}}),a=(0,f.S6)()(e);return t??a}}),l=a?.v3GetPinQuery?.__typename==="V3GetPin"?a.v3GetPinQuery.data:null,i=(0,h.Z)(eH,l);return i?(0,W.jsx)(eR,{pinKey:i}):null}function eK(){(0,s.useEffect)(()=>{(0,o.Z)("MobileFlashlightPageFetchData","/app/www/VisualSearch/mobile/MobileFlashlightPageFetchData.tsx")},[]);let e=(0,g.Z)();return(0,W.jsx)(s.Suspense,{fallback:(0,W.jsx)(d.xH,{accessibilityLabel:e._('Loading Pin data', 'mobileFlashlightPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0}),children:(0,W.jsx)(eV,{})})}var eN=a(728746);let eB=function(){(0,s.useEffect)(()=>{(0,o.Z)("VisualSearchPage","/app/www/pages/VisualSearchPage.tsx")},[]);let e=(0,c.HG)(),t=(0,r.Z)();return e?t.isAuth?(0,W.jsx)(u.Z,{}):(0,W.jsx)(eN.Z,{}):(0,W.jsx)(eK,{})}},154959:function(e,t,a){(window.__PWS_LOADED_HANDLERS__=window.__PWS_LOADED_HANDLERS__||[]).push(["www/pin/[id]/visual-search",function(){return a(3455).Z}])},976892:function(e){e.exports="https://s.pinimg.com/webapp/handle_bottom_left-4b5805a7.svg"},47239:function(e){e.exports="https://s.pinimg.com/webapp/handle_bottom_right-5d5443d0.svg"},615440:function(e){e.exports="https://s.pinimg.com/webapp/handle_top_left-194e8c4e.svg"},743222:function(e){e.exports="https://s.pinimg.com/webapp/handle_top_right-0b7d60a7.svg"}},function(e){e.O(0,["11826","12755","21065","25418","30147","33558","36529","39366","39453","42508","42844","51059","51723","57747","66758","67979","76901","82797","83330","93543"],function(){return e(e.s=154959)}),e.O()}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/www/pin/[id]/visual-search-6d228cfb2c328b77.mjs.map