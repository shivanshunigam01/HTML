(self.modernJsonp=self.modernJsonp||[]).push([["51059"],{248894:function(e,t,a){var n;a.r(t),a.d(t,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"BestPinCardAttribution_pin",selections:[{alias:null,args:null,concreteType:"Board",kind:"LinkedField",name:"board",plural:!1,selections:[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"privacy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSmallUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};i.hash="610a35d46510240eb58e262c1909310c";let l=i},981838:function(e,t,a){var n,i,l;a.r(t),a.d(t,{default:()=>s});let r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"BestPinCardBody_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"lastRepinDate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"ArticleMetadata",kind:"LinkedField",name:"article",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"datePublished",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,concreteType:"RecipeMetadata",kind:"LinkedField",name:"recipe",plural:!1,selections:[i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"CategorizedIngredientsMetadata",kind:"LinkedField",name:"categorizedIngredients",plural:!0,selections:[l={alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{alias:null,args:null,concreteType:"ParsedIngredientMetadata",kind:"LinkedField",name:"ingredients",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"amt",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fromAggregatedData",storageKey:null},{args:null,kind:"FragmentSpread",name:"RecipeMetadata_recipe"}],storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"nativeCreator",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null}],storageKey:null},n,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinMetadataField",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"pinTitle",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PinJoin",kind:"LinkedField",name:"pinJoin",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"visualAnnotation",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},l,{args:null,kind:"FragmentSpread",name:"usePinImageUrls_pin"},{args:null,kind:"FragmentSpread",name:"useNormalizePinData_pin"},{args:null,kind:"FragmentSpread",name:"BestPinCardAttribution_pin"}],type:"Pin",abstractKey:null};r.hash="81db65fd15680cc0281b801ed4a8cb94";let s=r},258138:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"Descriptors_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null}],type:"Pin",abstractKey:null};n.hash="9d15639e8d9dd61426917dc218fbb3a6";let i=n},85729:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FlashlightSpotlightDots_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetStringifiedCommerceAuxData_pin"}],type:"Pin",abstractKey:null};n.hash="3a8409077905af94eb39568e4a5a57fc";let i=n},781323:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"OneBar_oneBarModules",selections:[{alias:"entityId",args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"OneBarModule_oneBarModules"}],type:"OneBarModule",abstractKey:null};n.hash="45cea1099e24f55ebce4abebdb411447";let i=n},426344:function(e,t,a){var n;a.r(t),a.d(t,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RecipeMetadata_recipe",selections:[{alias:null,args:null,concreteType:"AggregateRatingMetadata",kind:"LinkedField",name:"aggregateRating",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"bestRating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ratingValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reviewCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTimes",kind:"LinkedField",name:"cookTimes",plural:!1,selections:[{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"cook",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"m",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"prep",plural:!1,selections:n,storageKey:null}],storageKey:null}],type:"RecipeMetadata",abstractKey:null};i.hash="12f77507a9fdec344b44b7e659fa5ac1";let l=i},447963:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsImageContent_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{args:null,kind:"FragmentSpread",name:"Descriptors_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchCropper_pin"}],type:"Pin",abstractKey:null};n.hash="727c8ab2c1c256e3b4478a36890f92d6";let i=n},579174:function(e,t,a){var n,i,l,r,s,o,d,u;a.r(t),a.d(t,{default:()=>p});let c=(n=[{defaultValue:null,kind:"LocalArgument",name:"pinId"}],i=[{kind:"Variable",name:"pin",variableName:"pinId"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r=[{kind:"Literal",name:"spec",value:"564x"}],u=[s={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RelatedProductsPageQuery",selections:[{alias:null,args:i,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[l,{args:null,kind:"FragmentSpread",name:"RelatedProductsPage_pin"}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RelatedProductsPageQuery",selections:[{alias:null,args:i,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:"image",args:r,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[s,o,d],storageKey:'images(spec:"564x")'},{alias:"imageSpec_564x",args:r,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:u,storageKey:'images(spec:"564x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:u,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:u,storageKey:'images(spec:"orig")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:u,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:u,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}]},params:{id:"2b17eb88c62c11f3966426f1a462291f771985a456e2b017a676cd695dd749fa",metadata:{},name:"RelatedProductsPageQuery",operationKind:"query",text:null}});c.hash="0f7b98a1f02dbf8528df0452aa26efd4";let p=c},271128:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsPage_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchPageWithPinData_pin"}],type:"Pin",abstractKey:null};n.hash="91d05676e413b7b47653c2f8fa609093";let i=n},895622:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsUnifiedFeed_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchMasonryGrid_pin"}],type:"Pin",abstractKey:null};n.hash="20c2c7f4ff982fb93a9608faa14f3ed2";let i=n},60899:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthCropperContainer_pin",selections:[{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"FlashlightSpotlightDots_pin"}],type:"Pin",abstractKey:null};n.hash="939d46d8644385a7918ed8179ce77a4c";let i=n},854734:function(e,t,a){var n,i,l,r,s,o,d,u,c,p,g,h,m,y,f,x,_,v,S,w,b,k,P,F,C,j,I,R;a.r(t),a.d(t,{default:()=>Z});let T=(n={defaultValue:!1,kind:"LocalArgument",name:"isCloseupRelatedModulesFeedQuery"},i={defaultValue:null,kind:"LocalArgument",name:"pinId"},l=[{kind:"Variable",name:"pin",variableName:"pinId"}],r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},d=[{kind:"Literal",name:"spec",value:"564x"}],g=[{kind:"Literal",name:"spec",value:"736x"}],h=[p={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],m=[{kind:"Literal",name:"spec",value:"474x"}],y=[{kind:"Literal",name:"spec",value:"236x"}],f={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},_=[{alias:null,args:null,kind:"ScalarField",name:"m",storageKey:null}],S={alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:v=[r],storageKey:null},w={alias:"image236x",args:y,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:v,storageKey:'additionalImagesPerSpec(spec:"236x")'},b={alias:"image474x",args:m,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:v,storageKey:'additionalImagesPerSpec(spec:"474x")'},k={alias:"image564x",args:d,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:v,storageKey:'additionalImagesPerSpec(spec:"564x")'},P={alias:"image736x",args:g,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:v,storageKey:'additionalImagesPerSpec(spec:"736x")'},F={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},R=[c],{fragment:{argumentDefinitions:[n,i],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[r,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"UnauthDesktopFlashlightPageFetchData_pin"}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[i,n],kind:"Operation",name:"UnauthDesktopFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[r,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},s,{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},o],storageKey:null},{alias:"imageSpec_564x",args:d,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[u,c,p],storageKey:'images(spec:"564x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[u,c,p,r],storageKey:'images(spec:"orig")'},{alias:"imageSpec_736x",args:g,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"736x")'},{alias:"imageSpec_474x",args:m,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:y,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"lastRepinDate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"ArticleMetadata",kind:"LinkedField",name:"article",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"datePublished",storageKey:null}],storageKey:null},s,o,{alias:null,args:null,concreteType:"RecipeMetadata",kind:"LinkedField",name:"recipe",plural:!1,selections:[f,{alias:null,args:null,concreteType:"CategorizedIngredientsMetadata",kind:"LinkedField",name:"categorizedIngredients",plural:!0,selections:[x,{alias:null,args:null,concreteType:"ParsedIngredientMetadata",kind:"LinkedField",name:"ingredients",plural:!0,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"amt",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fromAggregatedData",storageKey:null},{alias:null,args:null,concreteType:"AggregateRatingMetadata",kind:"LinkedField",name:"aggregateRating",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"bestRating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ratingValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reviewCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTimes",kind:"LinkedField",name:"cookTimes",plural:!1,selections:[{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"cook",plural:!1,selections:_,storageKey:null},{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"prep",plural:!1,selections:_,storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[r,f,S],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[f,S,{alias:null,args:null,kind:"ScalarField",name:"itemId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"itemSetId",storageKey:null},w,b,k,P],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"nativeCreator",plural:!1,selections:[F,C,j],storageKey:null},o,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinMetadataField",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"pinTitle",storageKey:null}],storageKey:null},j,r],storageKey:null},{alias:null,args:null,concreteType:"PinJoin",kind:"LinkedField",name:"pinJoin",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"visualAnnotation",storageKey:null}],storageKey:null},I,{alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},x,{alias:"imageSpec_60x60",args:[{kind:"Literal",name:"spec",value:"60x60"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:R,storageKey:'images(spec:"60x60")'},{alias:"imageSpec_136x136",args:[{kind:"Literal",name:"spec",value:"136x136"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:R,storageKey:'images(spec:"136x136")'},{alias:"imageSpec_170x",args:[{kind:"Literal",name:"spec",value:"170x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:R,storageKey:'images(spec:"170x")'},{alias:"imageSpec_600x315",args:[{kind:"Literal",name:"spec",value:"600x315"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:R,storageKey:'images(spec:"600x315")'},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null},{alias:null,args:null,concreteType:"Board",kind:"LinkedField",name:"board",plural:!1,selections:[I,f,{alias:null,args:null,kind:"ScalarField",name:"privacy",storageKey:null},c,j],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:[I,C,{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSmallUrl",storageKey:null},F,j],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isOosProduct",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isStaleProduct",storageKey:null},{condition:"isCloseupRelatedModulesFeedQuery",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"Brand",kind:"LinkedField",name:"brand",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"signature",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ShippingInfo",kind:"LinkedField",name:"shippingInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"freeShippingPrice",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"freeShippingValue",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductVariantSet",kind:"LinkedField",name:"variantSet",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionMetadata",kind:"LinkedField",name:"dimensionMetadata",plural:!0,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"values",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductVariant",kind:"LinkedField",name:"variants",plural:!0,selections:v,storageKey:null}],storageKey:null},w,b,k,P],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductMetadataV2",kind:"LinkedField",name:"productPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"ItemMetadata",kind:"LinkedField",name:"items",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"additionalImagesLength",storageKey:null}],storageKey:null},j],storageKey:null}]},{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,concreteType:"PinCarouselSlot",kind:"LinkedField",name:"carouselSlots",plural:!0,selections:v,storageKey:null},j],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shoppingFlags",storageKey:null},{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isShopTheLook",storageKey:null},j],storageKey:null},j],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}]},params:{id:"ddfa399e7e8df08060f4a3a93cfd4c2b7979519635b693733d3e88f501b0f6ff",metadata:{},name:"UnauthDesktopFlashlightPageFetchDataPinQuery",operationKind:"query",text:null}});T.hash="76ab21d7bfe8df8a1418aea805bb41fa";let Z=T},887492:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPageFetchData_pin",selections:[{args:null,kind:"FragmentSpread",name:"UnauthDesktopFlashlightPage_pin"}],type:"Pin",abstractKey:null};n.hash="01839fc3bcd9cdaf206873364167d157";let i=n},136209:function(e,t,a){var n;a.r(t),a.d(t,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null}],storageKey:null},{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null}],storageKey:'images(spec:"564x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"orig")'},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"BestPinCardBody_pin"},{args:null,kind:"FragmentSpread",name:"UnauthCropperContainer_pin"}],type:"Pin",abstractKey:null};i.hash="93612431e09eadc717c32d98e8d91e06";let l=i},292297:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchCarousel_story",selections:[{alias:null,args:null,concreteType:"StoryAction",kind:"LinkedField",name:"action",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"contentIds",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"objects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:"storyId",args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackingParams",storageKey:null},{args:null,kind:"FragmentSpread",name:"CSSCarouselModule_story"}],type:"Story",abstractKey:null};n.hash="b1061aefab46af37d4c9716916386af2";let i=n},441370:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchContainer_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"RelatedProductsImageContent_pin"},{args:null,kind:"FragmentSpread",name:"RelatedProductsUnifiedFeed_pin"}],type:"Pin",abstractKey:null};n.hash="3a9a747c3135f426fe0cf32ca9147a5d";let i=n},911486:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchCropper_pin",selections:[{alias:"image",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"564x")'},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"useSamSegmentation_pin"}],type:"Pin",abstractKey:null};n.hash="fbf2d3b93402a9dd783073db316c0f92";let i=n},97004:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchImageContainer_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:"image",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{args:null,kind:"FragmentSpread",name:"VisualSearchCropper_pin"},{args:null,kind:"FragmentSpread",name:"Descriptors_pin"}],type:"Pin",abstractKey:null};n.hash="8250aa2ed9c603023c2f2a226d0b9fbb";let i=n},716635:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchLayout_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchImageContainer_pin"}],type:"Pin",abstractKey:null};n.hash="3c3f391c3bf9eec79c18ed9a3fe63800";let i=n},261717:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchPageWithPinData_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:"image",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchContainer_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchLayout_pin"}],type:"Pin",abstractKey:null};n.hash="ece11b62e2de551b92d24a2389316249";let i=n},719962:function(e,t,a){var n;a.r(t),a.d(t,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useNormalizePinData_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"orig")'},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:n=[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:n,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null}],type:"Pin",abstractKey:null};i.hash="01a93671cde480baa2cfd8b781589acd";let l=i},423540:function(e,t,a){a.r(t),a.d(t,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useSamSegmentation_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],type:"Pin",abstractKey:null};n.hash="50c726067ab8af873ed4afded90b7bed";let i=n},17667:function(e,t,a){a.r(t),a.d(t,{default:()=>v});var n,i=a(686659),l=a(667294),r=a(167912),s=a(312048),o=a(740097),d=a(938545),u=a(996822),c=a(320197),p=a(562400),g=a(24246),h=a(609252),m=a(936367),y=a(774838),f=a(902123),x=a(785893);let _=(void 0!==n||(n=a(781323)).hash&&"45cea1099e24f55ebce4abebdb411447"!==n.hash&&console.error("The definition of 'OneBar_oneBarModules' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function v({center:e=!1,hasProductFiltersApplied:t,hrefOverride:a,itemHeight:n=d.Lu,marginBottom:v=d.JC,oneBarModulesKey:S,oneBarModulesRest:w,onFilterButtonClick:b,paddingBottom:k=d.uS,paddingX:P=d.jf,variant:F,viewParameter:C,viewType:j}){(0,l.useEffect)(()=>{(0,i.Z)("OneBar","/app/common/react/components/OneBar/OneBar.tsx")},[]);let I=(0,l.useRef)(null),R=I.current?.firstElementChild?.firstElementChild?.firstElementChild,[T,Z]=(0,l.useState)(0),[E,M]=(0,l.useState)(0),[D,L]=(0,l.useState)(!1),[K,A]=(0,l.useState)(!1),[$,z]=(0,l.useState)(0),B=(0,s.TH)(),O=(0,g.Z)(),{isRTL:N}=(0,y.B)(),U=(0,l.useRef)(!1),W=new m.ZP,V=(0,r.useFragment)(_,S),H=V&&[V]||w,G=e&&(R?.clientWidth||0)>=(R?.scrollWidth||0);(0,l.useEffect)(()=>{let e=e=>{"Tab"===e.key&&(U.current=!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]),(0,l.useEffect)(()=>{Z(0)},[B]),(0,l.useEffect)(()=>{M(R?.clientWidth||0);let e=(0,p.Z)(()=>{M(R?.clientWidth||0)},100,{maxWait:200});return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[R]),(0,l.useEffect)(()=>{let e=I.current;return e&&h.Z.addObstruction("top",e),()=>{e&&h.Z.removeObstruction("top",e)}}),(0,l.useEffect)(()=>{let e=R?.scrollWidth||0,t=0;for(let e=0;e<T;e+=1)t+=R?.children[e]?.offsetWidth||0;let a=e-t,n=E>=e;n&&Z(0),L(T>0&&!n),A(a>E&&T<H.length&&!n),z(t)},[R,T,H.length,E,$,N]);let Y=()=>{T+3<H.length?Z(T+3):Z(H.length-1)},X=()=>{T-3>=0?Z(T-3):Z(0)},q=(0,l.useRef)(null),{isFiltersDrawerFocused:Q}=(0,u.e)()||{isFiltersDrawerFocused:!1},[J,ee]=(0,l.useState)(Q);return(0,l.useEffect)(()=>{!Q&&J&&q.current?.focus(),ee(Q)},[Q,J]),H.length>0&&(0,x.jsx)(f.q,{children:({hovered:e,onMouseEnter:i,onMouseLeave:l})=>(0,x.jsxs)(o.xu,{ref:I,color:"default",dangerouslySetInlineStyle:{__style:{paddingBottom:k}},"data-root-margin":"search-one-bar","data-test-id":"scrollable-one-bar-root",marginBottom:v,onMouseEnter:i,onMouseLeave:l,position:"relative",children:[(0,x.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{overflowX:"clip"}},paddingX:P,position:"relative",children:(0,x.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{[N?"right":"left"]:`-${$}px`,transition:"left 0.3s, right 0.3s"}},position:"relative",children:(0,x.jsx)(o.kC,{alignItems:"center",gap:{row:2,column:0},height:n,justifyContent:G?"center":void 0,children:H.map((e,n)=>(0,x.jsx)(o.xu,{ref:1===n?q:void 0,onFocus:()=>{U.current||Z(n)},onMouseDown:()=>U.current=!0,tabIndex:1===n?-1:void 0,children:(0,x.jsx)(c.Z,{hasProductFiltersApplied:t,hrefOverride:a,impressionsFramework:W,index:n,module:e,oneBarModulesKey:V??null,onFilterButtonClick:b,variant:F,viewParameter:C,viewType:j})},`OneBarModule-${e.entityId||e.id||""}`))})})}),e&&(0,x.jsxs)(o.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{background:(0,d.KC)(N,D,K),paddingBottom:d.uS,paddingLeft:d.EA,paddingRight:d.EA,pointerEvents:"none"}},"data-test-id":"one-bar-navigation-arrows",display:"flex",justifyContent:"between",left:!0,position:"absolute",right:!0,top:!0,children:[(0,x.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},children:D&&(0,x.jsx)(o.hU,{accessibilityLabel:O._('Back', 'oneBar.navArrow.back', 'Accessibility laber for a button that navigates back to previous search guides'),bgColor:"white",icon:"arrow-back",onClick:X})}),(0,x.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},children:K&&(0,x.jsx)(o.hU,{accessibilityLabel:O._('Forward', 'oneBar.navArrow.forward', 'Accessibility laber for a button that navigates forward to see more search guides'),bgColor:"white",icon:"arrow-forward",onClick:Y})})]})]})})}},721350:function(e,t,a){a.d(t,{Z:()=>l});var n=a(496102);let i=`pulsing {
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
}`,l={css:(0,n.Ll)([i]),animation:"pulsing 2s infinite"}},759271:function(e,t,a){a.d(t,{Z:()=>r});var n=a(501010),i=a(774838),l=a(739405);function r(){let{isAuthenticated:e}=(0,i.B)(),t=(0,l.ml)(),{checkExperiment:a}=(0,n.Z)();return{mWebCloseupRedesignEnabled:e&&t&&a("mweb_closeup_redesign").anyEnabled,mWebCloseupRedesignExpGroup:a("mweb_closeup_redesign").group}}},226966:function(e,t,a){a.d(t,{n:()=>n});let n=20},480610:function(e,t,a){a.d(t,{Z:()=>i});var n=a(575820);function i(e,t,a){let i=(0,n.mB)(e.search),l=parseFloat(i.x??""),r=parseFloat(i.y??""),s=parseFloat(i.w??""),o=parseFloat(i.h??"");if(function(...e){return e.every(e=>e>=0&&e<=1)}(l,r,s,o)&&t&&a)return{x:Math.floor(l*t),y:Math.floor(r*a),w:Math.floor(s*t),h:Math.floor(o*a)};{let e=parseInt(i.x??"",10),t=parseInt(i.y??"",10),a=parseInt(i.w??"",10),n=parseInt(i.h??"",10);return!function(...e){return e.every(Number.isInteger)}(e,t,a,n)?null:{x:e,y:t,w:a,h:n}}}},159831:function(e,t,a){a.d(t,{R:()=>y,Z:()=>f});var n=a(686659),i=a(667294),l=a(740097),r=a(312048),s=a(230201),o=a(400962),d=a(24246),u=a(197908),c=a(785893);function p({arrowType:e,viewParameter:t,viewType:a}){(0,i.useEffect)(()=>{(0,n.Z)("FlashlightBackButton","/app/common/react/components/discover/Flashlight/FlashlightBackButton.tsx")},[]);let p=(0,d.Z)(),g=(0,r.s0)(),h=(0,r.TH)(),{previous:m}=(0,o.ou)(),{logContextEvent:y}=(0,s.u)(),f=(0,u.Z)(h.pathname);return(0,c.jsx)(l.xu,{"data-test-id":"go-back-button",children:(0,c.jsx)(l.hU,{accessibilityLabel:p._('Go back', 'Accessible icon for close button', 'Accessible icon for close button'),icon:e??"directional-arrow-left",iconColor:"darkGray",onClick:()=>{if(y({event_type:101,view_type:a,element:34,view_parameter:t}),0===m.length)return void g(f?`/pin/${f}/`:"/",{replace:!0});g(-1)},size:"xl"})})}var g=a(104811),h=a(609252),m=a(31863);let y=64;function f({isProductPage:e,title:t,viewParameter:a,viewType:r}){(0,i.useEffect)(()=>{(0,n.Z)("RelatedProductsHeader","/app/common/react/components/shopping/RelatedProducts/RelatedProductsHeader.tsx")},[]);let s=(0,i.useRef)(null);return(0,i.useEffect)(()=>(s.current&&h.Z.addObstruction("top",s.current),()=>{s.current&&h.Z.removeObstruction("top",s.current)})),(0,c.jsx)(m.Z,{position:e?"sticky":"fixed",shouldShowShadow:!0,children:(0,c.jsxs)(l.xu,{color:"default",display:"flex",height:y,marginBottom:4,children:[(0,c.jsx)(l.xu,{marginStart:4,minWidth:y,children:(0,c.jsx)(p,{arrowType:t?"directional-arrow-left":"cancel",viewParameter:a,viewType:r})}),(0,c.jsx)(l.xu,{ref:s,alignItems:"center",color:"default","data-test-id":"related-products-header",display:"flex",flex:"grow",justifyContent:"center",children:(0,c.jsx)(g.Z,{title:t})}),(0,c.jsx)(l.xu,{marginEnd:4,minWidth:y})]})})}},837378:function(e,t,a){a.d(t,{Z:()=>g});var n=a(686659),i=a(667294),l=a(740097),r=a(785893);let s={nw_horizontal:"inset(0 0 0 50%)",nw_vertical:"inset(50% 0 0 0)",ne_horizontal:"inset(0 50% 0 0)",ne_vertical:"inset(50% 0 0 0)",sw_horizontal:"inset(0 0 0 50%)",sw_vertical:"inset(0 0 50% 0)",se_horizontal:"inset(0 50% 0 0)",se_vertical:"inset(0 0 50% 0)"};function o({top:e,left:t,bottom:a,right:o,size:d,transition:u,opacity:c}){(0,i.useEffect)(()=>{(0,n.Z)("AnchorStrokeCap","/app/packages/Cropper/AnchorStrokeCap.tsx")},[]);let p=(0,i.useMemo)(()=>{let n=((e,t,a,n)=>{let i=void 0!==e,l=void 0!==a,r=void 0!==t,s=void 0!==n;return i&&r&&!l&&!s?"nw":i&&s&&!l&&!r?"ne":l&&r&&!i&&!s?"sw":l&&s&&!i&&!r?"se":"none"})(e,t,a,o),i=0===e||0===a?"horizontal":0===t||0===o?"vertical":"none";return`${n}_${i}`},[e,t,a,o]),g=s[p]||"none";return(0,r.jsx)(l.xu,{color:"default",dangerouslySetInlineStyle:{__style:{top:e,left:t,right:o,bottom:a,clipPath:g,transition:u,opacity:c}},"data-test-id":p,height:d,position:"absolute",rounding:"circle",width:d})}var d=a(221175);function u({anchorSize:e,corner:t,maxTouchSize:a}){(0,i.useEffect)(()=>{(0,n.Z)("AnchorTouchArea","/app/packages/Cropper/AnchorTouchArea.tsx")},[]);let s=d.FA[t],o=`${d.tT} ${t}`,u=Math.min(d.e4*d.MS,a),c=(u-e)/2,p=t.includes("n")?-c:void 0,g=t.includes("w")?-c:void 0,h=t.includes("s")?-c:void 0,m=t.includes("e")?-c:void 0;return(0,r.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{top:p,left:g,bottom:h,right:m,cursor:s,pointerEvents:"auto"}},"data-test-id":`cropper-corner-${t}`,height:u,id:o,position:"absolute",width:u})}var c=a(30430);let p=({x:e,y:t,size:a})=>`linear-gradient(black, black) ${e}px ${t}px / ${a}px ${a}px no-repeat`;function g({anchorSelection:e,h:t,handleCount:a,size:s,transition:g,visibility:h,w:m,x:y,y:f}){(0,i.useEffect)(()=>{(0,n.Z)("CropperAnchors","/app/packages/Cropper/CropperAnchors.tsx")},[]);let x=2===a,_=x?d.jf:d.m6,v=x?d.O3:d.ps,S=s/2,w=d.e4/2-d.xh-v-d.eq+(0,c.Z)({w:m,h:t,minSize:d.eq,maxSize:0}),b=m+2*S-2*w,k=t+2*S-2*w,P=d.e4-s,F=Math.max(d.CT-P,d.AL),C=d.xh/2,j=s-C,I=j-C,R=(Math.min(b,k)-d.dH)/2,T="ne"===e?1:_,Z=p({x:b-j,y:0,size:j}),E="nw"===e?1:_,M=p({x:0,y:0,size:j}),D="sw"===e?1:_,L=p({x:0,y:k-j,size:j}),K="se"===e?1:_,A=p({x:b-j,y:k-j,size:j});return(0,r.jsxs)(l.xu,{dangerouslySetInlineStyle:{__style:{top:f-S+w,left:y-S+w,pointerEvents:"none",visibility:h,transition:g}},height:k,position:"absolute",width:b,children:[(0,r.jsx)(l.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${d.xh}px solid white`,borderRadius:`${F}px`,mask:Z,pointerEvents:"none",transition:g,opacity:T}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(o,{opacity:T,right:0,size:d.xh,top:I,transition:g}),(0,r.jsx)(o,{opacity:T,right:I,size:d.xh,top:0,transition:g}),(0,r.jsx)(u,{anchorSize:s,corner:"ne",maxTouchSize:R}),(0,r.jsx)(l.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${d.xh}px solid white`,borderRadius:`${F}px`,mask:L,pointerEvents:"none",transition:g,opacity:D}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(o,{bottom:0,left:I,opacity:D,size:d.xh,transition:g}),(0,r.jsx)(o,{bottom:I,left:0,opacity:D,size:d.xh,transition:g}),(0,r.jsx)(u,{anchorSize:s,corner:"sw",maxTouchSize:R}),!x&&(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(l.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${d.xh}px solid white`,borderRadius:`${F}px`,mask:M,pointerEvents:"none",transition:g,opacity:E}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(o,{left:0,opacity:E,size:d.xh,top:I,transition:g}),(0,r.jsx)(o,{left:I,opacity:E,size:d.xh,top:0,transition:g}),(0,r.jsx)(u,{anchorSize:s,corner:"nw",maxTouchSize:R}),(0,r.jsx)(l.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${d.xh}px solid white`,borderRadius:`${F}px`,mask:A,pointerEvents:"none",transition:g,opacity:K}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(o,{bottom:0,opacity:K,right:I,size:d.xh,transition:g}),(0,r.jsx)(o,{bottom:I,opacity:K,right:0,size:d.xh,transition:g}),(0,r.jsx)(u,{anchorSize:s,corner:"se",maxTouchSize:R})]})]})}},938306:function(e,t,a){a.d(t,{Z:()=>x});var n=a(686659),i=a(667294),l=a(740097),r=a(104999),s=a(221175),o=a(837378),d=a(110196),u=a(325574),c=a(738735),p=a(30430),g=a(360033),h=a(480706),m=a(501010),y=a(979173),f=a(785893);function x({children:e,cropArea:{x:t,y:a,w:x,h:_},cropSource:v,hoveredCutoutIndex:S,imageContainerX:w,imageContainerY:b,imageSize:{width:k=1,height:P=1},objectDetection:F,onChange:C,setHoveredCutoutIndex:j,setSelectedCutoutIndex:I,viewParameter:R,viewType:T}){(0,i.useEffect)(()=>{(0,n.Z)("CropperV2","/app/packages/Cropper/CropperV2.tsx")},[]);let{checkExperiment:Z}=(0,m.Z)(),E=(0,r.Z)(),M=(0,i.useRef)(null),D=(0,i.useMemo)(()=>({x:0,y:0,w:k,h:P}),[P,k]),L=(0,i.useMemo)(()=>(0,u.Z)({cropArea:{x:t,y:a,w:x,h:_},imageSize:{width:k,height:P}}),[_,x,t,a,P,k]),[K,A]=(0,i.useState)(()=>(0,g.ZP)({x:t,y:a,w:x,h:_},D)?D:L),$=(0,i.useMemo)(()=>(0,g.ZP)(K,D),[K,D]),[z,B]=(0,i.useState)("none"),[O,N]=(0,i.useState)("none"),[U,W]=(0,i.useState)(!1),[V,H]=(0,i.useState)(!1),[G,Y]=(0,i.useState)(!1),[X,q]=(0,i.useState)(0),[Q,J]=(0,i.useState)(0),{anyEnabled:ee,group:et}=Z("web_cropper_object_selection"),{x:ea,y:en,w:ei,h:el}=K,er=(0,i.useMemo)(()=>(0,p.Z)({w:ei,h:el,minSize:s.Zn,maxSize:s.e4}),[el,ei]),es=s.e4-er,eo=ee?s.O3:s.ps,ed=s.Y4-er,eu=s.SP,ec=s.SP,ep=k-s.SP,eg=P-s.SP,eh="number"==typeof S,em=V?"none":"0.3s cubic-bezier(0.42, 0, 0.58, 1.2)",ey=(0,d.Z)({cropperSelection:z,anchorSelection:O,hasMouseMoved:V}),ef=ee?function({cropperSelection:e,isTargetOnObject:t,cropSource:a,hasClickedOnObject:n,experimentGroup:i}){return("none"===e||t)&&(9===a||n)?"enabled_darker"===i?s.z3:s.pg:0}({cropperSelection:z,isTargetOnObject:U,cropSource:v,hasClickedOnObject:G,experimentGroup:et}):0,ex=e=>{e.preventDefault();let{clientX:t,clientY:a,target:n}=e,i=t-w,l=a-b;H(!1),Y(!1),q(i),J(l);let{id:r}=n,[o,d="none"]=r.split(" "),u=`${o}`===s.tT,c=r===s.at,p=r===s.eX,g=r===h.P,m=r===y.I;u?(B("anchor"),N(d)):p?B("cropbox"):c?B("background"):(!(ea<i&&i<ea+ei&&en<l&&l<en+el)||$?B("background"):B("cropbox"),W(g||m))},e_=e=>{if("none"===z)return;let{clientX:t,clientY:a}=e,n=t-w,i=a-b;if(!(Math.abs(n-X)<s.yG&&Math.abs(i-Q)<s.yG&&!V&&["cropbox","background"].includes(z)))switch(H(!0),W(!1),j?.(null),I?.(-1),z){case"anchor":{let e=["nw","sw"].includes(O),t=["nw","ne"].includes(O),a=Math.max(Math.min(n,ep),eu),l=Math.max(Math.min(i,eg),ec),r=e?Math.min(a,ea+ei-s.yz):ea;A({x:r,y:t?Math.min(l,en+el-s.yz):en,w:e?Math.max(ea+ei-a,s.yz):Math.max(a-ea,s.yz),h:t?Math.max(en+el-l,s.yz):Math.max(l-en,s.yz)});break}case"cropbox":{let e=Math.max(Math.min(ea+(n-X),k-ei-eu),eu),t=Math.max(Math.min(en+(i-Q),P-el-ec),ec);q(n),J(i),A({x:e,y:t,w:ei,h:el});break}case"background":{let e=Math.max(Math.min(n,k),0),t=Math.max(Math.min(i,P),0),a=e-X,l=t-Q;A({x:Math.min(X,e),y:Math.min(Q,t),w:Math.abs(a),h:Math.abs(l)})}}},ev=()=>{if(B("none"),N("none"),W(!1),H(!1),"none"===z)return;if(U&&("cutouts"===F&&eh||"dots"===F))return void Y(!0);let e=(e,t)=>{C({cropArea:e,cropSource:t}),A(e)};if(V){let t=Math.max(Math.min(ea,k-s.yz-eu),eu),a=Math.max(Math.min(en,P-s.yz-ec),ec),n=el<s.yz?s.yz:a+el>P-ec?P-a-ec:el,i=ei<s.yz?s.yz:t+ei>k-eu?k-t-eu:ei;e({x:t,y:a,w:i,h:n},6),"cropbox"===z?E({event_type:7603,view_type:T,view_parameter:R}):"anchor"===z?E({event_type:7604,view_type:T,view_parameter:R}):"background"===z&&E({event_type:16584,view_type:T,view_parameter:R})}else $||"background"===z?(e((0,c.Z)({mouseX:X,mouseY:Q,cropSize:s.Rk,minBound:s.SP,imageWidth:k,imageHeight:P}),6),E({event_type:16585,view_type:T,view_parameter:R})):"cropbox"===z&&(e(D,5),E({event_type:16586,view_type:T,view_parameter:R}))};return(0,i.useEffect)(()=>{G&&A(L)},[L,G]),(0,i.useEffect)(()=>{let e=M.current;return e?.addEventListener("mousedown",ex),window.addEventListener("mousemove",e_),window.addEventListener("mouseup",ev),()=>{e?.removeEventListener("mousedown",ex),window.removeEventListener("mousemove",e_),window.removeEventListener("mouseup",ev)}}),(0,f.jsxs)(l.xu,{ref:M,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:ey}},"data-test-id":"visual-search-cropper",left:!0,position:"absolute",right:!0,top:!0,children:[(0,f.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{border:`${eo}px solid rgba(255, 255, 255, 0.20)`,borderRadius:`${ed}px`,boxShadow:"0 0 0 99999px rgba(0, 0, 0, 0.35)",left:ea,top:en,transition:em,backgroundColor:`rgba(0, 0, 0, ${ef})`}},height:el,position:"absolute",width:ei}),(0,f.jsx)(l.xu,{bottom:!0,id:s.at,left:!0,position:"absolute",right:!0,top:!0}),(0,f.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{visibility:$?"hidden":"visible",left:ea,top:en}},"data-test-id":"cropper-section",height:el,id:s.eX,position:"absolute",width:ei}),e,(0,f.jsx)(o.Z,{anchorSelection:O,h:el,handleCount:ee?2:4,size:es,transition:em,visibility:$||"background"===z&&V?"hidden":"visible",w:ei,x:ea,y:en})]})}},110196:function(e,t,a){a.d(t,{Z:()=>n});function n({cropperSelection:e,anchorSelection:t,hasMouseMoved:a}){if("background"===e&&a)return"crosshair";if("cropbox"===e&&a)return"move";if("anchor"===e){if("nw"===t||"se"===t)return"nwse-resize";else if("ne"===t||"sw"===t)return"nesw-resize"}return"auto"}},325574:function(e,t,a){a.d(t,{Z:()=>i});var n=a(221175);function i({cropArea:e,imageSize:t}){let{x:a,y:i,w:l,h:r}=e,{height:s,width:o}=t;if(!s||!o)return e;let d=a,u=i,c=l,p=r;return d<n.SP&&(d=n.SP,c-=n.SP-a),d+c>o-n.SP&&(c-=d+c-o+n.SP),u<n.SP&&(u=n.SP,p-=n.SP-i),u+p>s-n.SP&&(p-=u+p-s+n.SP),{x:d,y:u,w:c,h:p}}},738735:function(e,t,a){a.d(t,{Z:()=>i});let n=({coordinate:e,cropSize:t,maxBound:a,minBound:n})=>e<=n?n:a<=e+t?a-t:e;function i({cropSize:e,imageHeight:t,imageWidth:a,minBound:i,mouseX:l,mouseY:r}){let s=l-e/2,o=r-e/2,d=a-i,u=t-i;return{x:n({coordinate:s,minBound:i,maxBound:d,cropSize:e}),y:n({coordinate:o,minBound:i,maxBound:u,cropSize:e}),w:e,h:e}}},30430:function(e,t,a){a.d(t,{Z:()=>i});var n=a(221175);function i({w:e,h:t,minSize:a,maxSize:i}){let l=Math.min(e,t);return l<=n.yz?i-a:l<n.Kw?(i-a)/(n.Kw-n.yz)*(n.Kw-l):0}},480706:function(e,t,a){a.d(t,{P:()=>s,Z:()=>u});var n=a(667294),i=a(740097),l=a(24246),r=a(785893);let s="flashlight-dot-style",o=16,d=32,u=(0,n.forwardRef)(({icon:e,onClick:t,onMouseDown:a,onMouseEnter:u,onMouseLeave:c,onMouseUp:p,selected:g,style:h,text:m,x:y,y:f,zIndex:x,backdropDiameter:_=d,dotDiameter:v=o},S)=>{let[w,b]=(0,n.useState)(!1),k=(0,l.Z)(),P=w?_+4:_;return(0,r.jsx)(i.xu,{ref:S,dangerouslySetInlineStyle:{__style:{top:f-P/2,left:y-P/2,outline:"none"}},position:"absolute",zIndex:new i.Ry(x||0),children:(0,r.jsx)(i.iP,{accessibilityLabel:k._('Search this item', 'flashlight.dot.a11ylabel', 'accessibility label for flashlight dot'),dataTestId:"flashlight-dot",onMouseDown:a,onMouseEnter:({event:e})=>{b(!0),u?.({event:e})},onMouseLeave:({event:e})=>{b(!1),c?.({event:e})},onMouseUp:p,onTap:t,tabIndex:0,children:(0,r.jsxs)(i.xu,{alignItems:"center",borderStyle:"none",color:"default",dangerouslySetInlineStyle:{__style:{boxShadow:g?"0 0 0 3px #e60023":"none",borderRadius:v,top:(P-v)/2,left:(P-v)/2,...h}},"data-test-id":s,display:"flex",height:v,id:s,justifyContent:"center",padding:0,position:"absolute",width:v,children:[!!m&&(0,r.jsx)(i.xe,{align:"center",color:"default",inline:!0,size:"100",weight:"bold",children:m}),e&&(0,r.jsx)(i.JO,{accessibilityLabel:k._('Tag anchor', 'accessibility label for an anchor for an object in a pin', 'accessibility label for an anchor for an object in a pin'),color:"error",icon:e,inline:!0,size:v/2})]})})})})},116980:function(e,t,a){a.d(t,{Pw:()=>n,SB:()=>i,ZP:()=>r,x9:()=>l});let n=80,i=55,l=e=>"phone"===e?i:n;function r(e,t){return t?0:l(e)}},735571:function(e,t,a){a.d(t,{Z:()=>l,k:()=>n.kH});var n=a(400850),i=a(774838);let l=({dateFormatType:e,useUTC:t=!0,value:a})=>{let l=(0,i.B)();return(0,n.ZP)(l.locale,a,e,t)}},261954:function(e,t,a){a.r(t),a.d(t,{default:()=>T});var n=a(686659),i=a(667294),l=a(740097),r=a(2171),s=a(230201),o=a(817468);function d(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}let u={},c=e=>{let t=e.__id||e.id;return"string"==typeof t&&t||null};class p{constructor(){d(this,"idMap",new Map),d(this,"objMap",new WeakMap)}get(e){let t=c(e);return this.objMap.get(e)??(t?this.idMap.get(t):void 0)}has(e){let t=c(e);return this.objMap.has(e)??(!!t&&this.idMap.has(t))}set(e,t){let a=c(e);a&&this.idMap.set(a,t),this.objMap.set(e,t)}reset(){this.idMap=new Map,this.objMap=new WeakMap}}function g(e,t){return"number"==typeof e?e:"lg1"===t?e[t]??e.lg??1:e[t]??1}var h=a(309947),m=a(589172),y=a(721350),f=a(440077),x=a(59111),_=a(785893);let{css:v,animation:S}=y.Z,w={backgroundColor:f.zsO,animation:S,borderRadius:f.saV};function b({data:e}){(0,i.useEffect)(()=>{(0,n.Z)("SkeletonPin","/app/common/react/components/SkeletonLoadingStates/SkeletonPin.tsx")},[]);let{height:t}=e;return(0,_.jsxs)(i.Fragment,{children:[(0,_.jsx)(x.Z,{unsafeCSS:v}),(0,_.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:w},"data-test-id":"skeleton-pin",children:(0,_.jsx)(l.xu,{height:t})})]})}var k=a(806513),P=a(501010),F=a(774838),C=a(739405),j=a(767415),I=a(354139),R=a(177433);function T(e){(0,i.useEffect)(()=>{(0,n.Z)("Masonry","/app/packages/gestaltExtensions/Masonry/Masonry.tsx")},[]);let{align:t,cacheKey:a,id:d,isFetching:c,isGridCentered:y=!0,items:f,layout:v,loadItems:S,masonryRef:w,optOutFluidGridExperiment:T=!1,renderItem:Z,scrollContainerRef:E,virtualize:M=!0,getColumnSpanConfig:D,_getResponsiveModuleConfigForSecondItem:L,isLoadingStateEnabled:K,initialLoadingStatePinCount:A,isLoadingAccessibilityLabel:$,isLoadedAccessibilityLabel:z}=e,B=(0,C.ZP)(),O=(0,F.B)(),{isAuthenticated:N,isRTL:U,userAgent:W,stage:V}=O,{browserName:H,platform:G}=W,{logContextEvent:Y}=(0,s.u)(),X=(0,P.Z)(),q="desktop"===B,Q=(0,R.Zv)(),J=(0,I.DB)(),ee=((0,i.useRef)(f.map(()=>({fetchTimestamp:Date.now(),measureTimestamp:Date.now(),hasRendered:!1,pageCount:0}))),q&&!T),{experimentalColumnWidth:et,experimentalGutter:ea}=(0,h.Z)(ee),en=e.serverRender??!!q,ei="flexible"===v||"uniformRowFlexible"===v||"desktop"!==B||ee,el=(ei&&v?.startsWith("uniformRow")?"uniformRowFlexible":void 0)??(en?"serverRenderedFlexible":"flexible"),er=e.columnWidth??et??k.yF;ei&&(er=Math.floor(er));let es=e.gutterWidth??ea??(q?k.oX:1),eo=e.minCols??k.yc,ed=((0,i.useRef)(0),er+es),eu=function(e){if(null==e)return;let t=function(e){let t=u[e];return t&&t.screenWidth===window.innerWidth||(u[e]={screenWidth:window.innerWidth}),u[e]}(e);return t.measurementCache||(t.measurementCache=new p),t.measurementCache}(a),ec=(0,i.useCallback)(()=>E?.current||window,[E]),ep=(0,i.useRef)(!0),{anyEnabled:eg,group:eh}=X.checkExperiment("web_masonry_pin_overlap_calculation_and_logging"),{anyEnabled:em}=X.checkExperiment("visual_search_stl_eligibility_check_migration_gss_css",{dangerouslySkipActivation:!0}),ey=y&&ep.current?"centered":"",{className:ef,styles:ex}=function(e){let t=`m_${Object.keys(e).sort().reduce((t,a)=>{let n=e[a];return null==n||"object"==typeof n||"function"==typeof n?t:"boolean"==typeof n?t+(n?"t":"f"):t+n},"").replace(/\:/g,"\\:")}`,{flexible:a,gutterWidth:n,isRTL:i,itemWidth:l,maxColumns:r,minColumns:s,items:o,getColumnSpanConfig:d,_getResponsiveModuleConfigForSecondItem:u}=e,c=d?o.map((e,t)=>({index:t,columnSpanConfig:d(e)??1})).filter(e=>1!==e.columnSpanConfig):[],p=l+n,h=Array.from({length:r+1-s},(e,t)=>t+s).map(e=>{let h,m,y=e===s?0:e*p,f=e===r?null:(e+1)*p-.01;d&&u&&o.length>1&&(h=d(o[0]),m=u(o[1]));let{styles:x,numberOfVisibleItems:_}=c.reduce((i,r)=>{let{columnSpanConfig:s}=r,d=Math.min(function({columnCount:e,columnSpanConfig:t,firstItemColumnSpanConfig:a,isFlexibleWidthItem:n,secondItemResponsiveModuleConfig:i}){let l=e<=2?"sm":e<=4?"md":e<=6?"lg1":e<=8?"lg":"xl",r=g(t,l);if(n){let t=g(a,l);r="number"==typeof i?i:i?Math.max(i.min,Math.min(i.max,e-t)):1}return r}({columnCount:e,columnSpanConfig:s,isFlexibleWidthItem:!!m&&r===o[1],firstItemColumnSpanConfig:h??1,secondItemResponsiveModuleConfig:m??1}),e),u=null!=r.index&&i.numberOfVisibleItems>=d+r.index,c=a?100/e*d:l*d+n*(d-1),{numberOfVisibleItems:p}=i;return u?p-=d-1:r.index<p&&(p+=1),{styles:i.styles.concat(function({className:e,index:t,columnSpanConfig:a,visible:n,width:i,flexible:l}){let r="number"==typeof a?a:btoa(JSON.stringify(a));return l?`
      .${e} .static[data-column-span="${r}"]:nth-child(${t+1}) {
        visibility: ${n?"visible":"hidden"} !important;
        position: ${n?"inherit":"absolute"} !important;
        width: ${i}% !important;
      }`:`
      .${e} .static[data-column-span="${r}"]:nth-child(${t+1}) {
        visibility: ${n?"visible":"hidden"} !important;
        position: ${n?"inherit":"absolute"} !important;
        width: ${i}px !important;
      }`}({className:t,index:r.index,columnSpanConfig:s,visible:u,width:c,flexible:a})),numberOfVisibleItems:p}},{styles:"",numberOfVisibleItems:e}),v=a?`
      .${t} .static {
        box-sizing: border-box;
        width: calc(100% / ${e}) !important;
      }
    `:`
      .${t} {
        max-width: ${e*p}px;
      }

      .${t} .static {
        width: ${l}px !important;
      }
    `;return{minWidth:y,maxWidth:f,styles:`
      .${t} .static:nth-child(-n+${_}) {
        position: static !important;
        visibility: visible !important;
        float: ${i?"right":"left"};
        display: block;
      }

      .${t} .static {
        padding: 0 ${n/2}px;
      }

      ${v}

      ${x}
    `}}),m=h.map(({minWidth:e,maxWidth:t,styles:a})=>`
    @container (min-width: ${e}px) ${t?`and (max-width: ${t}px)`:""} {
      ${a}
    }
  `),y=h.map(({minWidth:e,maxWidth:t,styles:a})=>`
    @media (min-width: ${e}px) ${t?`and (max-width: ${t}px)`:""} {
      ${a}
    }
  `),f=`
    ${m.join("")}
    @supports not (container-type: inline-size) {
      ${y.join("")}
    }
  `;return{className:t,styles:`
    .masonryContainer:has(.${t}) {
      container-type: inline-size;
    }

    .masonryContainer > .centered {
      margin-left: auto;
      margin-right: auto;
    }

    .${t} .static {
      position: absolute !important;
      visibility: hidden !important;
    }

    ${f}
  `}}({gutterWidth:es,flexible:ei,items:f,isRTL:U,itemWidth:er,maxColumns:e.maxColumns??Math.max(f.length,k.g5),minColumns:eo,getColumnSpanConfig:D,_getResponsiveModuleConfigForSecondItem:L}),e_=`${ey} ${ef}`.trim(),{anyEnabled:ev,expName:eS,group:ew,isMeasureAllEnabled:eb}=(0,m.Z)(),ek=((0,i.useRef)(void 0),(0,i.useRef)(f.length)),eP=(0,i.useRef)(0),eF=(0,i.useRef)(null);(0,i.useEffect)(()=>{ek.current=f.length,eP.current+=1},[f]),(0,i.useEffect)(()=>{if(ep.current&&(ep.current=!1),window.earlyGridRenderStats){let e={...(0,I.M3)({earlyHydrationConfig:J,handlerId:Q,requestContext:O}),status:window.earlyGridRenderStats.status??"unknown"};(0,j.nP)(`earlyHydrationDebug.masonry.earlyGridRender.status.${window.earlyGridRenderStats.status}`,{tags:e}),(0,j.LY)("earlyHydrationDebug.masonry.earlyGridRender.init",window.earlyGridRenderStats.init,{tags:e}),window.earlyGridRenderStats.start&&(0,j.LY)("earlyHydrationDebug.masonry.earlyGridRender.start",window.earlyGridRenderStats.start,{tags:e}),window.earlyGridRenderStats.end&&(0,j.LY)("earlyHydrationDebug.masonry.earlyGridRender.end",window.earlyGridRenderStats.end,{tags:e})}},[]),(0,i.useEffect)(()=>()=>{},[]);let eC=(0,i.useCallback)(e=>{let t=e.reduce((e,t)=>e+t),a=t/e.length,n={experimentalMasonryGroup:ew||"unknown",handlerId:Q,isAuthenticated:N,multiColumnItemSpan:e.length,browserName:H,platform:G,stage:V||"unknown"};(0,j.nP)("webapp.masonry.multiColumnWhitespace.count",{sampleRate:1,tags:n}),(0,j.S0)("webapp.masonry.multiColumnWhitespace.average",a,{sampleRate:1,tags:{...n,minCols:eo}}),Y({event_type:15878,component:14468,aux_data:{total_whitespace_px:t}}),Y({event_type:16062,component:14468,aux_data:{average_whitespace_px:a}}),Y({event_type:16063,component:14468,aux_data:{max_whitespace_px:Math.max(...e)}}),e.forEach(e=>{e>=50&&((0,j.nP)("webapp.masonry.multiColumnWhitespace.over50",{sampleRate:1,tags:n}),Y({event_type:16261,component:14468})),e>=100&&((0,j.nP)("webapp.masonry.multiColumnWhitespace.over100",{sampleRate:1,tags:n}),Y({event_type:16262,component:14468}))})},[H,ew,Q,N,Y,eo,G,V]),{_items:ej,_renderItem:eI}=function({initialLoadingStatePinCount:e=50,infiniteScrollPinCount:t=10,isFetching:a,items:n=[],renderItem:l,isLoadingStateEnabled:r}){let s=+(n.filter(e=>"object"==typeof e&&null!==e&&"type"in e&&"closeup_module"===e.type).length>0),o=r&&a,d=(0,i.useMemo)(()=>Array.from({length:n.length>s?t:e}).reduce((e,t,a)=>[...e,{height:a%2==0?356:236,key:`skeleton-pin-${a}`,isSkeleton:!0}],[]),[n.length,s,t,e]);return{_items:(0,i.useMemo)(()=>o?[...n,...d]:n,[o,n,d]),_renderItem:(0,i.useMemo)(()=>r?e=>{let{itemIdx:t,data:a}=e;return t>=n.length&&a&&"object"==typeof a&&"key"in a&&"height"in a?(0,_.jsx)(b,{data:a},a.key):l(e)}:l,[r,l,n.length])}}({isLoadingStateEnabled:K,items:f,renderItem:(0,i.useCallback)(e=>(0,_.jsx)(o.Z,{name:"MasonryItem",children:Z(e)}),[Z]),isFetching:c,initialLoadingStatePinCount:A}),eR=K&&c,eT=(0,i.useRef)(new Set);(0,i.useEffect)(()=>{if(!eg)return;let e={isAuthenticated:N,isDesktop:"desktop"===B,handlerId:Q,experimentalMasonryGroup:ew||"unknown",overlapCalculationAndLoggingGroup:eh||"unknown",visualSearchSTLexperiment:em?"true":"false",browserName:H,platform:G,stage:V||"unknown"},t=1e3;if(eh?.startsWith("enabled_")){let e=eh.split("enabled_")[1];e&&(t=parseInt(e,10))}let a=setTimeout(()=>{requestAnimationFrame(()=>{let t=Array.from(eF.current?.querySelectorAll("[data-grid-item-idx]")??[]);if(0===t.length)return;let a=t.map(e=>{let t=e.getAttribute("data-grid-item-idx");return{rect:e.getBoundingClientRect(),itemIdx:t}}),n=0,i=0,l=0,r=0,s=0,o=0;for(let e=0;e<a.length;e+=1){let t=a[e]?.rect,d=a[e]?.itemIdx;for(let u=e+1;u<a.length;u+=1){let e=a[u]?.rect,c=a[u]?.itemIdx;if(t&&e&&d&&c){let a=[d,c].sort().join("|");if(!eT.current.has(a)&&t.right>=e.left&&t.left<=e.right&&t.bottom>=e.top&&t.top<=e.bottom&&t.height>0&&e.height>0){eT.current.add(a),n+=1;let d=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left))*Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top));d>8e4?o+=1:d>4e4?s+=1:d>1e4?r+=1:d>5e3?l+=1:d>2500&&(i+=1)}}}}n>0&&(0,j.QX)("webapp.masonry.pinOverlapHits",n,{tags:e}),i>0&&(0,j.QX)("webapp.masonry.pinOverlap.AreaPx.over2500",i,{tags:e}),l>0&&(0,j.QX)("webapp.masonry.pinOverlap.AreaPx.over5000",l,{tags:e}),r>0&&(0,j.QX)("webapp.masonry.pinOverlap.AreaPx.over10000",r,{tags:e}),s>0&&(0,j.QX)("webapp.masonry.pinOverlap.AreaPx.over40000",s,{tags:e}),o>0&&(0,j.QX)("webapp.masonry.pinOverlap.AreaPx.over80000",o,{tags:e})})},t);return()=>{clearTimeout(a)}},[H,B,ew,N,eg,Q,G,eh,V,em]);let eZ=(0,r.Z)(),eE=(0,i.useCallback)(e=>{w&&(w.current=e)},[w]);return(0,_.jsxs)(i.Fragment,{children:[K&&!ep.current&&(0,_.jsx)(l.xu,{"aria-live":"polite",display:"visuallyHidden",children:eR?$:z}),(0,_.jsx)("div",{ref:eF,"aria-busy":K?!!eR:void 0,className:"masonryContainer","data-test-id":"masonry-container",id:d,style:ee?{padding:`0 ${es/2}px`}:void 0,children:(0,_.jsxs)("div",{className:e_,children:[en&&ep.current?(0,_.jsx)(x.Z,{"data-test-id":"masonry-ssr-styles",unsafeCSS:ex}):null,(0,_.jsx)(l.xu,{"data-test-id":"max-width-container",marginBottom:0,marginEnd:"auto",marginStart:"auto",marginTop:0,maxWidth:e.maxColumns?ed*e.maxColumns:void 0,children:ev?(0,_.jsx)(l.GX,{ref:eZ?eE:e=>{w&&(w.current=e)},_dynamicHeights:!0,_getResponsiveModuleConfigForSecondItem:L,_logTwoColWhitespace:eC,_measureAll:eb,align:t,columnWidth:er,getColumnSpanConfig:D,gutterWidth:es,items:ej,layout:ei?el:v??"basic",loadItems:S,measurementStore:eu,minCols:eo,renderItem:eI,scrollContainer:ec,virtualBufferFactor:.3,virtualize:M}):(0,_.jsx)(l.Rk,{ref:eZ?eE:e=>{w&&(w.current=e)},_dynamicHeights:!0,_fluidResize:!0,_getResponsiveModuleConfigForSecondItem:L,_logTwoColWhitespace:eC,align:t,columnWidth:er,getColumnSpanConfig:D,gutterWidth:es,items:ej,layout:ei?el:v??"basic",loadItems:S,measurementStore:eu,minCols:eo,renderItem:eI,scrollContainer:ec,virtualBufferFactor:.3,virtualize:M})})]})})]})}},171556:function(e,t,a){a.d(t,{Z:()=>r});var n=a(667294);function i(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class l extends n.Component{constructor(...e){super(...e),i(this,"ref",(0,n.createRef)()),i(this,"observer",null),i(this,"handleVisibilityChanged",(e,t)=>{this.props.onVisibilityChange(e,t)})}componentDidMount(){this.ref&&this.ref.current&&(this.observer=new window.IntersectionObserver(this.handleVisibilityChanged,this.props.options),this.observer.observe(this.ref.current))}componentWillUnmount(){this.observer&&(this.observer.unobserve(this.ref.current),delete this.observer)}render(){return this.props.children(this.ref)}}let r=l},583845:function(e,t,a){a.d(t,{Rq:()=>n,Vf:()=>i,jd:()=>l,oy:()=>r});let n=e=>"ios"===e&&(window.devicePixelRatio||1)*window.screen.height==2436,i=28,l=e=>window.innerHeight>=748&&n(e),r=()=>"undefined"!=typeof window&&!!window.navigator&&(/iPad/.test(navigator.platform)||"MacIntel"===navigator.platform&&"ontouchend"in document&&Math.min(window.screen.width,window.screen.height)>=700)},134136:function(e,t,a){a.r(t),a.d(t,{default:()=>c});var n=a(686659),i=a(667294),l=a(740097),r=a(806513),s=a(583845),o=a(873438),d=a(774838),u=a(785893);let c=({children:e,dataLayoutShiftBoundaryId:t,hasFixedHeader:a=!1,hasGutter:c=!0,height:p,showKeychainError:g=!1,useViewport:h=!1})=>{(0,i.useEffect)(()=>{(0,n.Z)("MobilePageContainer","/app/packages/layout/MobilePageContainer.tsx")},[]);let m=(0,d.B)(),y=(0,s.jd)(m.userAgent.platform)?s.Vf:0;return(0,u.jsx)(l.xu,{"data-layout-shift-boundary-id":t||"PageContainer",height:h?`calc(100vh - ${y}px)`:p,paddingX:c?r.D6:void 0,paddingY:a||g?void 0:3,children:(0,u.jsx)(o.C,{value:!!c,children:e})})}},816438:function(e,t,a){a.d(t,{r:()=>n});function n(e,t,a){return!!(e&&e.trim().length>0&&t&&!a)}},228121:function(e,t,a){a.d(t,{Z:()=>s}),a(167912);var n,i=a(183e3),l=a(24246);let r=(void 0!==n||(n=a(719962)).hash&&"01a93671cde480baa2cfd8b781589acd"!==n.hash&&console.error("The definition of 'useNormalizePinData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),s=e=>{let t,a=(0,l.Z)(),n=(0,i.Z)(r,e),s=n.trackedLink||n.link||n.imageSpec_orig&&n.imageSpec_orig.url,{richMetadata:o,richSummary:d}=n,u=a._('Saved from ', 'Closeup pin annotation', 'Closeup pin annotation');return o&&o.products&&o.products[0]&&o&&o.products[0].name&&o.products[0].offerSummary&&(u=a._('Product sold by ', 'pin annotation', 'pin annotation'),t=(o.products?.[0]||void 0)?.offerSummary),!t&&d&&d&&d.products&&d.products[0]&&d&&d.products[0].name&&d.products[0].offerSummary&&(u=a._('Product sold by ', 'pin annotation', 'pin annotation')),{pinLink:s,pinCreditPrefix:u,pinTitle:n.closeupUnifiedTitle,pinDescription:n.closeupUnifiedDescription,pinCategory:n.category}}},250026:function(e,t,a){a.d(t,{Z:()=>n});function n(e,t,a,i=0){if(-1===t||-1===a||t===a)return e;let l=a+i,r=t+i;if(l<0||l>=e.length||r<0||r>=e.length)return e;let s=[...e],o=s[r],d=r<l?1:-1;for(let t=r;t!==l;t+=d)s[t]=e[t+d];return s[l]=o,s}},70625:function(e,t,a){a.d(t,{Z:()=>n});let n=(0,a(667294).createContext)("undefined"!=typeof window?window:null)},112658:function(e,t,a){a.d(t,{Z:()=>x});var n=a(686659),i=a(667294),l=a(740097),r=a(400962),s=a(171556),o=a(774838),d=a(907049),u=a(49932),c=a(141483),p=a(623222),g=a(228612),h=a(785893);function m(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class y extends i.Component{constructor(e){super(e),m(this,"componentWillUnmount",()=>{this.unregisterComponent()}),m(this,"getContext",()=>{let{clientTrackingParams:e,component:t,element:a,objectId:n,timeSpentContext:i,view:l,viewParameter:r}=this.props;return{view:l||i?.view,viewParameter:r||i?.viewParameter,component:t||i?.component,element:a,objectId:n||i?.objectId,clientTrackingParams:e||i?.clientTrackingParams,getParentUuid:()=>this.getUuid(),getGrandparentUuid:()=>this.getParentId()}}),m(this,"getLoggerContext",()=>{let e={...this.getContext()};return delete e.getParentUuid,e}),m(this,"getParentId",()=>{let{timeSpentContext:e,shouldUseGrandparentId:t=!1}=this.props;if(t&&e&&e.getGrandparentUuid){let t=e.getGrandparentUuid();if(t)return t}return e?.getParentUuid?.()}),m(this,"getUuid",()=>this.state.timedPair?this.state.timedPair.uuid:void 0),m(this,"getTimedPair",()=>this.state.timedPair),m(this,"setTimedPair",(e,t)=>{this.setState({timedPair:e},()=>{t&&t()})}),m(this,"isRegistered",!1),m(this,"registerComponent",()=>{this.props.timeSpentManager.registerComponent(this),this.isRegistered=!0}),m(this,"unregisterComponent",()=>{this.isRegistered&&(this.props.timeSpentManager.unregisterComponent(this),this.isRegistered=!1)}),m(this,"handleVisibilityChange",e=>{let{intersectionRatio:t}=e[0],{bottom:a,left:n,right:i,top:l}=e[0].intersectionRect;t>0?this.registerComponent():0===t&&(0===a&&0===n&&0===i&&0===l?this.unregisterComponent():this.registerComponent())}),this.state={timedPair:new c.Z(this.getLoggerContext())}}componentDidUpdate(e){!this.isRegistered||e.view===this.props.view&&e.viewParameter===this.props.viewParameter&&e.component===this.props.component&&e.element===this.props.element&&e.objectId===this.props.objectId&&(0,d.Z)(e.auxData,this.props.auxData)&&(0,d.Z)(e.viewData,this.props.viewData)||(this.unregisterComponent(),setTimeout(this.registerComponent))}render(){let{children:e,intersectionObserverBoxHeight:t}=this.props;return(0,h.jsx)(p.$,{value:this.getContext(),children:(0,h.jsx)(s.Z,{onVisibilityChange:this.handleVisibilityChange,options:{threshold:0},children:a=>(0,h.jsx)(l.xu,{ref:a,height:t??"100%",children:i.Children.only(e)})})})}componentDidMount(){(0,n.Z)("DeprecatedTimeSpent","/app/packages/time-spent/DeprecatedTimeSpent.tsx")}}function f(e){let t=(0,r.ou)(),a=(0,p.a)(),n=(0,u.Z)(),l=(0,g.EQ)(),{requestIdentifier:s=""}=(0,o.B)(),d={app_instance_id:s.slice(0,8),...e.auxData??{}};return(0,i.useEffect)(()=>{n?.setHistoryStackContext(t)},[t,n]),(0,i.useEffect)(()=>{n?.setPins(l??{})},[l,n]),n?(0,h.jsx)(y,{...e,auxData:d,timeSpentContext:a,timeSpentManager:n,children:e.children}):e.children}f.displayName="DeprecatedTimeSpent";let x=f},623222:function(e,t,a){a.d(t,{$:()=>n,a:()=>i});let{Provider:n,getMaybe:i}=(0,a(213491).Z)("timeSpentContext")},128608:function(e,t,a){a.d(t,{Z:()=>n});function n(e,t){let a=0,n=!1,i=-1;return e.forEach((e,l)=>{let{x:r=0,y:s=0,h:o=0,w:d=0}=e,u=function(e,t){let{x:a,y:n,w:i,h:l}=e,{x:r,y:s,w:o,h:d}=t,u=Math.max(a,r),c=Math.min(a+i,r+o),p=Math.max(n,s),g=Math.min(n+l,s+d),h=u<c&&p<g?(c-u)*(g-p):0;return h/(i*l+o*d-h)}(t,{x:r,y:s,h:o,w:d});u>=.9&&u>a&&(a=u,n=!0,i=l)}),{isCropAreaOnDotArea:n,indexToHide:i}}},246427:function(e,t,a){a.d(t,{Z:()=>n});function n({cropArea:{x:e,y:t,w:a,h:n},scaledWidth:i,scaledHeight:l}){return{x:e/i,y:t/l,w:a/i,h:n/l}}},383903:function(e,t,a){a.d(t,{Z:()=>n});function n({cropArea:e,scaledWidth:t,scaledHeight:a}){let n=e.h||0;return{h:Math.floor(n*a),w:Math.floor((e.w||0)*t),x:Math.floor((e.x||0)*t),y:Math.floor((e.y||0)*a)}}},958306:function(e,t,a){a.d(t,{Z:()=>n});function n(e){return{h:e?.h??void 0,is_stela:e?.isStela??void 0,labelId:e?.labelId??void 0,label_x:e?.labelX??void 0,label_y:e?.labelY??void 0,label:e?.label??void 0,max_annotation_num_documents:e?.maxAnnotationNumDocuments??void 0,score:e?.score??void 0,show_on_closeup:e?.showOnCloseup??void 0,title:e?.title??void 0,w:e?.w??void 0,x:e?.x??void 0,y:e?.y??void 0}}},518112:function(e,t,a){a.r(t),a.d(t,{default:()=>b});var n=a(686659),i=a(667294),l=a(312048),r=a(740097),s=a(230201),o=a(59111),d=a(575820),u=a(383903),c=a(371266),p=a(674610),g=a(893957),h=a(501010),m=a(312321),y=a(785893);let f=Math.ceil(40),x=f+1;function _({isHidden:e,isObjectLevelCrop:t,isSelected:a,maskHeight:l,maskId:s,maskUrl:d,maskWidth:u,maskX:c,maskY:g}){(0,i.useEffect)(()=>{(0,n.Z)("CutoutGlow","/app/www/Cutouts/CutoutGlow.tsx")},[]);let{checkExperiment:_}=(0,h.Z)(),v="enabled_once"===_("web_cutout_glow").group,{insetIntensity:S,debugMode:w,showHiddenCutoutsinDebug:b}=function(e){let t=e.split("_");return{insetIntensity:""===t[0]||Number.isNaN(Number(t[0]))?void 0:Number(t[0]),debugMode:t.includes("debug"),showHiddenCutoutsinDebug:t.includes("all")}}(_("web_cutout_glow_inset").group),k=`glow-sweep-${s}`,P=Math.round(.35*l),F=l/2+P/2,C=t?.25:.5,{svgElement:j,maskStyle:I}=(0,m.Z)({debugMode:w,insetIntensity:S,kind:"glow",maskHeight:l,maskId:s,maskUrl:d,maskWidth:u});return(0,y.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{left:c,top:g,...I,visibility:a?"hidden":"visible"}},"data-test-id":"cutout-item",height:l,id:p.Ii,position:"absolute",width:u,children:(!e||b)&&(0,y.jsxs)(i.Fragment,{children:[j,(0,y.jsx)(o.Z,{unsafeCSS:`
          @keyframes ${k} {
            0%                    { mask-position: 0 -${F}px; opacity: ${C}; }
            ${f}% { mask-position: 0  ${F}px; opacity: ${C}; }
            ${x}%      { mask-position: 0  ${F}px; opacity: 0; }
            100%                  { mask-position: 0 -${F}px; opacity: 0; }
          }`}),(0,y.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"none",animation:v?`${k} 5s linear forwards`:`${k} 5s linear infinite`,animationDelay:"1s",maskImage:`
              radial-gradient(
                ellipse ${4*P}px ${P}px at center,
                white 0%,
                white 15%,
                rgba(255, 255, 255, 0.9) 30%,
                rgba(255, 255, 255, 0.7) 45%,
                rgba(255, 255, 255, 0.5) 55%,
                rgba(255, 255, 255, 0.3) 65%,
                rgba(255, 255, 255, 0.15) 72%,
                rgba(255, 255, 255, 0.06) 80%,
                rgba(255, 255, 255, 0.01) 90%,
                transparent 100%
              )`,maskPosition:`0 -${F}px`,maskSize:"100% 100%",maskRepeat:"no-repeat"}},"data-test-id":"cutout-glow-oval",height:"100%",opacity:0,width:"100%",children:(0,y.jsx)(r.Ee,{alt:"cutout-glow-background-image",color:"white",fetchPriority:"high",fit:"cover",loading:"eager",naturalHeight:l,naturalWidth:u,role:"presentation",src:t?void 0:"https://s.pinimg.com/webapp/cutout-glow-background-7b325b4f.jpg"})})]})})}var v=a(391746);function S({isHovered:e,isObjectLevelCrop:t,isPinLevelCrop:a,isSelected:l,mask:r,pinImageHeight:o,pinImageUrl:d,pinImageWidth:u,viewParameter:c,viewType:p}){(0,i.useEffect)(()=>{(0,n.Z)("CutoutObject","/app/www/Cutouts/CutoutObject.tsx")},[]);let{logContextEvent:h}=(0,s.u)(),{id:m,isHidden:f,maskHeight:x,maskUrl:S,maskWidth:w,maskX:b,maskY:k}=r;return(0,g.Z)(()=>{f||h({event_type:120,element:14154,view_parameter:c,view_type:p,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}})}),(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)(v.Z,{imageHeight:o,imageUrl:d,imageWidth:u,isHovered:e,isPinLevelCrop:a,isSelected:l,maskHeight:x,maskId:m,maskUrl:S,maskWidth:w,maskX:b,maskY:k}),(0,y.jsx)(_,{isHidden:f,isObjectLevelCrop:t,isSelected:l,maskHeight:x,maskId:m,maskUrl:S,maskWidth:w,maskX:b,maskY:k})]})}var w=a(225580);function b({bitmapMasks:e,hoveredCutoutIndex:t,imageContainerX:a,imageContainerY:g,onCropperUpdate:m,pinImageHeight:f,pinImageUrl:x,pinImageWidth:_,selectedCutoutIndex:v,setHoveredCutoutIndex:b,setSelectedCutoutIndex:k,trafficSource:P,viewParameter:F,viewType:C}){(0,i.useEffect)(()=>{(0,n.Z)("CutoutObjects","/app/www/Cutouts/CutoutObjects.tsx")},[]);let{logContextEvent:j}=(0,s.u)(),I=(0,l.TH)(),R=(0,l.s0)(),T=(0,i.useRef)(null),[Z,E]=(0,i.useState)(!1),{w:M,h:D,cropSource:L}=(0,d.mB)(I.search),K=(0,i.useMemo)(()=>Number(M)===_&&Number(D)===f||void 0===M&&void 0===D,[D,f,_,M]),A=(0,i.useMemo)(()=>9===Number(L),[L]),{cutoutContexts:$,maskData:z}=function(e,t,a){let[n,l]=(0,i.useState)([]),[r,s]=(0,i.useState)([]),[o,d]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let{maskData:n,urls:i}=e.reduce((e,n)=>{let i=(0,w.Fk)(n,t,a);return i&&(e.maskData.push(i.maskData),e.urls.push(i.maskUrl)),e},{maskData:[],urls:[]});if(s(n),0===n.length)return l([]),d(!1),()=>i.forEach(e=>URL.revokeObjectURL(e));let r=!1;return d(!0),(async()=>{let e=n.map(async e=>{let t=document.createElement("canvas"),a=t.getContext("2d",{willReadFrequently:!0});if(!a)return null;let{maskWidth:n,maskHeight:i}=e;t.width=n,t.height=i;try{let t=new Image;return t.crossOrigin="anonymous",new Promise(l=>{t.onload=()=>{if(r)return void l(null);a.drawImage(t,0,0,n,i),l(a)},t.onerror=()=>l(null),t.src=e.maskUrl})}catch{return null}}),t=await Promise.all(e);r||(l(t),d(!1))})(),()=>{r=!0,i.forEach(e=>URL.revokeObjectURL(e))}},[e,t,a]),{cutoutContexts:n,maskData:r,isLoading:o}}(e,_,f),B=function({maskData:e,cutoutContexts:t,imageContainerX:a,imageContainerY:n,setHoveredCutoutIndex:l,viewParameter:r,viewType:o}){let{logContextEvent:d}=(0,s.u)(),{checkExperiment:u}=(0,h.Z)(),{anyEnabled:c,group:p}=u("web_cutout_hit_detection_cache"),g="control"===p?1:"employees"===p?5:Number(p.split("_")[1]||5),m=(0,i.useRef)(new Map);(0,i.useEffect)(()=>{m.current.clear()},[e]);let y=(0,i.useCallback)((e,t)=>{e!==t&&(l(e),null!==e&&d({event_type:105,element:14154,view_parameter:r,view_type:o,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}))},[l,d,r,o]);return(0,i.useCallback)((i,l,r)=>{let s=c?`${Math.round(i.clientX/g)*g},${Math.round(i.clientY/g)*g}`:"";if(c&&m.current.has(s))return void y(m.current.get(s)??null,l);let o=i.clientX-a,d=i.clientY-n;for(let a=e.length-1;a>=0;a-=1){let n=e[a],i=t[a];if(!i||!n||a===r||!(0,w.Of)(o,d,n))continue;let u=o-n.maskX,p=d-n.maskY;if((0,w.Bt)(i,u,p)){c&&m.current.set(s,a),y(a,l);return}}c&&m.current.set(s,null),y(null,l)},[c,t,a,n,e,g,y])}({maskData:z,cutoutContexts:$,imageContainerX:a,imageContainerY:g,setHoveredCutoutIndex:b,viewParameter:F,viewType:C}),O=(0,i.useCallback)(()=>E(!1),[]),N=(0,i.useCallback)(e=>{(e.movementX||e.movementY)&&E(!0),0===e.buttons?B(e,t,v):b?.(null)},[B,t,v,b]),U=(0,i.useCallback)(e=>B(e,t,v),[B,t,v]),W=(0,i.useCallback)(()=>b(null),[b]),V=(0,i.useCallback)(()=>{if(Z||null===t)return void E(!1);if(b(null),k(t),!z[t])return;let{maskXRatio:e,maskYRatio:a,maskWidthRatio:n,maskHeightRatio:i}=z[t],l=(0,u.Z)({cropArea:{x:e,y:a,w:n,h:i},scaledWidth:_,scaledHeight:f});if(m)m({cropArea:l,cropSource:9}),j({event_type:101,element:14154,view_parameter:F,view_type:C});else{let e=(0,c.Z)({cropArea:l,cropSource:9,trafficSource:P});window.location.search!==e&&(j({event_type:101,element:14154,view_parameter:F,view_type:C,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}),R(`${window.location.pathname}${e}`,{replace:!0}))}},[Z,t,b,k,z,_,f,m,P,j,F,C,R]);return(0,i.useEffect)(()=>{let e=T.current;if(e)return e.addEventListener("mousedown",O),e.addEventListener("mousemove",N),e.addEventListener("mouseup",U),e.addEventListener("mouseleave",W),e.addEventListener("click",V),()=>{e.removeEventListener("mousedown",O),e.removeEventListener("mousemove",N),e.removeEventListener("mouseup",U),e.removeEventListener("mouseleave",W),e.removeEventListener("click",V)}},[O,N,U,W,V]),(0,y.jsxs)(r.xu,{ref:T,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:"number"==typeof t?"pointer":"auto"}},"data-bitmaps-ready":z.length>0,"data-test-id":"cutouts-container",left:!0,position:"absolute",right:!0,role:"none",top:!0,children:[(0,y.jsx)(o.Z,{unsafeCSS:p.iF}),z.map((e,a)=>(0,y.jsx)(S,{isHovered:t===a,isObjectLevelCrop:A,isPinLevelCrop:K,isSelected:v===a,mask:e,pinImageHeight:f,pinImageUrl:x,pinImageWidth:_,viewParameter:F,viewType:C},e.id))]})}},391746:function(e,t,a){a.d(t,{Z:()=>c});var n=a(686659),i=a(667294),l=a(407504),r=a(740097),s=a(501010),o=a(674610),d=a(312321),u=a(785893);function c({imageHeight:e,imageUrl:t,imageWidth:a,isHovered:c,isPinLevelCrop:p,isSelected:g,maskHeight:h,maskId:m,maskUrl:y,maskWidth:f,maskX:x,maskY:_}){(0,i.useEffect)(()=>{(0,n.Z)("CutoutOverlay","/app/www/Cutouts/CutoutOverlay.tsx")},[]);let{checkExperiment:v}=(0,s.Z)(),S=v("web_cropper_object_selection").anyEnabled,w=(0,i.useRef)(null),b=S?c||g:c,k=p&&c?1.2:1,{svgElement:P,maskStyle:F}=(0,d.Z)({maskUrl:y,maskWidth:f,maskHeight:h,maskId:m,kind:"overlay"});return(0,u.jsx)(l.Z,{appear:g,classNames:o.We,in:b,nodeRef:w,timeout:{appear:o.VI,enter:o.eZ,exit:o.eZ},children:(0,u.jsxs)(r.xu,{ref:w,dangerouslySetInlineStyle:{__style:{left:x,top:_,...F,pointerEvents:"none",filter:`brightness(${k})`}},height:h,opacity:0,overflow:"hidden",position:"absolute",width:f,children:[P,(0,u.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{left:-x,top:-_}},height:e,position:"absolute",width:a,children:(0,u.jsx)(r.Ee,{alt:"cutout-overlay-image",color:"transparent",fit:"cover",naturalHeight:e,naturalWidth:a,src:t})})]})})}},979173:function(e,t,a){a.d(t,{Z:()=>p,I:()=>c});var n=a(686659),i=a(667294),l=a(312048),r=a(740097),s=a(230201),o=a(391746);function d({contour:e,context:t,contourXRatio:a,contourYRatio:n}){t.beginPath(),e.points.forEach((e,i)=>{if(e){let l=e.x*a,r=e.y*n;0===i?t.moveTo(l,r):t.lineTo(l,r)}})}var u=a(785893);let c="stela-cutout";function p({auxData:e,bitmapData:t,hasAnimatedCutoutsOnLand:a,hasLoggedRender:p,hoveredCutoutIndex:g,index:h,isPinLevelCrop:m,pinImageHovered:y,pinImageHeight:f,pinImageUrl:x,pinImageWidth:_,selectedCutoutIndex:v,setHasAnimatedCutoutsOnLand:S,setHasLoggedRender:w,viewParameter:b,viewType:k}){(0,i.useEffect)(()=>{(0,n.Z)("StelaCutout","/app/www/Cutouts/StelaCutout.tsx")},[]);let{logContextEvent:P}=(0,s.u)(),F=(0,l.TH)(),C=(0,i.useRef)(null),j=(0,i.useRef)(null),I=(0,i.useRef)(null),[R,T]=(0,i.useState)(0),[Z,E]=(0,i.useState)(!1),[M,D]=(0,i.useState)(0),[L,K]=(0,i.useState)(!1),A=F.pathname.includes("visual-search"),{contours:$,contourXRatio:z,contourYRatio:B,id:O,isHidden:N,maskHeightRatio:U,maskUrl:W,maskWidthRatio:V,maskXRatio:H,maskYRatio:G}=t,Y=H*_,X=G*f,q=V*_,Q=U*f,J=g===h,ee=v===h,et=$&&$.length>0;(0,i.useEffect)(()=>{p||(P({event_type:120,element:14154,view_parameter:b,view_type:k,aux_data:e}),w?.(!0))},[e,p,P,w,b,k]),(0,i.useEffect)(()=>{C.current&&(C.current.width=q,C.current.height=Q,j.current=new(window.OffscreenCanvas||window.HTMLCanvasElement)(q,Q))},[q,Q]);let ea=(0,i.useCallback)(()=>{K(!0)},[]);return(0,i.useEffect)(()=>{let e=C.current;return e?.addEventListener("transitionend",ea),()=>{e?.removeEventListener("transitionend",ea)}}),(0,i.useEffect)(()=>{if(!C.current||!j.current||!et||!z||!B)return;let e=C.current.getContext("2d");return a?void e?.clearRect(0,0,C.current.width,C.current.height):((!L||y||N&&J)&&(I.current=requestAnimationFrame(()=>{if(!C.current||!j.current)return;let t=j.current.getContext("2d");e&&t&&(!function({contours:e,context:t,hasAnimatedCutoutsOnLand:a,hoveredCutoutIndex:n,index:i,isHidden:l,contourXRatio:r,contourYRatio:s,setTraceProgress:o,setHasAnimatedCutoutsOnLand:u,style:c,traceProgress:p,selectedCutoutIndex:g}){if(t.clearRect(0,0,t.canvas.width,t.canvas.height),!e||0===e.length||g===n&&n===i||g===i)return;let h={trace:{strokeStyle:"#fff",lineWidth:2},outline:{strokeStyle:"#fff",lineWidth:3}},m=l&&n===i,y=!l||m;if("trace"===c&&void 0!==p){let l=p,g=e[0].points.length;if(a){if(m||n===i){o(l=(l+900/((e,t,a)=>{let n=0;for(let i=0;i<e.length-1;i+=1){let l=e[i],r=e[i+1];if(l&&r){let e=(r.x-l.x)*t,i=(r.y-l.y)*a;n+=Math.sqrt(e*e+i*i)}}if(e.length>0){let i=e[0],l=e[e.length-1];if(i&&l){let e=(i.x-l.x)*t,r=(i.y-l.y)*a;n+=Math.sqrt(e*e+r*r)}}return n})(e[0].points,r,s)*3.2/1e3)%1);let a=Math.floor(.33*g),n=Math.floor(g*l),i=(n-a+g)%g;e.map(e=>({...e,points:i<n?e.points.slice(i,n):e.points.slice(i).concat(e.points.slice(0,n))})).forEach(e=>{e.points.length>1&&(t.strokeStyle=h[c].strokeStyle,d({contour:e,context:t,contourXRatio:r,contourYRatio:s}),y&&(t.lineWidth=h[c].lineWidth,t.stroke()))})}}else{let a,n;if(o(l+=l<=1?.0032:.009600000000000001),l>=2){o(1),u(!0);return}let i=Math.floor(.33*g);l<=1?n=((a=Math.floor(g*l))-i+g)%g:(a=g,n=Math.floor(g-i+i*(l-1))),e.map(e=>{let t=[];return t=n<a?e.points.slice(n,a):e.points.slice(n).concat(e.points.slice(0,a)),{...e,points:t}}).forEach(e=>{e.points.length>1&&(t.strokeStyle=h[c].strokeStyle,d({contour:e,context:t,contourXRatio:r,contourYRatio:s}),y&&(t.lineWidth=h[c].lineWidth,t.stroke()))})}}else e.forEach(e=>{d({contour:e,context:t,contourXRatio:r,contourYRatio:s}),y&&(t.strokeStyle=h[c].strokeStyle,t.lineWidth=h[c].lineWidth,t.stroke(),n===i&&(t.save(),t.fillStyle="rgba(255, 255, 255, 0.25)",t.fill(),t.restore()))})}({contours:$,context:t,contourXRatio:z,contourYRatio:B,index:h,isHidden:N,hoveredCutoutIndex:g,opacity:R,setTraceProgress:D,hasAnimatedCutoutsOnLand:a,setHasAnimatedCutoutsOnLand:S,style:"trace",traceProgress:M,selectedCutoutIndex:v}),e.clearRect(0,0,C.current.width,C.current.height),e.drawImage(j.current,0,0))})),()=>{I.current&&(cancelAnimationFrame(I.current),I.current=null)})},[z,B,$,a,et,g,h,L,N,J,R,y,v,S,M]),(0,i.useEffect)(()=>{if(y)E(!0),T(1);else if(Z)T(0);else{T(1);let e=setTimeout(()=>{E(!1),T(0)},3e3);return()=>clearTimeout(e)}},[y,Z,T]),(0,u.jsxs)(r.xu,{children:[(0,u.jsx)(o.Z,{imageHeight:f,imageUrl:x,imageWidth:_,isHovered:J,isPinLevelCrop:m,isSelected:ee,maskHeight:Q,maskId:O,maskUrl:W,maskWidth:q,maskX:Y,maskY:X}),et&&(0,u.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{top:X,left:Y}},height:Q,position:"absolute",width:q,children:(0,u.jsx)("canvas",{ref:C,"data-test-id":"cutout-item",id:c,style:{opacity:A||y?1:R,transition:y||Z||A?"none":"opacity 2s linear 1s"}})})]})}},674610:function(e,t,a){a.d(t,{Ii:()=>n,VI:()=>l,We:()=>i,eZ:()=>r,iF:()=>s});let n="stela-cutout",i="cutout-fade",l=2e3,r=300,s=`
  .${i}-appear {
    opacity: 0;
  }
  .${i}-appear-active {
    opacity: 1;
    transition: opacity ${l}ms;
  }
  .${i}-appear-done {
    opacity: 1;
  }

  .${i}-enter {
    opacity: 0;
  }
  .${i}-enter-active {
    opacity: 1;
    transition: opacity ${r}ms;
  }
  .${i}-enter-done {
    opacity: 1;
  }

  .${i}-exit {
    opacity: 1;
  }
  .${i}-exit-active {
    opacity: 0;
    transition: opacity ${r}ms;
  }
  .${i}-exit-done {
    opacity: 0;
  }
`},312321:function(e,t,a){a.d(t,{Z:()=>i});var n=a(785893);function i({blurIntensity:e=.1,debugMode:t=!1,insetIntensity:a=2,kind:i,maskHeight:l,maskId:r,maskUrl:s,maskWidth:o,maxBlurLength:d=100}){let u=`${i}-${r}`,c=`insetBlurFilter-${u}`,p=`originalMask-${u}`,g=`featheredMask-${u}`,h=Math.min(d,Math.round(Math.min(o,l)))*e;return{svgElement:(0,n.jsxs)("svg",{"data-gestalt-valid-html":"Image",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},children:[(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:c,children:[(0,n.jsx)("feGaussianBlur",{edgeMode:"none",stdDeviation:h}),(0,n.jsx)("feComponentTransfer",{children:(0,n.jsx)("feFuncA",{amplitude:"1",exponent:a,offset:"0",type:"gamma"})})]}),(0,n.jsx)("mask",{id:p,children:(0,n.jsx)("image",{height:l,href:s,id:`${p}-image`,width:o})}),(0,n.jsx)("use",{href:`#${p}-image`,id:`${p}-white`,mask:`url(#${p})`}),(0,n.jsx)("mask",{id:g,children:(0,n.jsx)("use",{filter:`url(#${c})`,href:`#${p}-white`,mask:`url(#${p})`})})]}),t&&(0,n.jsx)("rect",{fill:"green",height:l,mask:`url(#${g})`,width:o,x:"0",y:"0"})]}),maskStyle:{mask:`url(#${g})`}}}},509307:function(e,t,a){a.d(t,{Z:()=>n});function n(e,t){let{x:a,y:n}=e,i=!1,l=0,r=t.length-1;for(;l<t.length;){let{x:e,y:s}=t[l],{x:o,y:d}=t[r];s>n!=d>n&&a<(o-e)*(n-s)/(d-s)+e&&(i=!i),r=l,l+=1}return i}},415349:function(e,t,a){a.d(t,{Z:()=>p});var n,i=a(667294);a(167912);var l=a(877762);async function r({imageBlob:e,boundingBox:t}){let a=new FormData;a.append("image",e),t&&a.append("bounding_box",t);let{promise:n}=(0,l.Z)({url:"/camera-sam-segmentation/",type:"PUT",data:a}),i=await n,{data:r}=(await i.json()).responsePayload.resourceResponse;return r}var s=a(183e3),o=a(661376),d=a(198861);let u=(void 0!==n||(n=a(423540)).hash&&"50c726067ab8af873ed4afded90b7bed"!==n.hash&&console.error("The definition of 'useSamSegmentation_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),c=e=>JSON.stringify({x:Math.min(Math.max(e.x||0,0),1),y:Math.min(Math.max(e.y||0,0),1),width:Math.min(Math.max(e.w||1,0),1),height:Math.min(Math.max(e.h||1,0),1)});function p({pinKey:e,isVisualSearch:t=!1,boundingBox:a,imageBlob:n,isCollage:l=!1,isCustomImage:p=!1}){let g=(0,s.Z)(u,e),h=(0,d.Z)(),m=(0,i.useMemo)(()=>({client:"visual_cutout",cleanup_masks:!0,...a&&{bounding_box:c(a),use_gss:!1,write_to_galaxy:!1}}),[a]),{data:y}=(0,o.Z)(g&&g.entityId?{name:"ApiResource",options:{url:`/v3/pins/${g.entityId}/segmentation/sam/`,data:{...t&&h,...l&&m}}}:null),f=function({imageBlob:e,isCustomImage:t=!1,boundingBox:a}){let[n,l]=(0,i.useState)(null);return(0,i.useEffect)(()=>{let n=async()=>{t&&e&&l(await r({imageBlob:e,boundingBox:a}))};l(null),n()},[t,e,a]),n}({imageBlob:n,isCustomImage:p,boundingBox:a?c(a):void 0});return p?f:y}},198861:function(e,t,a){a.d(t,{Z:()=>l});var n=a(667294),i=a(501010);function l(){return(0,n.useMemo)(()=>{let{checkExperiment:e}=(0,i.Z)(),{group:t}=e("dtn_exp6_uve4a"),a={client:"visual_cutout",cleanup_masks:!0};return"enabled"===t?{...a,detection_model:"dtn_exp6_yolov8"}:"enabled_dtn_exp5_skip_gss"===t?{...a,use_gss:!1,write_to_galaxy:!1}:a},[])}},225580:function(e,t,a){a.d(t,{Bt:()=>i,Fk:()=>r,Of:()=>n,R7:()=>l});let n=(e,t,a)=>{let{maskX:n,maskY:i,maskWidth:l,maskHeight:r}=a;return e>=n&&e<=n+l&&t>=i&&t<=i+r},i=(e,t,a)=>{if(t<0||a<0||t>=e.canvas.width||a>=e.canvas.height)return!1;try{let n=e.getImageData(t,a,1,1).data[0];return void 0!==n&&n>0}catch{return!1}},l=e=>{let{id:t,mask_image:a,mask_bounds:n}=e;if(!t||!a||!n||2!==n.length)return!1;let[i,l]=n;if(!i||!l||2!==i.length||2!==l.length)return!1;let[r,s]=i,[o,d]=l;return[r,s,o,d].every(e=>"number"==typeof e&&!Number.isNaN(e))},r=(e,t,a)=>{if(!l(e))return null;let{id:n,mask_image:i,mask_bounds:r,is_hidden:s}=e,[o,d]=r[0],[u,c]=r[1],p=(e=>{try{let t=atob(e),a=Uint8Array.from(t,e=>e.charCodeAt(0)),n=new Blob([a],{type:"image/png"});return URL.createObjectURL(n)}catch{return null}})(i);return p?{maskData:{id:n,isHidden:!!s,maskHeight:c*a,maskHeightRatio:c,maskUrl:p,maskWidth:u*t,maskWidthRatio:u,maskX:o*t,maskXRatio:o,maskY:d*a,maskYRatio:d},maskUrl:p}:null}},229793:function(e,t,a){a.d(t,{Z:()=>l});var n=a(667294),i=a(758714);function l(e){return(0,n.useMemo)(()=>{let[t,a]=(0,i.Rn)({hexColor:e||"#FFFFFF",saturationMultiplier:3,brightnessMultiplier:1.6,minSaturationClamp:.15,mixVal:.3,minBrightnessClamp:0}),n=`rgba(${a[0]}, ${a[1]}, ${a[2]}, 0.8)`,l=`rgba(${t[0]}, ${t[1]}, ${t[2]}, 0.8)`,r=(0,i.e3)((0,i.rk)((0,i.t7)("rgba(117, 117, 112, 0.2)"),(0,i.t7)(n))),s=(0,i.e3)((0,i.rk)((0,i.t7)("rgba(117, 117, 112, 0.4)"),(0,i.t7)(n)));return{defaultColor:n,selectedColor:l,hoveredColor:r,pressedColor:s}},[e])}},471310:function(e,t,a){a.d(t,{Z:()=>d});var n=a(686659),i=a(667294),l=a(740097),r=a(230201),s=a(24246),o=a(785893);function d({auxData:e,enabled:t,onPull:a,refreshing:d,viewParameter:u}){(0,i.useEffect)(()=>{(0,n.Z)("PullToRefresh","/app/www/Homefeed/PullMenu/PullToRefresh.tsx")},[]);let c=(0,s.Z)(),{logContextEvent:p}=(0,r.u)(),g=4079===u,{position:h,startYRefCurrent:m,pullDistance:y}=function({enabled:e,onSelect:t,refreshing:a}){let n=(0,i.useRef)(null),[l,r]=(0,i.useState)(0),[s,o]=(0,i.useState)(!1),d=a?0:l/250,u=d>0,c=()=>{o(!1),r(0)};return(0,i.useEffect)(()=>{if(e){let e=e=>{window.scrollY<=0&&!a&&(n.current=e.touches[0].clientY)},i=e=>{if(n.current){let t=(e.touches[0].clientY-n.current)*.5;t>0&&(r(t),e.preventDefault())}},s=()=>{n.current&&(o(!0),t({pullDistance:l,position:d,resetState:c}),n.current=null)};return window.addEventListener("touchstart",e),window.addEventListener("touchmove",i,{passive:!1}),window.addEventListener("touchend",s),()=>{window.removeEventListener("touchstart",e),window.removeEventListener("touchmove",i),window.removeEventListener("touchend",s)}}},[e,t,l,a,d]),{pullDistance:l,hasStartPulling:u,position:d,startYRefCurrent:n.current,PULL_MENU_DISTANCE:250,isExecuted:s}}({enabled:t,onSelect:t=>{let{pullDistance:n,resetState:i}=t;n>=120&&(p({view_type:1,event_type:158,view_parameter:g?4079:92,aux_data:g?e:{}}),a()),i()},refreshing:d}),f=Math.min(h,1),x=c._('Pull to refresh', 'Pull down on grid to refresh items', 'Pull down on grid to refresh items');return(0,o.jsx)(l.xu,{children:t&&(0,o.jsx)(l.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{opacity:f,transition:null===m?"all .3s ease-out":void 0}},display:"flex",height:120*h,justifyContent:"center",children:(0,o.jsx)(l.JO,{accessibilityLabel:x,icon:m&&y<120?"arrow-circle-down":"arrow-circle-up",size:40})})})}},989045:function(e,t,a){a.d(t,{Z:()=>o});var n=a(686659),i=a(667294),l=a(740097),r=a(739405),s=a(785893);let o=()=>{(0,i.useEffect)(()=>{(0,n.Z)("InitialFeedFetch","/app/www/InitialFeedFetch.tsx")},[]);let e=(0,r.HG)();return(0,s.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:e?{paddingTop:"0px",paddingBottom:"0px",marginTop:"0px",marginBottom:"0px"}:{paddingTop:"4px",paddingBottom:"4px",marginTop:"-4px",marginBottom:"-4px"}},"data-test-id":"initial-feed-fetch"})}},838855:function(e,t,a){a.d(t,{G:()=>_,Z:()=>v});var n=a(686659),i=a(667294),l=a(740097),r=a(261954),s=a(309947),o=a(806513),d=a(906127),u=a(70625),c=a(739405),p=a(893957),g=a(596663),h=a(471310),m=a(989045),y=a(759302),f=a(589247),x=a(785893);let _=25;function v({align:e,customLayoutType:t,getColumnSpanConfig:a,getResponsiveModuleConfigForSecondItem:_,emptyState:v,feedItems:S,feedKey:w,maxColumns:b,minColumns:k,pagination:{hasNext:P,isLoadingNext:F,loadNext:C,refetch:j},pullToRefresh:I,renderFeedItem:R,serverRender:T,isLoadingStateEnabled:Z,isLoadingAccessibilityLabel:E,isLoadedAccessibilityLabel:M,layout:D,forceShowLoadingState:L}){(0,i.useEffect)(()=>{(0,n.Z)("SimpleFeed","/app/www/SimpleFeed.tsx")},[]);let K=(0,c.HG)(),{experimentalColumnWidth:A,experimentalGutter:$}=(0,s.Z)(),[z,B]=(0,i.useState)(!1),O=1===b?window.innerWidth:void 0,N="userSearch"===t?window.innerWidth-16:200,U=F&&0===S.length&&!z&&!Z,W="desktopFlashlight"===t||"ideaPage"===t&&K?-2:o.qG,V=k??2;return"userSearch"===t&&(V=1),(0,p.Z)(()=>(window.addEventListener("online",C),()=>window.removeEventListener("online",C))),(0,x.jsxs)(l.xu,{"data-test-id":"MobileFeed",children:[(0,x.jsx)(h.Z,{enabled:!!I,onPull:()=>{j(),B(!0)},refreshing:z}),(0,x.jsxs)(l.xu,{"data-test-id":"grid",marginEnd:W,marginStart:W,opacity:z?.5:1,children:[(0,x.jsx)(d.Z,{isAtEndOfFeed:!P,isPlaceholderGrid:Z&&F&&!S.length,itemCount:S.length,children:S.length?(0,x.jsx)(l.xu,{"data-test-id":"feed",marginTop:(0,g.kk)({isDesktop:K}),children:(0,x.jsx)(u.Z.Consumer,{children:n=>(0,x.jsx)(i.Fragment,{children:(0,x.jsx)(f.Z,{children:(0,x.jsx)(r.default,{_getResponsiveModuleConfigForSecondItem:_,align:e||("ideaPage"===t?"start":void 0),cacheKey:w,columnWidth:K?A??o.yF:O??N,getColumnSpanConfig:a,gutterWidth:K?$??4*o.jC:void 0,id:T?w:void 0,isFetching:L??F,isLoadedAccessibilityLabel:M??"",isLoadingAccessibilityLabel:E??"",isLoadingStateEnabled:L??!!Z,items:S,layout:D??void 0,loadItems:C,maxColumns:b,minCols:V,optOutFluidGridExperiment:null!=b,renderItem:({data:e,itemIdx:t})=>R(e,t),scrollContainerRef:n,serverRender:T})})})})}):F?(0,x.jsx)(m.Z,{}):v??null}),U&&(0,x.jsx)(l.xu,{column:12,paddingY:2,children:(0,x.jsx)(y.Z,{partialViewportWidth:"desktopFlashlight"===t})})]})]})}},589247:function(e,t,a){a.d(t,{Z:()=>d});var n=a(686659),i=a(667294),l=a(935059),r=a(739405),s=a(153040),o=a(785893);let d=({children:e})=>{(0,i.useEffect)(()=>{(0,n.Z)("UnauthContextMenuControllerWrapper","/app/www/UnauthContextMenuControllerWrapper.tsx")},[]);let t=(0,r.HG)();return!(0,l.Z)().isAuth&&t?(0,o.jsx)(s.x,{children:e}):e}},728746:function(e,t,a){a.d(t,{Z:()=>e1});var n,i,l,r,s,o,d,u,c=a(686659),p=a(667294);a(167912);var g=a(740097),h=a(183e3),m=a(631155),y=a(24246),f=a(661376),x=a(854897),_=a(312048),v=a(226966),S=a(480610),w=a(785893);function b({isTopRow:e,image:t}){return(0,p.useEffect)(()=>{(0,c.Z)("ShoppingUpsellStoryCardDetail","/app/common/react/components/shopping/ShoppingUpsellStoryCardDetail.tsx")},[]),(0,w.jsxs)(g.zd,{height:e?217:168,wash:!0,width:e?236:117,children:[t.url&&(0,w.jsx)(g.Ee,{alt:t.alt||"",fit:"cover",naturalHeight:t.height??1,naturalWidth:t.width??1,src:t.url}),!!t.price&&(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"18px",color:"#111",fontSize:"10px",fontWeight:"600",lineHeight:"24px",padding:"06px"}},"data-test-id":"shopping-upsell-price",height:24,left:!0,margin:1,paddingX:2,paddingY:1,position:"absolute",top:!0,children:t.price})]})}var k=a(230201),P=a(319226),F=a(79271),C=a(78835),j=a(748336),I=a(594502),R=a(227866);let T={container:{borderRadius:`${C.Oc}px ${C.Oc}px 25px 25px`,WebkitMaskImage:"-webkit-radial-gradient(white, black)"},content:{marginBottom:"2px"},visualOverlay:{backgroundColor:"rgba(0, 0, 0, .1)"}},Z=({images:e,firstImageIndex:t})=>{let a=t+1,n=t+2;return(0,w.jsxs)(g.xu,{overflow:"hidden",rounding:4,children:[(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:{__style:T.content},children:e.at(t)?(0,w.jsx)(b,{image:e[t],isTopRow:!0}):null}),e.length>n?(0,w.jsxs)(g.kC,{alignItems:"stretch",justifyContent:"between",children:[(0,w.jsx)(b,{image:e[a]}),(0,w.jsx)(b,{image:e[n]})]}):null]})};function E({dangerouslySetActionUrl:e,query:t,story:a,slotIndex:n}){let i,l,r,s,o;(0,p.useEffect)(()=>{(0,c.Z)("ShoppingUpsellStoryCard","/app/common/react/components/shopping/ShoppingUpsellStoryCard.tsx")},[]);let{logContextEvent:d}=(0,k.u)(),{action:u,id:h,objects:m,story_type:y,subtitle:f}=a,{text:x,url:_}=u||{},[v,S]=(0,p.useState)(!1),b=(0,p.useCallback)(()=>S(!0),[S]),C=(0,p.useCallback)(()=>S(!1),[S]),E=(m||[]).reduce((e,t)=>"pin"!==t.type?e:[...e,{domain:t.domain,image:{alt:t.title||t.description,height:t.images?.["474x"]?.height,url:t.images?.["474x"]?.url,width:t.images?.["474x"]?.width,price:(t.rich_summary?.products?.[0]||{}).offer_summary?.price}}],[]),M=(E[0]||{}).domain||void 0;["search_product_collage_story","shop_article_story"].includes(y||"")?(i=2,l=43,r={story_id:h,story_type:y,entered_query:t}):"shop_brand_story"===y||"shop_brand_affinity_story"===y?(i=1,l=92,M&&(r={story_type:y,commerce_data:JSON.stringify({domain:M})})):["stela_in_flashlight_card","stela_in_flashlight_onecol"].includes(y||"")?(i=72,l=3050):"related_domain_collage"===y?(i=72,l=3455):"related_products_collage"===y&&(i=1,l=3177);let D=()=>d({event_type:101,element:372,component:200,view_type:i,view_parameter:l,aux_data:{story_type:y}}),L=f?4:2;if(["related_domain_collage","shop_brand_story","shop_brand_affinity_story"].includes(y||"")&&u){let e=u.user;s=e&&(e.image_medium_url||e.image_large_url),o=e&&e.full_name}let K=e||_;if(!K)return null;let A=(0,j.Z)({url:K})?"nofollow":"none";return(0,w.jsx)(F.Fw,{componentType:200,contextLogData:r||{},impressionType:"Story",loggingId:y,slotIndex:n,viewParameter:l,viewType:i,children:({impressionTrackerRef:e})=>(0,w.jsx)(g.xu,{ref:e,children:(0,w.jsx)(g.Tg,{href:K,onTap:D,rel:A,children:(0,w.jsxs)(g.xu,{dangerouslySetInlineStyle:{__style:T.container},onMouseEnter:b,onMouseLeave:C,overflow:"hidden",position:"relative",children:[(0,w.jsx)(Z,{firstImageIndex:+!!["related_domain_collage","related_products_collage"].includes(y||""),images:E.map(({image:e})=>e)}),(0,w.jsx)(g.xu,{alignItems:"center",color:"secondary",display:"flex",justifyContent:"center",marginTop:2,paddingX:3,paddingY:L,rounding:"pill",children:(0,w.jsxs)(g.xu,{alignContent:"start",direction:"column",display:"flex",justifyContent:"center",margin:2,children:[f?(0,w.jsx)(g.xu,{marginBottom:1,children:(0,w.jsx)(g.xe,{align:"start",color:"subtle",children:f.format})}):null,(0,w.jsx)(g.xe,{align:"start",weight:"bold",children:x})]})}),o&&s&&(0,w.jsx)(g.xu,{margin:2,position:"absolute",right:!0,top:!0,children:(0,w.jsx)(P.qE,{name:o,outline:!0,size:"md",src:s})}),(0,w.jsx)(I.Z,{visibility:v?"visible":"none",children:(0,w.jsx)(R.Z,{additionalStyles:T.visualOverlay})})]})})})})}var M=a(216975),D=a(935833);let L=(void 0!==n||(n=a(248894)).hash&&"610a35d46510240eb58e262c1909310c"!==n.hash&&console.error("The definition of 'BestPinCardAttribution_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),K=()=>{(0,D.NC)("click_best_pin_board",!0)},A=()=>{(0,D.NC)("click_best_pin_profile",!0)},$=({pin:e})=>{let{pinner:t}=e,{username:a,fullName:n}=t??{},i=t?.imageMediumUrl||t?.imageSmallUrl,l=`/${a??""}/`;return(0,w.jsx)(g.Tg,{fullWidth:!1,href:l,onTap:A,rounding:"circle",children:(0,w.jsx)(P.qE,{name:n??"",outline:!0,size:"sm",src:i??""})})},z=({pin:e})=>{let t=(0,y.Z)(),{board:a,pinner:n}=e,{name:i,privacy:l,url:r}=a??{},s=a?.entityId||"",{username:o,fullName:d}=n??{},u=`/${o??""}/`,c=(0,w.jsx)(g.xe,{inline:!0,size:"200",weight:"bold",children:(0,w.jsx)(g.rU,{display:"inlineBlock",href:u,onClick:A,underline:"hover",children:d})},d);return"protected"===l?(0,M.nk)(t._('{{ pinnerName }} saved this Pin', 'Showing who saved this pin, but not which board (private board), on closeup', 'Showing who saved this pin, but not which board (private board), on closeup'),{pinnerName:c}):(0,M.nk)(t._('{{ pinnerName }} saved to {{ boardName }}', 'Showing who saved this pin to which board on closeup', 'Showing who saved this pin to which board on closeup'),{pinnerName:c,boardName:(0,w.jsx)(g.xe,{inline:!0,size:"200",weight:"bold",children:(0,w.jsx)(g.rU,{href:r??"",onClick:K,children:i},"board")},s)})},B=({pinKey:e})=>{(0,p.useEffect)(()=>{(0,c.Z)("BestPinCardAttribution","/app/packages/BestPinCard/BestPinCardAttribution.tsx")},[]);let t=(0,h.Z)(L,e);return(0,w.jsxs)(g.xu,{alignItems:"center","data-test-id":"pin-attribution",direction:"row",display:"flex",marginTop:3,children:[(0,w.jsx)($,{pin:t}),(0,w.jsx)(g.xu,{marginEnd:2}),(0,w.jsx)(g.xe,{size:"200",children:(0,w.jsx)(z,{pin:t})})]})},O=e=>{e.target&&e.target instanceof HTMLElement&&(e.target.style.textDecoration="underline")},N=e=>{e.target&&e.target instanceof HTMLElement&&(e.target.style.textDecoration="none")};var U=a(104999);function W({pageType:e,pinCreditPrefix:t,pin:a,pinLink:n,viewParameter:i}){(0,p.useEffect)(()=>{(0,c.Z)("BestPinCardClickthroughLink","/app/packages/BestPinCard/BestPinCardClickthroughLink.tsx")},[]);let l=(0,y.Z)(),r=(0,U.Z)();if("topic"!==e.page&&(!a.domain||"Uploaded by user"===a.domain))return null;let s="topic"!==e.page||e.isAuth?"100":"200",o="topic"===e.page&&!!a.nativeCreator,d=o?a.nativeCreator?.fullName:a.domain;return(0,w.jsx)(g.xu,{display:"flex",flex:"none",justifyContent:"start",marginBottom:2,children:(0,w.jsx)(g.rU,{display:"inlineBlock",href:o?`/${a.nativeCreator?.username||""}/`:n,onClick:()=>{"topic"===e.page?(0,D.NC)("click_topic_best_pin_link"):r({event_type:12,view_type:3,object_id_str:a.entityId,component:85,view_parameter:i})},rel:"nofollow",target:"blank",underline:"hover",children:(0,w.jsx)(g.xe,{size:s,children:(0,M.nk)(l._('{{ pinCreditPrefix }} {{ pinCredit }}', 'Tells the user where the pin is from in the form of "Saved from <website>"', 'Tells the user where the pin is from in the form of "Saved from <website>"'),{pinCreditPrefix:t,pinCredit:(0,w.jsx)(g.xe,{inline:!0,size:s,weight:"bold",children:"topic"!==e.page?(0,w.jsxs)("span",{"data-gestalt-valid-html":"Text",onBlur:N,onFocus:O,onMouseLeave:N,onMouseOver:O,children:[" ",a.domain]}):d},o?"creatorProfile":"pinLinkDomain")})})})})}var V=a(735571),H=a(124631),G=a(816438),Y=a(331506),X=a(228121),q=a(455211),Q=a(891851),J=a(64151),ee=a(132781);let et=(void 0!==i||(i=a(426344)).hash&&"12f77507a9fdec344b44b7e659fa5ac1"!==i.hash&&console.error("The definition of 'RecipeMetadata_recipe' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function ea({recipeKey:e}){(0,p.useEffect)(()=>{(0,c.Z)("RecipeMetadata","/app/packages/recipePin/RecipeMetadata.tsx")},[]);let t=(0,h.Z)(et,e);if(t?.aggregateRating?.ratingValue&&t.aggregateRating.reviewCount){let e="number"==typeof t.cookTimes?.cook?.m&&"number"==typeof t.cookTimes.prep?.m?`${t.cookTimes.cook.m+t.cookTimes.prep.m} minutes \xb7 `:"";return(0,w.jsxs)(p.Fragment,{children:[(0,w.jsx)(ee.Z,{max_rating:t.aggregateRating.bestRating,rating:t.aggregateRating.ratingValue},t.aggregateRating.ratingValue),(0,w.jsx)(g.xe,{inline:!0,size:"200",children:` ${t.aggregateRating.reviewCount} \xb7 ${e}`})]})}return null}var en=a(774838);let ei=(void 0!==l||(l=a(981838)).hash&&"81db65fd15680cc0281b801ed4a8cb94"!==l.hash&&console.error("The definition of 'BestPinCardBody_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function el(e){(0,p.useEffect)(()=>{(0,c.Z)("BestPinCardBody","/app/packages/BestPinCard/BestPinCardBody.tsx")},[]);let{pinKey:t,viewportSize:a,pageType:n}=e,i=(0,h.Z)(ei,t),{pinCreditPrefix:l,pinLink:r}=(0,X.Z)(i),s=(0,q.Z)(i),{description:o}=(0,Y.eK)({richMetadataDescription:i.richMetadata?.description,richSummaryDisplayName:i.richSummary?.displayName,closeupUnifiedDescription:i.closeupUnifiedDescription});"videos_category"===n.page&&(o=(0,Y.kt)(o,i.nativeCreator?.username||""));let d="wide"===a,u=(0,Y.Ly)({pinTitle:i.title,gridTitle:i.gridTitle,richSummaryDisplayName:i.richSummary?.displayName??"",richMetadataTitle:i.richMetadata?.title??"",storyPinDataId:i.storyPinDataId,storyPinDataMetadataPinTitle:i.storyPinData?.metadata?.pinTitle,pinJoinVisualAnnotation:i.pinJoin?.visualAnnotation});(i.gridTitle||"").trim()&&u!==i.gridTitle&&(u=(0,Y.EU)(i.gridTitle,200));let m=(0,G.r)(i.richMetadata?.recipe?.name,!!i.richMetadata?.recipe?.categorizedIngredients,i.richMetadata?.recipe?.fromAggregatedData??!1)?i.richMetadata?.recipe:null,y=!!(i.richMetadata&&i.richMetadata.article&&i.richMetadata.article.datePublished)&&((e,t)=>{let a=new Date((e.richMetadata??{}).article?.datePublished??Date.now()),n=a.getTime();return new Date().getTime()-n<=63072e6?(0,w.jsx)(V.Z,{dateFormatType:V.k.LONG_MONTH_YEAR,useUTC:!1,value:a}):""})(i,0),f=(e=>{let t,a,n="";if(e.richMetadata&&e.richMetadata.article&&e.richMetadata.article.datePublished)return n;let i=(t=null,e.lastRepinDate&&(t=new Date(e.lastRepinDate)),a=null,(e.createdAt&&(a=new Date(e.createdAt)),t)?a?t>a?t:a:t:a);if(i&&i.getFullYear()===new Date().getFullYear()){let t=new Set(["film_music_books","art","home_decor","food_drink","womens_fashion","travel","weddings","hair_beauty","holidays_events","mens_fashion","products","celebrities","technology"]),{category:a}=e;t.has(a)&&(n=i?(0,w.jsx)(V.Z,{dateFormatType:V.k.LONG_MONTH_YEAR,useUTC:!1,value:i}):"")}return n})(i)||y,{isBot:x,isSocialBot:_}=(0,en.B)();return(0,w.jsx)(g.xu,{alignContent:"between","data-test-id":"UnauthBestPinCardBodyContainer",direction:"column",display:"flex",flex:"grow",padding:8,position:"relative",width:"100%",children:(0,w.jsxs)(g.xu,{direction:"column",display:"flex",flex:"grow",position:"relative",children:[(0,w.jsx)(W,{pageType:n,pin:{entityId:i.entityId,domain:i.domain||"",nativeCreator:i.nativeCreator&&{fullName:i.nativeCreator.fullName,username:i.nativeCreator.username}},pinCreditPrefix:"topic"===n.page&&i.nativeCreator?"Created by":l,pinLink:r??"",viewParameter:(0,Q.Z)({hasPin:!0,hasPinRichMetadata:!!i.richMetadata,hasPinRichMetadataProducts:!!i.richMetadata?.products,hasPinRichMetadataArticle:!!i.richMetadata?.article,hasPinRichMetadataRecipe:!!i.richMetadata?.recipe,hasPinStoryPinData:!!i.storyPinData})}),(0,w.jsx)(g.kC,{direction:"row",justifyContent:"between",children:(0,w.jsx)(g.xu,{display:"flex",marginEnd:3*!d,marginTop:3*!!d,overflow:"hidden",children:u&&(0,w.jsx)("h2",{"data-test-id":"UnauthBestPinCardTitle",style:{fontWeight:600,fontSize:"28px",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:u})})}),f?(0,w.jsx)(g.xu,{marginTop:1,children:(0,w.jsx)(g.xe,{color:"subtle",children:f})}):null,o&&(0,w.jsx)(g.xu,{display:"flex",marginTop:3,overflow:"hidden",children:(0,w.jsxs)("h3",{style:{fontWeight:"normal",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",fontSize:"14px"},children:[m&&(0,w.jsx)(ea,{recipeKey:m}),o]})}),m&&(0,w.jsx)(J.Z,{marginOverrides:m?{outerMarginTop:32,ingredientMarginBottom:4}:null,recipeProps:{recipe:{categorizedIngredients:m.categorizedIngredients,name:m.name,image:(0,H.Z)({imagesUrls:s,embedSrc:i.embed?.src,embedType:i.embed?.type,excludeOriginals:!x&&!_})}}}),(0,w.jsx)(g.xu,{alignItems:"center",direction:"row",display:"flex",justifyContent:"between",marginTop:2,children:(0,w.jsx)(B,{pinKey:i})})]})})}var er=a(221175),es=a(407504);let eo={nw:0,ne:90,se:180,sw:270},ed={ne:[7,-7],se:[7,7],sw:[-7,7],nw:[-7,-7]},eu={nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};function ec({corner:e,x:t,y:a,size:n,cornerStyle:i}){return(0,p.useEffect)(()=>{(0,c.Z)("CropperCorner","/app/packages/Cropper/CropperCorner.tsx")},[]),(0,w.jsxs)("g",{"data-test-id":`cropper-corner-${e}`,style:{cursor:eu[e],pointerEvents:"auto"},transform:((e,t,a,n)=>{if("rounded"!==n)return`translate(${t}, ${a}), rotate(${eo[e]})`;{let[n,i]=ed[e];return`translate(${t+n}, ${a+i}), rotate(${eo[e]})`}})(e,t,a,i),children:[(0,w.jsx)("rect",{className:`cropperHandle ${e}`,fill:"rgba(0,0,0,0)",height:n,stroke:"none",width:n,x:0,y:0}),"rounded"===i?(0,w.jsx)("path",{className:`cropperHandle ${e}`,d:"M16 0H24V8H16C11.5817 8 8 11.5817 8 16V24H0V16C0 7.16343 7.16345 0 16 0Z",fill:"#fff"}):(0,w.jsx)("path",{className:`cropperHandle ${e}`,d:`M ${n} 0 L 0 0 L 0 ${n}`,fill:"none",stroke:"#fff",strokeWidth:6})]})}let ep={n:"ns-resize",s:"ns-resize",e:"ew-resize",w:"ew-resize"};function eg({edge:e,x:t,y:a,w:n,h:i}){return(0,p.useEffect)(()=>{(0,c.Z)("CropperEdge","/app/packages/Cropper/CropperEdge.tsx")},[]),(0,w.jsx)("rect",{className:`cropperHandle ${e}`,fill:"rgba(0,0,0,0)",height:i,stroke:"none",style:{cursor:ep[e],pointerEvents:"auto"},width:n,x:t,y:a})}function eh({x:e,y:t,w:a,h:n}){(0,p.useEffect)(()=>{(0,c.Z)("CropperHandles","/app/packages/Cropper/CropperHandles.tsx")},[]);let i="rounded";return(0,w.jsxs)(p.Fragment,{children:[(0,w.jsx)(ec,{corner:"nw",cornerStyle:i,size:20,x:e,y:t}),(0,w.jsx)(ec,{corner:"ne",cornerStyle:i,size:20,x:e+a,y:t}),(0,w.jsx)(ec,{corner:"sw",cornerStyle:i,size:20,x:e,y:t+n}),(0,w.jsx)(ec,{corner:"se",cornerStyle:i,size:20,x:e+a,y:t+n}),(0,w.jsx)(eg,{edge:"n",h:30,w:Math.max(a-40,0),x:e+20,y:t-10}),(0,w.jsx)(eg,{edge:"e",h:Math.max(n-40,0),w:30,x:e+a-20,y:t+20}),(0,w.jsx)(eg,{edge:"s",h:30,w:Math.max(a-40,0),x:e+20,y:t+n-10}),(0,w.jsx)(eg,{edge:"w",h:Math.max(n-40,0),w:30,x:e-20,y:t+20})]})}var em=a(325574),ey=a(480706),ef=a(59111),ex=a(893957),e_=a(979173);function ev(e){(0,p.useEffect)(()=>{(0,c.Z)("Cropper","/app/packages/Cropper/Cropper.tsx")},[]);let{children:t,cropArea:a,imageSize:n,objectDetection:i,onChange:l,previewCropArea:r,showPreviewArea:s,viewParameter:o,viewType:d}=e,u=(0,U.Z)(),h=(0,p.useRef)(null),m=(0,p.useRef)(null),[y,f]=(0,p.useState)(0),[x,_]=(0,p.useState)(0),[v,S]=(0,p.useState)(0),[b,k]=(0,p.useState)(0),[P,F]=(0,p.useState)((0,em.Z)({cropArea:a,imageSize:n})),[C,j]=(0,p.useState)(null),[I,R]=(0,p.useState)(null),[T,Z]=(0,p.useState)(!1),[E,M]=(0,p.useState)(!1),D=e=>{e.preventDefault(),e.stopPropagation();let{clientX:t,clientY:a}=e,n=t-y,i=a-x;M(!1),S(n),k(i);let l=e.target,r=l.classList.contains("cropperHandle"),s="shadowMask"===l.id,o="cropSection"===l.id,d=l.id===ey.P,u=l.id===e_.I;r?(j("resize"),l.classList.contains("ne")?R("ne"):l.classList.contains("nw")?R("nw"):l.classList.contains("se")?R("se"):l.classList.contains("sw")?R("sw"):l.classList.contains("n")?R("n"):l.classList.contains("s")?R("s"):l.classList.contains("e")?R("e"):l.classList.contains("w")&&R("w")):s?(j("select"),F(er.OI)):o?j("move"):(P.x<n&&n<P.x+P.w&&P.y<i&&i<P.y+P.h?j("move"):(j("select"),F(er.OI)),Z(d||u))},L=e=>{if(!C)return;Z(!1);let{clientX:t,clientY:a}=e,i=t-y,l=a-x;if("resize"===C){let e=Math.max(Math.min(i,(n.width??1)-er.SP),er.SP),t=Math.max(Math.min(l,(n.height??1)-er.SP),er.SP),{x:a,y:r,w:s,h:o}=P;switch(I){case"ne":e<a&&t>r+o?R("sw"):e<a?R("nw"):t>r+o&&R("se");break;case"nw":e>a+s&&t>r+o?R("se"):e>a+s?R("ne"):t>r+o&&R("sw");break;case"se":e<a&&t<r?R("nw"):e<a?R("sw"):t<r&&R("ne");break;case"sw":e>a+s&&t<r?R("ne"):e>a+s?R("se"):t<r&&R("nw");break;case"n":t>r+o&&R("s");break;case"s":t<r&&R("n");break;case"e":e<a&&R("w");break;case"w":e>a+s&&R("e")}switch(I){case"ne":F(({x:a,y:n,h:i})=>{let l=Math.max(e-a,er.xZ),r=Math.max(i+(n-t),er.xZ);return{x:a,y:r<=er.xZ?n:t,w:l,h:r}});break;case"nw":F(({x:a,y:n,w:i,h:l})=>{let r=Math.max(i+(a-e),er.xZ),s=Math.max(l+(n-t),er.xZ);return{x:r===er.xZ?a:e,y:s===er.xZ?n:t,w:r,h:s}});break;case"se":F(({x:a,y:n})=>{let i=Math.max(e-a,er.xZ),l=Math.max(t-n,er.xZ);return{x:a,y:n,w:i,h:l}});break;case"sw":F(({x:a,y:n,w:i})=>{let l=Math.max(i+(a-e),er.xZ),r=Math.max(t-n,er.xZ);return{x:l===er.xZ?a:e,y:n,w:l,h:r}});break;case"n":F(({x:e,y:a,w:n,h:i})=>{let l=Math.max(a-t+i,er.xZ);return{x:e,y:l===er.xZ?a:t,w:n,h:l}});break;case"s":F(({x:e,y:a,w:n})=>{let i=Math.max(t-a,er.xZ);return{x:e,y:a,w:n,h:i}});break;case"e":F(({x:t,y:a,h:n})=>{let i=Math.max(e-t,er.xZ);return{x:t,y:a,w:i,h:n}});break;case"w":F(({x:t,y:a,w:n,h:i})=>{let l=Math.max(n-e+t,er.xZ);return{x:l===er.xZ?t:e,y:a,w:l,h:i}})}}else if("move"===C){let e=i-v,t=l-b,a=Math.max(Math.min(P.x+e,(n.width??1)-P.w-er.SP),er.SP),r=Math.max(Math.min(P.y+t,(n.height??1)-P.h-er.SP),er.SP);S(i),k(l),F(({w:e,h:t})=>({x:a,y:r,w:e,h:t}))}else if("select"===C){let e=Math.max(Math.min(i,n.width??1),0),t=Math.max(Math.min(l,n.height??1),0);F({x:Math.min(v,e),y:Math.min(b,t),w:Math.abs(e-v),h:Math.abs(t-b)})}},K=()=>{if(j(null),R(null),Z(!1),C){if(T&&"dots"===i)return void M(!0);if(0===P.w&&0===P.h)l({cropArea:{x:er.SP,y:er.SP,w:(n.width??1)-2*er.SP,h:(n.height??1)-2*er.SP},cropSource:5}),u({event_type:16586,view_type:d,view_parameter:o});else{let e,t,a=Math.max(Math.min(P.x,(n.width??1)-er.xZ-er.SP),er.SP),i=Math.max(Math.min(P.y,(n.height??1)-er.xZ-er.SP),er.SP);e=P.h<er.xZ?er.xZ:i+P.h>(n.height??1)-er.SP?(n.height??1)-i-er.SP:P.h,t=P.w<er.xZ?er.xZ:a+P.w>(n.width??1)-er.SP?(n.width??1)-a-er.SP:P.w,"move"===C?u({event_type:7603,view_type:d,view_parameter:o}):"resize"===C?u({event_type:7604,view_type:d,view_parameter:o}):"select"===C&&u({event_type:16584,view_type:d,view_parameter:o}),l({cropArea:{x:a,y:i,w:t,h:e},cropSource:6})}}};return(0,ex.Z)(()=>{if(m.current){let{x:e,y:t}=m.current.getBoundingClientRect();f(e),_(t)}}),(0,p.useEffect)(()=>{E&&F(a??er.OI)},[a,E]),(0,p.useEffect)(()=>{let e=m.current;return e&&(e.addEventListener("mousedown",D),window.addEventListener("mousemove",L),window.addEventListener("mouseup",K)),()=>{e&&(e.removeEventListener("mousedown",D),window.removeEventListener("mousemove",L),window.removeEventListener("mouseup",K))}}),(0,w.jsxs)(g.xu,{ref:m,dangerouslySetInlineStyle:{__style:{cursor:"crosshair"}},"data-test-id":"visual-search-cropper",height:"100%",left:!0,position:"absolute",top:!0,width:"100%",children:[(0,w.jsx)(ef.Z,{unsafeCSS:er.iC}),(0,w.jsxs)("svg",{"data-gestalt-valid-html":"Box",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:[(0,w.jsx)("defs",{children:(0,w.jsxs)("mask",{id:"Mask",children:[(0,w.jsx)("rect",{fill:"white",height:n.height??"100%",rx:"0",ry:"0",width:n.width??"100%",x:"0",y:"0"}),(0,w.jsx)("rect",{height:P.h,id:"hole",rx:0,ry:0,width:P.w,x:P.x,y:P.y},`${P.x}${P.y}`),(0,w.jsx)(es.Z,{classNames:"preview-crop-area",in:s&&!C,mountOnEnter:!0,nodeRef:h,timeout:300,unmountOnExit:!0,children:(0,w.jsx)(g.xu,{ref:h,children:(0,w.jsx)("rect",{height:r.h,id:"preview",rx:4,ry:4,width:r.w,x:r.x,y:r.y},`${r.x}${r.y}`)})})]})}),(0,w.jsx)("rect",{fill:"rgba(0,0,0,0.5)",height:"100%",id:"shadowMask",mask:"url(#Mask)",width:"100%",x:"0",y:"0"}),(0,w.jsx)("use",{className:"v2cropSection","data-test-id":"cropper-section",fill:"rgba(0,0,0,0)",href:"#hole",id:"cropSection",stroke:"white",strokeWidth:"2",style:{cursor:"move"}})]}),t,(0,w.jsx)("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},children:"select"!==C&&(0,w.jsx)(eh,{h:P.h,w:P.w,x:P.x,y:P.y})})]})}function eS({showAnimation:e,auxData:t,index:a,isStela:n,onClick:i,onHover:l,onUnhover:r,spotlightCenter:s,viewParameter:o,viewType:d}){(0,p.useEffect)(()=>{(0,c.Z)("FlashlightSpotlightDot","/app/packages/Flashlight/FlashlightSpotlightDot.tsx")},[]);let u=(0,U.Z)(),g=n?1221:1260;(0,ex.Z)(()=>{u({event_type:120,element:g,aux_data:t,view_parameter:o,view_type:d})});let h=parseFloat((.1*(a+1)).toFixed(2)),m={animation:e?`spotlightDotPop 0.6s ease-out ${h}s both`:"none"};return(0,w.jsx)(ey.Z,{onClick:()=>{u({aux_data:t,element:g,event_type:101,view_parameter:o,view_type:d}),i(a)},onMouseEnter:({event:e})=>{e&&(e.stopPropagation(),e.preventDefault()),l?.(a)},onMouseLeave:({event:e})=>{e&&(e.stopPropagation(),e.preventDefault()),r?.()},style:m,x:s.x,y:s.y})}var ew=a(575647),eb=a(383903);let ek=`
@keyframes spotlightDotPop {
  0% {
    transform: scale(0);
  }

  100% {
    transform: scale(1);
  }
}`,eP=(void 0!==r||(r=a(85729)).hash&&"3a8409077905af94eb39568e4a5a57fc"!==r.hash&&console.error("The definition of 'FlashlightSpotlightDots_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r),eF=({showAnimation:e,pinKey:t,imageSignature:a,imageSize:n,currentSpotlightIdx:i,handleSpotlightClick:l,handleSpotlightHover:r,handleSpotlightUnhover:s,viewParameter:o,viewType:d,visualObjects:u})=>{(0,p.useEffect)(()=>{(0,c.Z)("FlashlightSpotlightDots","/app/packages/Flashlight/FlashlightSpotlightDots.tsx")},[]);let g=(0,h.Z)(eP,t),m=(0,ew.Z)(g),y=g?(g.visualObjects??[]).filter(e=>e.isStela):u??[];return(0,w.jsxs)(p.Fragment,{children:[(0,w.jsx)(ef.Z,{unsafeCSS:ek}),y.map((t,u)=>{if(u===i)return null;let{x:c,y:p,w:h,h:y}=t,f=(0,eb.Z)({cropArea:{x:c,y:p,w:h,h:y},scaledWidth:n.width??0,scaledHeight:n.height??0}),x={x:f.x+f.w/2,y:f.y+f.h/2},_={...m({override:{entrypoint:"flashlight"}}),pin_id:g?.entityId??"",image_signature:a,visual_objects:JSON.stringify([{x:t.x,y:t.y,w:t.w,h:t.h}])},v=`${x.x}${x.y}`;return(0,w.jsx)(eS,{auxData:_,index:u,isStela:!!t?.isStela,onClick:l,onHover:r,onUnhover:s,showAnimation:e,spotlightCenter:x,viewParameter:o,viewType:d},v)})]})};var eC=a(128608),ej=a(246427),eI=a(958306);let eR=(void 0!==s||(s=a(60899)).hash&&"939d46d8644385a7918ed8179ce77a4c"!==s.hash&&console.error("The definition of 'UnauthCropperContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);function eT({cropArea:e,customCropper:t,imageSignature:a,imageSize:n,pinKey:i,showAnimation:l,trafficSource:r,viewParameter:s,viewType:o}){(0,p.useEffect)(()=>{(0,c.Z)("UnauthCropperContainer","/app/packages/Flashlight/UnauthCropperContainer.tsx")},[]);let d=(0,h.Z)(eR,i),[u,g]=(0,p.useState)("none"),[m,y]=(0,p.useState)(!1),[f,x]=(0,p.useState)({x:0,y:0,w:0,h:0}),[_,v]=(0,p.useState)({isCropAreaOnDotArea:!1,indexToHide:-1}),{indexToHide:S}=_,b=(0,p.useMemo)(()=>(d.visualObjects??[]).filter(e=>e.isStela).map(eI.Z),[d.visualObjects]);return(0,p.useEffect)(()=>{let t=b&&!!b.length,a=(0,ej.Z)({cropArea:e,scaledHeight:n.height??0,scaledWidth:n.width??0});t&&(g("dots"),v((0,eC.Z)(b,a)))},[e,n.height,n.width,b]),(0,w.jsx)(ev,{cropArea:e,imageSize:n,objectDetection:u,onChange:t,previewCropArea:f,showPreviewArea:!1,viewParameter:s,viewType:o,children:"dots"===u&&(0,w.jsx)(eF,{currentSpotlightIdx:S,handleSpotlightClick:e=>{let{x:a,y:i,w:l,h:s,title:o}=b[e];t({cropArea:(0,eb.Z)({cropArea:{x:a,y:i,w:l,h:s},scaledHeight:n.height??0,scaledWidth:n.width??0}),cropSource:4,trafficSource:r,title:o||""})},handleSpotlightHover:e=>{if(e===S)return;let{x:t,y:a,w:i,h:l}=b[e];x((0,eb.Z)({cropArea:{x:t,y:a,w:i,h:l},scaledWidth:n.width??0,scaledHeight:n.height??0})),y(!0)},handleSpotlightUnhover:()=>{y(!1)},imageSignature:a,imageSize:n,pinKey:d,showAnimation:l,viewParameter:s,viewType:o})},JSON.stringify(e))}var eZ=a(173874),eE=a(382964),eM=a(112658),eD=a(736328),eL=a(116980),eK=a(575820),eA=a(371266),e$=a(619784),ez=a(285676),eB=a(254889),eO=a(838855),eN=a(520803);let eU=0,eW="",eV=(void 0!==o||(o=a(136209)).hash&&"93612431e09eadc717c32d98e8d91e06"!==o.hash&&console.error("The definition of 'UnauthDesktopFlashlightPage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o);function eH(e){let{imageSpec_564x:t,imageSpec_orig:a,imageSignature:n}=e,i=t&&a,{url:l}=i??{},r=i?.width??1,s=i?.height??void 0;return"number"==typeof r&&"number"==typeof s&&r>564&&(s*=564/r,r=564),{width:r,height:s,url:l,imageSignature:n}}let eG=({data:e,index:t,viewParameter:a,productsURL:n})=>{switch(e.type){case"pin":return(0,w.jsx)(ez.Z,{duploQueryRef:null,pinId:e.id,slotIndex:t,viewParameter:a,viewType:72});case"story":return n&&(0,w.jsx)(E,{dangerouslySetActionUrl:n,slotIndex:t,story:e});default:return null}},eY=({resourceOptions:e})=>{let t=(0,y.Z)(),{data:a,isAtEnd:n,isFetching:i,fetchMore:l}=(0,f.Z)({name:"VisualLiveSearchResource",options:e}),r=(0,_.TH)(),s=`${r.pathname}products/${r.search}`;return(0,w.jsxs)(p.Fragment,{children:[a&&(0,w.jsx)(eO.Z,{customLayoutType:"desktopFlashlight",feedItems:a.results||[],feedKey:"flashlight-dweb-unauth",pagination:{loadNext:l,hasNext:n,isLoadingNext:i,refetch:()=>void 0},renderFeedItem:(e,t)=>eG({data:e,index:t,viewParameter:3050,productsURL:s})}),(0,w.jsx)(g.xH,{accessibilityLabel:t._('Loading visual search results...', 'unauthDesktopVisualSearch.flashlightFeed.loading', 'Accessibility label for loading visual search results'),show:i})]})},eX=({resourceOptions:e})=>{let t=(0,y.Z)(),{data:a,isAtEnd:n,isFetching:i,fetchMore:l}=(0,f.Z)({name:"VisualLiveSearchProductFeedResource",options:e});return(0,w.jsxs)(p.Fragment,{children:[a&&(0,w.jsx)(eO.Z,{customLayoutType:"desktopFlashlight",feedItems:a||[],feedKey:"flashlight-products-dweb-unauth",pagination:{loadNext:l,hasNext:n,isLoadingNext:i,refetch:()=>void 0},renderFeedItem:(e,t)=>eG({data:e,index:t,viewParameter:3334})}),(0,w.jsx)(g.xH,{accessibilityLabel:t._('Loading visual search product results...', 'unauthDesktopVisualSearch.flashlightProductFeed.loading', 'Accessibility label for loading visual search product results'),show:i})]})};function eq({pinKey:e}){(0,p.useEffect)(()=>{(0,c.Z)("UnauthDesktopFlashlightPage","/app/www/VisualSearch/UnauthDesktopFlashlightPage.tsx")},[]);let t=(0,y.Z)(),{isRTL:a}=(0,en.B)(),n=(0,U.Z)(),i=(0,_.s0)(),l=(0,_.TH)(),r=(0,p.useRef)(null),s=(0,eN.Z)(),o=(0,eD.Z)(),{pinId:d}=(0,x.Z)(s.params.id||""),u=(0,eK.mB)(l.search),m=(0,S.Z)(l),f=function(e){let t=parseInt(e??"",10);switch(t){case 1:case 2:case 3:case 4:case 5:case 6:return t;default:return}}(u.cropSource),b=(0,eZ.isFlashlightProductsPage)(l),k=(0,h.Z)(eV,e),{getNormalizedPinImage:P}=(0,eE.Z)({pinKey:k});if((0,p.useEffect)(()=>{if(!m&&k){let{width:e,height:t}=P();i((0,e$.Z)({cropArea:{h:t-2*er.SP,w:e-2*er.SP,x:er.SP,y:er.SP},isProductPage:b,pinId:d,surfaceType:"flashlight"}),{replace:!0})}},[P,i,m,b,k,d]),(0,ex.Z)(()=>{n({event_type:13,view_type:72,view_parameter:3050,view_data:{pin_id:d}})}),(0,p.useEffect)(()=>{let e=r.current;return e&&eW===d&&(e.scrollTop=eU),()=>{e&&(eU=e.scrollTop,eW=d)}}),!k)return(0,w.jsx)(eM.Z,{objectId:"",view:72,children:(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:{__style:{top:eL.Pw}},position:"relative",children:(0,w.jsx)(g.xH,{accessibilityLabel:t._('Loading Pin data', 'unauthDesktopFlashlightPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0})})});let{imageSignature:F,description:C}=k,{width:j,height:I,url:R}=eH(k),T=function({initialCropArea:e,pin:t}){let a;if(e)a={...e};else{let{visualObjects:e}=t,{width:n=1,height:i=1}=eH(t);if(e&&e.length){let{x:t,y:l,w:r,h:s}=e[0];a=(0,eb.Z)({cropArea:{x:t,y:l,w:r,h:s},scaledWidth:n,scaledHeight:i})}else{let[e,t]=[n/6,i/6],[l,r]=[n-2*e,i-2*t];a={x:e,y:t,w:l,h:r}}}return{x:Math.floor(a.x??0),y:Math.floor(a.y??0),w:Math.floor(a.w??0),h:Math.floor(a.h??0)}}({initialCropArea:m,pin:k}),Z=l.state&&l.state.internalNavigation,E=j+v.n,M=(E??1)+24,D={pin_id:d,imageSignature:F,crop:(0,ej.Z)({cropArea:T,scaledWidth:j,scaledHeight:I}),crop_source:f||5},L={__style:{top:140}};return(0,w.jsx)(eM.Z,{objectId:"",view:72,children:(0,w.jsxs)(p.Fragment,{children:[(0,w.jsxs)(g.xu,{alignItems:"center",color:"default",dangerouslySetInlineStyle:{__style:{top:80}},display:"flex",height:60,position:"fixed",width:"100%",zIndex:new g.Ry(4),children:[!a&&(0,w.jsx)(g.xu,{left:!0,position:"absolute",children:(0,w.jsx)(eB.default,{})}),(0,w.jsx)(g.xu,{flex:"grow",children:(0,w.jsx)(g.qd,{align:"center",size:"400",children:b?t._('Shop similar items', 'unauthDesktopFlashlightPage.flashlightProductsFeed.header', 'Header explaining results of flashlight products search'):t._('Visually similar results', 'unauthDesktopFlashlightPage.flashlightFeed.header', 'Header explaining results of flashlight search')})}),a&&(0,w.jsx)(g.xu,{position:"absolute",right:!0,children:(0,w.jsx)(eB.default,{icon:"directional-arrow-left"})})]}),b?(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:L,position:"relative",children:(0,w.jsx)(eX,{resourceOptions:D})}):(0,w.jsxs)(g.xu,{display:"flex",paddingX:12,children:[(0,w.jsxs)(g.xu,{ref:r,dangerouslySetInlineStyle:L,height:"calc(100% - 140px)",marginEnd:3,marginStart:3,overflow:"auto",position:"fixed",width:E,zIndex:new g.Ry(4),children:[(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:{__style:{width:j,height:I}},"data-test-id":"flashlight-enabled-image",children:(0,w.jsxs)(g.zd,{height:I,rounding:2,width:j,children:[R&&(0,w.jsx)(g.Ee,{alt:C??"",naturalHeight:I??1,naturalWidth:j??1,src:R}),(0,w.jsx)(eT,{cropArea:T,customCropper:function({cropArea:e,cropSource:t}){let a=window.location.pathname+window.location.search,n=(0,e$.Z)({cropArea:e,cropSource:t??6,isProductPage:b,pinId:d,surfaceType:"flashlight"});o({action:"trigger",item:"cropper-changed",within:"flashlight-page"}),n!==a&&d&&i({pathname:`/pin/${d}/visual-search/`,search:(0,eA.Z)({cropArea:e,cropSource:t??6,surfaceType:"flashlight"})},{state:{internalNavigation:!0}})},imageSignature:F??void 0,imageSize:{height:I,width:j},pinKey:k,showAnimation:!Z,surfaceType:"flashlight",viewParameter:3050,viewType:72})]})}),(0,w.jsx)(g.xu,{"data-test-id":"closeupDescription",direction:"column",display:"flex",margin:5,maxWidth:j??1,position:"relative",children:(0,w.jsx)(el,{pageType:{isAuth:!1,page:"flashlight"},pinKey:k,viewportSize:"narrow"})})]}),(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:{__style:{...L.__style,...a?{marginRight:`${M}px`}:{marginLeft:`${M}px`}}},position:"relative",width:"100%",children:(0,w.jsx)(eY,{resourceOptions:D})})]})]})})}let eQ=(void 0!==d||(d=a(887492)).hash&&"01839fc3bcd9cdaf206873364167d157"!==d.hash&&console.error("The definition of 'UnauthDesktopFlashlightPageFetchData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),d),eJ=(void 0!==u||(u=a(854734)).hash&&"76ab21d7bfe8df8a1418aea805bb41fa"!==u.hash&&console.error("The definition of 'UnauthDesktopFlashlightPageFetchDataPinQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),u);function e0(){let e=(0,eN.Z)(),{pinId:t}=(0,x.Z)(e.params.id||""),a=(0,m.Z)({strategy:"Legacy",query:eJ,variables:{pinId:t},useGetLegacyData:({pinId:e})=>(0,f.Z)({name:"PinResource",options:{id:e,field_set_key:"detailed",fetch_visual_search_objects:!0}}).data}),n=a?.v3GetPinQuery?.__typename==="V3GetPin"?a.v3GetPinQuery.data:null,i=(0,h.Z)(eQ,n);return(0,w.jsx)(eq,{pinKey:i})}function e1(){(0,p.useEffect)(()=>{(0,c.Z)("UnauthDesktopFlashlightPageFetchData","/app/www/VisualSearch/UnauthDesktopFlashlightPageFetchData.tsx")},[]);let e=(0,y.Z)();return(0,w.jsx)(p.Suspense,{fallback:(0,w.jsx)(g.xH,{accessibilityLabel:e._('Loading Pin data', 'unauthDesktopFlashlightPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0}),children:(0,w.jsx)(e0,{})})}},854929:function(e,t,a){a.d(t,{Z:()=>h});var n=a(686659),i=a(667294),l=a(312048),r=a(740097),s=a(230201),o=a(400962),d=a(24246),u=a(854897),c=a(902123),p=a(520803),g=a(785893);function h({defaultPillColor:e,hoveredPillColor:t,isLens:a,pressedPillColor:h,viewParameter:m,viewType:y}){(0,i.useEffect)(()=>{(0,n.Z)("VisualSearchCancelButton","/app/www/VisualSearch/VisualSearchCancelButton.tsx")},[]);let f=(0,d.Z)(),x=(0,l.s0)(),_=(0,p.Z)(),{active:v,focused:S,hovered:w,onBlur:b,onFocus:k,onMouseDown:P,onMouseEnter:F,onMouseLeave:C,onMouseUp:j}=(0,c.Z)(),{pinId:I}=(0,u.Z)(_.params.id||""),{previous:R}=(0,o.ou)(),{logContextEvent:T}=(0,s.u)();return(0,g.jsx)(r.xu,{"data-test-id":"go-back-button",children:(0,g.jsx)(r.iP,{onBlur:b,onFocus:k,onMouseDown:P,onMouseEnter:F,onMouseLeave:C,onMouseUp:j,onTap:()=>(T({event_type:101,view_type:y,element:34,view_parameter:m}),a)?void x("/",{replace:!0}):0===R.length?void x(I?`/pin/${I}/`:"/",{replace:!0}):void x(-1),tapStyle:"compress",children:(0,g.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{background:v?h:S||w?t:e,backdropFilter:"blur(80px)"}},padding:3,rounding:4,children:(0,g.jsx)(r.JO,{accessibilityLabel:f._('Go back', 'imageSearch.cancelButton', 'Cancel button for going back to the Pin page'),color:"default",icon:"cancel",size:24})})})})}},67854:function(e,t,a){a.d(t,{$V:()=>i,M:()=>n,Qs:()=>o,nn:()=>l,qN:()=>s,tX:()=>r});let n=520,i=6,l=16,r=4,s=2,o=6},911953:function(e,t,a){a.d(t,{Z:()=>l});var n=a(667294),i=a(730448);function l({scrollContainerRef:e}){let t=(0,n.useCallback)(t=>{let a=e.current,{buttons:n,clientY:i}=t;if(!a||1!==n||!i)return;let{top:l,bottom:r}=a.getBoundingClientRect(),s=window.innerHeight-l,o=a.scrollHeight,d=Math.max(0,l+20-i),u=Math.max(0,i-(r-20));if(d>0){let e=Math.min(d,100);a.scrollTop-=e}else if(u>0&&!(o<=s)){let e=Math.min(u,100);a.scrollTop+=e}},[e]);return{scrollCropperInView:(0,n.useMemo)(()=>(0,i.Z)(t,16),[t])}}},603284:function(e,t,a){a.d(t,{Z:()=>u});var n=a(686659),i=a(667294),l=a(746868),r=a(360033),s=a(495773),o=a(785893);class d extends i.Component{componentDidMount(){let{setCurrentPageData:e,viewData:t,viewParameter:a,viewType:n}=this.props;e({viewData:t,viewParameter:a,viewType:n})}componentDidUpdate(e){let{setCurrentPageData:t,viewData:a,viewParameter:n,viewType:i}=this.props;n===e.viewParameter&&i===e.viewType&&(0,r.ZP)(a,e.viewData)||t({viewData:a,viewParameter:n,viewType:i})}componentWillUnmount(){this.props.clearCurrentPageData()}render(){let{auxData:e,children:t,component:a,objectIdStr:n,viewData:i,viewParameter:l,viewType:r,clientTrackingParams:d}=this.props;return(0,o.jsx)(s.Z,{auxData:e,clientTrackingParams:d,component:a,objectIdStr:n,viewData:i,viewParameter:l,viewType:r,children:t})}}function u(e){(0,i.useEffect)(()=>{(0,n.Z)("PageView","/app/www/analytics/PageView.tsx")},[]);let{setViewContextData:t,clearViewContextData:a}=(0,l.A$)();return(0,o.jsx)(d,{...e,clearCurrentPageData:a,setCurrentPageData:t})}},495773:function(e,t,a){a.d(t,{Z:()=>r});var n=a(667294),i=a(104999),l=a(935833);function r(e){let{auxData:t,clientTrackingParams:a,children:r,component:s,element:o,objectIdStr:d,viewData:u,viewParameter:c,viewType:p}=e,g=(0,i.Z)(),h=JSON.stringify(t),m=JSON.stringify(u);return(0,n.useEffect)(()=>{(({viewType:e,viewParameter:t,viewData:a,auxData:n,objectIdStr:i,component:r,clientTrackingParams:s,element:o},d)=>{let u,c=Object.keys(u={event_type:13,view_type:e,view_parameter:t,view_data:a,aux_data:n,object_id_str:i,component:r,clientTrackingParams:s,element:o}).reduce((e,t)=>(void 0===u[t]&&delete e[t],e),{...u});-1===Object.keys(c).indexOf("view_type")&&(0,l.My)("mweb.logging.null_view_type"),d(c)})(e,g)},[g,h,a,s,o,d,m,c,p]),n.Children.only(r)}},596663:function(e,t,a){a.d(t,{G9:()=>r,SY:()=>o,kk:()=>l,mb:()=>d,s:()=>s});var n=a(806513),i=a(684570);let l=({isDesktop:e})=>{let t=(0,i.Z)({isDesktop:e});return t?-t:0},r=-2,s=({trafficSource:e,deviceType:t,experimentalGutter:a})=>{let i=a??4*n.jC;return"desktop"===t?i:"board"===e?4:void 0},o=({deviceType:e,customMWebColumnWidth:t,experimentalColumnWidth:a})=>{let i=a??n.yF;return"desktop"===e?i:t||200},d=({gutterWidth:e,itemWidth:t,className:a,minColumns:i=n.yc,maxColumns:l=n.g5})=>{let r=t+e;return Array.from({length:l+1-i},(e,t)=>t+i).map(t=>({minWidth:t===i?0:t*r,maxWidth:t===l?null:(t+1)*r-1,styles:`
      .${a} {
        max-width: ${t*r-e}px;
      }
      `})).map(({minWidth:e,maxWidth:t,styles:a})=>`
    @media (min-width: ${e}px) ${t?`and (max-width: ${t}px)`:""} {
      ${a}
    }
  `).join("")}},759302:function(e,t,a){a.d(t,{Z:()=>m});var n=a(686659),i=a(667294),l=a(740097),r=a(806513),s=a(59111),o=a(739405),d=a(838751),u=a(785893);let c="PinGridSkeletonLoader__tall",p="PinGridSkeletonLoader__short",g=({size:e})=>(0,u.jsx)(l.xu,{padding:1,children:(0,u.jsx)("div",{className:"tall"===e?c:p})}),h=({children:e})=>(0,u.jsx)(l.kC,{direction:"column",gap:{row:0,column:2},children:e}),m=({partialViewportWidth:e})=>{(0,i.useEffect)(()=>{(0,n.Z)("PinGridSkeletonLoader","/app/www/loader/PinGridSkeletonLoader.tsx")},[]);let t="desktop"===(0,o.ZP)(),a=t?r.yF:r.tG;return(0,u.jsxs)(i.Fragment,{children:[(0,u.jsx)(s.Z,{unsafeCSS:[{name:c,height:250},{name:p,height:150}].map(({name:e,height:t})=>(0,d.Z)({name:e,width:a,height:t})).join("")}),(0,u.jsx)(l.xu,{"data-test-id":"pin-grid-skeleton-loader",marginEnd:r.qG,marginStart:r.qG,children:t?(0,u.jsxs)(l.kC,{direction:"row",gap:{row:r.jC,column:0},children:[(0,u.jsx)(h,{children:(0,u.jsx)(g,{size:"tall"})}),(0,u.jsx)(h,{children:(0,u.jsx)(g,{size:"short"})}),(0,u.jsx)(h,{children:(0,u.jsx)(g,{size:"tall"})}),!e&&(0,u.jsx)(h,{children:(0,u.jsx)(g,{size:"short"})})]}):(0,u.jsxs)(l.kC,{direction:"row",justifyContent:"center",overflow:"hidden",children:[(0,u.jsxs)(h,{children:[(0,u.jsx)(g,{size:"tall"}),(0,u.jsx)(g,{size:"short"}),(0,u.jsx)(g,{size:"tall"})]}),(0,u.jsxs)(h,{children:[(0,u.jsx)(g,{size:"short"}),(0,u.jsx)(g,{size:"tall"}),(0,u.jsx)(g,{size:"short"}),(0,u.jsx)(g,{size:"tall"})]})]})})]})}},838751:function(e,t,a){a.d(t,{Z:()=>n});let n=({name:e,width:t,height:a})=>{let n=`${t}${"number"==typeof t?"px":""}`,i=`${a}${"number"==typeof a?"px":""}`,l="number"==typeof t?t:236;return`
.${e} {
  -webkit-animation-duration: 1s;
  -webkit-animation-fill-mode: forwards;
  -webkit-animation-iteration-count: infinite;
  -webkit-animation-name: ${e}_placeHolderShimmer;
  -webkit-animation-timing-function: linear;
  border-radius: 16px;
  background: #f6f7f9;
  background-image: linear-gradient(to right, #f6f7f9 0%, #e9ebee 20%, #f6f7f9 40%, #f6f7f9 100%);
  background-repeat: no-repeat;
  background-size: ${l} ${i};
  width: ${n};
  height: ${i};
}

@keyframes ${e}_placeHolderShimmer{
  0% {
      background-position: -${l}px 0;
  }
  100% {
      background-position: ${l}px 0;
  }
}
`}},119497:function(e,t,a){a.d(t,{Z:()=>e3});var n,i,l,r,s,o,d,u,c,p,g,h=a(686659),m=a(667294);a(167912);var y=a(740097),f=a(470205),x=a(183e3),_=a(631155),v=a(24246),S=a(619481),w=a(890678),b=a(854897),k=a(550759),P=a(312048),F=a(480610),C=a(531996),j=a(221175),I=a(382964),R=a(575820),T=a(473156),Z=a(246427),E=a(67854),M=a(157997),D=a(226966),L=a(159831),K=a(713645),A=a(28031),$=a(230201),z=a(893957),B=a(902123),O=a(785893);function N({defaultPillColor:e,hoveredPillColor:t,pressedPillColor:a,isSelected:n,label:i,onTap:l,ref:r,selectedPillColor:s}){(0,m.useEffect)(()=>{(0,h.Z)("DescriptorPill","/app/www/Descriptors/DescriptorPill.tsx")},[]);let[o,d]=(0,m.useState)(e);return(0,m.useEffect)(()=>{d(n?s:e)},[n,s,e]),(0,O.jsx)(y.iP,{onMouseDown:()=>d(a),onMouseEnter:()=>{n||d(t)},onMouseLeave:()=>{n||d(e)},onTap:l,rounding:4,tapStyle:"compress",children:(0,O.jsx)(y.xu,{ref:r,dangerouslySetInlineStyle:{__style:{background:o,backdropFilter:"blur(80px)",userSelect:"none"}},"data-test-id":`descriptor-pill-${i}`,paddingX:4,paddingY:2,rounding:4,children:(0,O.jsx)(y.kC,{alignItems:"center",minHeight:32,children:(0,O.jsx)(y.mg,{color:n?"light":"dark",overflow:"noWrap",children:i})})})})}let U=({showBackArrow:e,showFwdArrow:t,handleClickBack:a,handleClickForward:n})=>{(0,m.useEffect)(()=>{(0,h.Z)("DescriptorsNavigation","/app/www/Descriptors/DescriptorsNavigation.tsx")},[]);let i=(0,v.Z)();return(0,O.jsxs)(y.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},"data-test-id":"descriptors-navigation-arrows",display:"flex",justifyContent:"between",left:!0,position:"absolute",right:!0,top:!0,children:[(0,O.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},marginStart:2,children:e&&(0,O.jsx)(y.hU,{accessibilityLabel:i._('Back', 'descriptor.navArrow.back', 'Accessibility label for a button that navigates back to previous search guides'),bgColor:"white",dataTestId:"descriptor-bar-back-button",icon:"arrow-back",onClick:a,size:"md"})}),(0,O.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},marginEnd:2,children:t&&(0,O.jsx)(y.hU,{accessibilityLabel:i._('Forward', 'descriptor.navArrow.forward', 'Accessibility label for a button that navigates forward to see more search guides'),bgColor:"white",dataTestId:"descriptor-bar-forward-button",icon:"arrow-forward",onClick:n,size:"md"})})]})};var W=a(774838);let V=(void 0!==n||(n=a(258138)).hash&&"9d15639e8d9dd61426917dc218fbb3a6"!==n.hash&&console.error("The definition of 'Descriptors_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function H({pressedPillColor:e,defaultPillColor:t,descriptorModules:a,hoveredPillColor:n,pinKey:i,selectedPillColor:l,isWebImageSearchRedesign:r}){(0,m.useEffect)(()=>{(0,h.Z)("Descriptors","/app/www/Descriptors/Descriptors.tsx")},[]);let[s,o]=(0,m.useState)(),[d,u]=(0,m.useState)(0),c=(0,P.s0)(),{search:p}=(0,P.TH)(),{barContainer:g,clientWidth:f,centerModules:_,offset:v,showBackArrow:S,showFwdArrow:w,handleClickForward:b,handleClickBack:k,onFocus:F,onMouseDown:C,scrollToPillByOffset:j}=(e=>{let t=(0,m.useRef)(null),{isRTL:a}=(0,W.B)(),n=(0,m.useRef)(!1),[i,l]=(0,m.useState)(0),[r,s]=(0,m.useState)(0),[o,d]=(0,m.useState)(!1),[u,c]=(0,m.useState)(!1),{current:p}=t,{clientWidth:g=0,scrollWidth:h=0}=p??{},y=g||0,f=!!p&&y>=(h||0),x=e.length;(0,m.useEffect)(()=>{let e=p?.scrollWidth||0,t=0;Array.from(p?.children||[]).slice(0,i).forEach(e=>{t+=e.offsetWidth||0}),s(t=Math.min(t,e-g+8));let a=e-t,n=y>=e;n&&0!==i&&l(0),d(i>0&&!n),c(a>y&&i<x&&!n)},[p,i,x,y,a,g]);let _=(0,m.useCallback)(e=>{if(!p)return;let t=Array.from(p.children);if(e<0||e>=t.length)return;let a=0;t.slice(0,e).forEach(e=>{a+=e?.offsetWidth??0});let n=t[e]?.offsetWidth??0;if(a<r){s(a),l(e);return}if(a+n>r+g){s(a+n-g),l(e);return}l(e)},[p,r,g]),v=(0,m.useCallback)((e,t)=>{let a=e.current;if(!a||t<0||t>=a.length)return;let n=Array.from({length:t}).reduce((e,t,n)=>e+(a[n]?.offsetWidth??0),0),i=n+(a[t]?.offsetWidth??0);if(n>=r&&i<=r+g)return;let o=n<r?n:i-g;s(Math.max(0,Math.min(o,Math.max(0,h-g+8)))),l(Array.from({length:a.length}).reduce((e,t,n)=>{let{foundIndex:i,accWidth:l}=e;if(-1!==i)return e;let r=l+(a[n]?.offsetWidth??0);return{foundIndex:l>=o?n:-1,accWidth:r}},{foundIndex:-1,accWidth:0}).foundIndex)},[r,g,h]),S=(0,m.useCallback)(e=>{if("Tab"!==e.key)return;let t=Array.from(p?.children||[]),a=document.activeElement,n=t.findIndex(e=>e.contains(a));-1!==n&&(!e.shiftKey&&n<t.length-1?_(n+1):e.shiftKey&&n>0&&_(n-1))},[p,_]);return(0,m.useEffect)(()=>{if(p)return p.addEventListener("keydown",S,!0),()=>{p.removeEventListener("keydown",S,!0)}},[p,S]),{barContainer:t,centerModules:f,clientWidth:g,offset:r,showBackArrow:o,showFwdArrow:u,onFocus:()=>{n.current||l(i)},index:i,setIndex:l,handleClickForward:()=>{i+2<x?l(i+2):l(x-2)},handleClickBack:()=>{i-2>=0?l(i-2):l(0)},onMouseDown:()=>{n.current=!0},scrollToPillByOffset:v}})(a),I=(0,x.Z)(V,i),{logContextEvent:T}=(0,$.u)(),{descriptorsRefs:Z}=((e,t,a,n,i)=>{let{logContextEvent:l}=(0,$.u)(),r=(0,m.useRef)([]),s=(0,m.useRef)([]);return(0,m.useEffect)(()=>{let o=0,d=r.current.map((n,i)=>{let l=n?.offsetWidth||0,r=o,s=o+l;o+=l+4;let{auxData:d}=a[i]||{auxData:{}},u=e+t,c=r+16>e&&r<u,p=s>e&&s-16<u;return{moduleId:d?.moduleId||"",isVisible:c||p}});d.forEach((e,t)=>{let a=s.current[t];if((!a||!1===a.isVisible)&&e.isVisible){let{auxData:e}=i||{};l({event_type:9993,view_type:72,view_parameter:3050,component:14047,aux_data:{image_signature:n||"",descriptor:e?.query}})}}),s.current=d},[r,e,t,a,l,n,i,s]),{descriptorsRefs:r}})(v,f,a,I.imageSignature||"",s);(0,z.Z)(()=>{if(void 0===s){let e=a.findIndex(e=>{let{display:t}=e,{isSelected:a}=t||{isSelected:!1};return a}),{hybrid_search_param:t}=(0,R.mB)(p);-1!==e&&t&&(o(a[e]),j(Z,e-1))}}),(0,m.useEffect)(()=>{u(r?(e=>{if(!e)return 0;let t=e.getBoundingClientRect(),a=window.innerHeight;return t.bottom>a?t.bottom-a:0})(g.current):0)},[g,r]);let E=e=>{let{id:t}=e,{id:a}=s||{};return null!=t&&a===t};return(0,O.jsx)(B.q,{children:({hovered:i,onMouseEnter:r,onMouseLeave:u})=>(0,O.jsxs)(y.xu,{dangerouslySetInlineStyle:{__style:{bottom:d}},"data-test-id":"scrollable-descriptor-bar-root",left:!0,onMouseEnter:r,onMouseLeave:u,overflow:"hidden",position:"absolute",right:!0,children:[(0,O.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{left:`-${v}px`,transition:"left 0.3s, right 0.3s"}},position:"relative",children:(0,O.jsx)(y.xu,{ref:g,display:"flex",justifyContent:_?"center":void 0,marginStart:2,paddingY:2,children:a.map((a,i)=>{let{action:r,display:s}=a,{feedUrl:d}=r||{};if(null==d)return null;let{displayText:u}=s||{};return(0,O.jsx)(y.xu,{marginEnd:1,onFocus:F,onMouseDown:C,children:(0,O.jsx)(N,{ref:e=>{Z.current[i]=e},defaultPillColor:t,hoveredPillColor:n,isSelected:E(a),label:u||"",onTap:()=>((e,t)=>{let a=E(e),{action:n}=e,{feedUrl:i}=n||{};if(i)if(a){let e=i,{surfaceType:t}=(0,R.mB)(p);t&&(e=i.replace(RegExp(`^(.*surfaceType=${t}).*$`),"$1")),c(e??"",{replace:!0}),o(void 0)}else{let{surfaceType:a}=(0,R.mB)(p),n=i;a&&(n=i.replace(/(surfaceType=)[^&]*/,`$1${a}`)),c(n??"",{replace:!0}),j(Z,t),o(e)}let{auxData:l}=e;T({event_type:102,view_type:72,view_parameter:3050,component:14047,aux_data:{image_signature:I.imageSignature||"",descriptor:l?.query}})})(a,i),pressedPillColor:e,selectedPillColor:l})},`descriptors-module-${a.id||i}`)})})}),i&&(0,O.jsx)(U,{handleClickBack:()=>{k();let{auxData:e}=s||{};T({event_type:108,view_type:72,view_parameter:3050,component:14046,aux_data:{image_signature:I.imageSignature||"",descriptor:e?.query}})},handleClickForward:()=>{b();let{auxData:e}=s||{};T({event_type:108,view_type:72,view_parameter:3050,component:14046,aux_data:{image_signature:I.imageSignature||"",descriptor:e?.query}})},showBackArrow:S,showFwdArrow:w})]})})}var G=a(229793),Y=a(23641);function X({containerRef:e}){let t=(0,m.useCallback)(()=>{(0,Y.Nx)("VisualSearchImageRender")},[]);return(0,m.useEffect)(()=>{let a=e.current;if(!a)return;let n=a.querySelector("img");n?.complete&&n.naturalWidth>0&&t()},[e,t]),{onImageLoad:t}}var q=a(854929),Q=a(938306),J=a(501010),ee=a(128608),et=a(371266),ea=a(518112),en=a(59111),ei=a(383903),el=a(674610),er=a(509307),es=a(979173);function eo({bitmapMasks:e,hoveredCutoutIndex:t,imageContainerX:n,imageContainerY:i,pinImageHovered:l,pinImageHeight:r,pinImageUrl:s,pinImageWidth:o,selectedCutoutIndex:d,setHoveredCutoutIndex:u,setSelectedCutoutIndex:c,trafficSource:p,viewParameter:g,viewType:f}){(0,m.useEffect)(()=>{(0,h.Z)("StelaCutouts","/app/www/Cutouts/StelaCutouts.tsx")},[]);let x=(0,P.TH)(),{logContextEvent:_}=(0,$.u)(),v=(0,P.s0)(),S=(0,m.useRef)(null),[w,b]=(0,m.useState)(!1),[k,F]=(0,m.useState)([]),[C,j]=(0,m.useState)(!1),[I,T]=(0,m.useState)(!1),{w:Z,h:E}=(0,R.mB)(x.search),M=(0,m.useMemo)(()=>Number(Z)===o&&Number(E)===r||void 0===Z&&void 0===E,[E,r,o,Z]),D=(0,m.useMemo)(()=>({commerce_data:JSON.stringify({pin_has_cutout:!0})}),[]);(0,m.useEffect)(()=>{if(!e)return;let t=[];async function n({id:e,isHidden:n,maskHeightRatio:i,maskImage:l,maskWidthRatio:r,maskXRatio:s,maskYRatio:o,pinImageHeight:d,pinImageWidth:u}){let{ContourTracer:c,initializeWasm:p}=await a.e("95563").then(a.bind(a,193386));await p();let g=new c,h=atob(l),m=new Blob([Uint8Array.from(h,e=>e.charCodeAt(0))],{type:"image/png"}),y=await createImageBitmap(m),f=g.trace(y,{useAlpha:!1,threshold:80}),x=URL.createObjectURL(m);return t.push(x),{contours:f,contourXRatio:u*r/y.width,contourYRatio:d*i/y.height,id:e,isHidden:n,maskHeightRatio:i,maskUrl:x,maskWidthRatio:r,maskXRatio:s,maskYRatio:o}}let i=[];return e.forEach(e=>{let{id:t,mask_image:a,mask_bounds:l,is_hidden:s}=e,[d,u]=l?.[0]??[],[c,p]=l?.[1]??[];if(void 0!==t&&void 0!==a&&void 0!==d&&void 0!==u&&void 0!==c&&void 0!==p){let e=n({id:t,isHidden:!!s,maskHeightRatio:p,maskImage:a,maskWidthRatio:c,maskXRatio:d,maskYRatio:u,pinImageHeight:r,pinImageWidth:o});i.push(e)}}),(async()=>{F(await Promise.all(i))})(),()=>{t.forEach(e=>{URL.revokeObjectURL(e)})}},[e,r,o]);let L=(0,m.useMemo)(()=>{let e=[];return k.forEach((t,a)=>{let{contours:n}=t;n&&0!==n.length&&(e[a]=n.map(e=>{let t=e.points.map(e=>e.x),a=e.points.map(e=>e.y);return{minX:Math.min(...t),minY:Math.min(...a),maxX:Math.max(...t),maxY:Math.max(...a)}}))}),e},[k]),K=(0,m.useCallback)(e=>{let a=e.clientX-n,l=e.clientY-i;for(let e=k.length-1;e>=0;e-=1){let n=k[e];if(e===d||!n)continue;let{contours:i,contourXRatio:s,contourYRatio:c,maskXRatio:p,maskYRatio:h}=n,m=(a-p*o)/s,y=(l-h*r)/c,x=L[e];if(i.some((e,t)=>{let a=x?.[t];return a&&m>=a.minX&&m<=a.maxX&&y>=a.minY&&y<=a.maxY&&(0,er.Z)({x:m,y:y},e.points)})){t!==e&&(u?.(e),_({event_type:105,element:14154,view_parameter:g,view_type:f,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}));return}}u?.(null)},[k,L,t,n,i,_,r,o,d,u,g,f]),A=()=>b(!1),z=e=>{(e.movementX||e.movementY)&&b(!0),0===e.buttons?K(e):u?.(null)},B=e=>{K(e)},N=()=>u?.(null),U=(0,m.useCallback)(()=>{if(w||null===t||!k[t])return void b(!1);c?.(t);let{maskXRatio:e,maskYRatio:a,maskWidthRatio:n,maskHeightRatio:i}=k[t],l=(0,ei.Z)({cropArea:{x:e,y:a,w:n,h:i},scaledWidth:o,scaledHeight:r}),s=(0,et.Z)({cropArea:l,cropSource:9,trafficSource:p});s!==window.location.search&&(_({event_type:101,element:14154,view_parameter:g,view_type:f,aux_data:D}),v(`${window.location.pathname}${s}`,{replace:!0}))},[D,k,w,v,t,_,r,o,c,p,g,f]);return((0,m.useEffect)(()=>{let e=S.current;return e&&(e.addEventListener("mousedown",A),e.addEventListener("mousemove",z),e.addEventListener("mouseup",B),e.addEventListener("mouseleave",N),e.addEventListener("click",U)),()=>{e&&(e.removeEventListener("mousedown",A),e.removeEventListener("mousemove",z),e.removeEventListener("mouseup",B),e.removeEventListener("mouseleave",N),e.removeEventListener("click",U))}}),e)?(0,O.jsxs)(y.xu,{ref:S,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:"number"==typeof t?"pointer":"auto"}},"data-bitmaps-ready":k.length>0,"data-test-id":"cutouts-container",left:!0,position:"absolute",right:!0,role:"none",top:!0,children:[(0,O.jsx)(en.Z,{unsafeCSS:el.iF}),k.map((e,a)=>(0,O.jsx)(es.Z,{auxData:D,bitmapData:e,hasAnimatedCutoutsOnLand:I,hasLoggedRender:C,hoveredCutoutIndex:t,index:a,isPinLevelCrop:M,pinImageHeight:r,pinImageHovered:l,pinImageUrl:s,pinImageWidth:o,selectedCutoutIndex:d,setHasAnimatedCutoutsOnLand:T,setHasLoggedRender:j,viewParameter:g,viewType:f},e.id))]}):null}var ed=a(415349),eu=a(225580);let ec=(void 0!==i||(i=a(911486)).hash&&"fbf2d3b93402a9dd783073db316c0f92"!==i.hash&&console.error("The definition of 'VisualSearchCropper_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function ep({cropArea:e,cropSource:t,imageContainerX:a=0,imageContainerY:n=0,imageSize:i,pinKey:l,trafficSource:r,viewParameter:s,viewType:o}){(0,m.useEffect)(()=>{(0,h.Z)("VisualSearchCropper","/app/www/VisualSearch/VisualSearchCropper.tsx")},[]);let{checkExperiment:d}=(0,J.Z)(),u=(0,x.Z)(ec,l),c=(0,P.s0)(),p=(0,M.D)(),{getNormalizedPinImage:g}=(0,I.Z)({pinKey:u,maxWidth:j.Wm}),y=(0,ed.Z)({pinKey:u,isVisualSearch:!0}),[f,_]=(0,m.useState)("none"),[v,S]=(0,m.useState)(null),[w,b]=(0,m.useState)(-1),{bitmap_masks:k}=y??{},F=(0,m.useMemo)(()=>(k??[]).filter(eu.R7).map(e=>{let{id:t,mask_bounds:a}=e,[n,i]=a[0],[l,r]=a[1];return{x:n,y:i,w:l,h:r,id:t}}),[k]);return(0,m.useEffect)(()=>{let t=(0,Z.Z)({cropArea:e,scaledHeight:i.height??0,scaledWidth:i.width??0});if(F&&F.length){let e=(0,ee.Z)(F,t);_("cutouts"),b(e.indexToHide)}},[e,F,i.height,i.width]),(0,O.jsx)(Q.Z,{cropArea:e,cropSource:t,hoveredCutoutIndex:v,imageContainerX:a,imageContainerY:n,imageSize:i,objectDetection:f,onChange:({cropArea:e,cropSource:t})=>{if("cutouts"===f){let a=(0,Z.Z)({cropArea:e,scaledHeight:i.height??0,scaledWidth:i.width??0}),{isCropAreaOnDotArea:n,indexToHide:l}=(0,ee.Z)(F,a);n&&(t=9,b?.(l))}let a=window.location.search,n=(0,et.Z)({cropArea:e,cropSource:t,trafficSource:r});a!==n&&c({pathname:window.location.pathname,search:n},{replace:!0})},setHoveredCutoutIndex:S,setSelectedCutoutIndex:b,viewParameter:s,viewType:o,children:(()=>{if("cutouts"!==f||!k?.length)return null;let{pinImageWidth:e,pinImageHeight:t,pinImageUrl:i}=(()=>{if(p)return{pinImageWidth:E.M,pinImageHeight:E.M/(u?.image?.width??1)*(u?.image?.height??1),pinImageUrl:u?.image?.url??""};let{height:e,width:t,url:a}=g();return{pinImageWidth:t,pinImageHeight:e,pinImageUrl:a}})(),{anyEnabled:l}=d("web_cutout_glow"),c=l?ea.default:eo;return(0,O.jsx)(c,{bitmapMasks:k,hoveredCutoutIndex:v,imageContainerX:a,imageContainerY:n,pinImageHeight:t,pinImageUrl:i,pinImageWidth:e,selectedCutoutIndex:w,setHoveredCutoutIndex:S,setSelectedCutoutIndex:b,trafficSource:r,viewParameter:s,viewType:o})})()})}let eg=(void 0!==l||(l=a(447963)).hash&&"727c8ab2c1c256e3b4478a36890f92d6"!==l.hash&&console.error("The definition of 'RelatedProductsImageContent_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function eh({cropArea:e,cropSource:t,description:a,descriptorModules:n,height:i,imageContainerX:l,imageContainerY:r,imageUrl:s,pinKey:o,trafficSource:d,viewParameter:u,viewType:c,width:p}){(0,m.useEffect)(()=>{(0,h.Z)("RelatedProductsImageContent","/app/common/react/components/shopping/RelatedProducts/RelatedProductsImageContent.tsx")},[]);let g=(0,M.D)(),f=(0,x.Z)(eg,o),{defaultColor:_,selectedColor:v,hoveredColor:S,pressedColor:w}=(0,G.Z)(f.dominantColor),{height:b=0}=(0,A.Z)()||{},k=(0,m.useRef)(null),{onImageLoad:P}=X({containerRef:k}),F=r+i,C=F>b,j=C?Math.min(F-64-12,b-64-12):i-64;return(0,O.jsxs)(y.xu,{"data-test-id":"flashlight-enabled-image",height:i,width:p,children:[(0,O.jsxs)(y.zd,{height:i,rounding:g?6:4,width:p,children:[(0,O.jsx)(K.Z,{_enableViewTransitions:!0,type:"image",children:(0,O.jsx)(y.xu,{ref:k,children:(0,O.jsx)(y.Ee,{alt:a,naturalHeight:i,naturalWidth:p,onLoad:P,src:s})})}),(0,O.jsx)(ep,{cropArea:e,cropSource:t,imageContainerX:l,imageContainerY:r,imageSize:{height:i,width:p},pinKey:f,trafficSource:d,viewParameter:u,viewType:c}),g&&(0,O.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{insetInlineStart:0}},position:"absolute",top:!0,children:(0,O.jsx)(q.Z,{defaultPillColor:_,hoveredPillColor:S,pressedPillColor:w,viewParameter:u,viewType:c})})]}),n&&n.length>0&&(0,O.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{top:j}},height:64,position:C?"fixed":"absolute",width:p,children:(0,O.jsx)(H,{defaultPillColor:_,descriptorModules:n,hoveredPillColor:S,pinKey:f,pressedPillColor:w,selectedPillColor:v})})]})}var em=a(17667),ey=a(433100),ef=a(513530),ex=a(148);function e_({itemCount:e}){let t=(0,m.useRef)(!1);(0,m.useEffect)(()=>{!t.current&&e>0&&(t.current=!0,(0,Y.Nx)("VisualSearchFeedRender"))},[e])}let ev=(void 0!==r||(r=a(895622)).hash&&"20c2c7f4ff982fb93a9608faa14f3ed2"!==r.hash&&console.error("The definition of 'RelatedProductsUnifiedFeed_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function eS({alignStart:e,auxData:t,isFilterOpened:a,isProductOnlyFeed:n,oneBarModules:i,pinKey:l,viewParameter:r,viewType:s,visualSearchFlashlightUnifiedResource:o}){(0,m.useEffect)(()=>{(0,h.Z)("RelatedProductsUnifiedFeed","/app/common/react/components/shopping/RelatedProducts/UnifiedFeed/RelatedProductsUnifiedFeed.tsx")},[]);let d=(0,x.Z)(ev,l),u=!n&&i&&i.length>0,{data:c}=o,p=c?.search_identifier;return e_({itemCount:(c?.results||[]).length}),(0,O.jsxs)(m.Fragment,{children:[u&&(0,O.jsx)(y.xu,{position:"relative",zIndex:new y.Ry(1),children:(0,O.jsx)(ex.v,{children:(0,O.jsx)(ey.f,{children:(0,O.jsx)(em.default,{oneBarModulesKey:null,oneBarModulesRest:i,paddingX:8})})})}),(0,O.jsx)(y.xu,{overflow:"hidden",children:(0,O.jsx)(ef.Z,{alignStart:e,auxData:t,isFilterOpened:a,isProductFeed:n,pinKey:d,searchId:p,viewParameter:r,viewType:s,visualSearchFlashlightUnifiedResource:o})})]})}var ew=a(933442),eb=a(59355),ek=a(806513),eP=a(112658);function eF({cropSource:e}){return{viewType:72,viewParameter:9===e?3462:3050}}var eC=a(49254),ej=a(74195);let eI=L.R+16,eR=(void 0!==s||(s=a(441370)).hash&&"3a9a747c3135f426fe0cf32ca9147a5d"!==s.hash&&console.error("The definition of 'VisualSearchContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);function eT({cropArea:e,cropSource:t,isProductPage:a,oneBarModules:n,pinKey:i,searchId:l,descriptorModules:r,title:s,trafficSource:o,visualSearchFlashlightUnifiedResource:d}){(0,m.useEffect)(()=>{(0,h.Z)("VisualSearchContainer","/app/www/VisualSearch/VisualSearchContainer.tsx")},[]);let u=(0,x.Z)(eR,i),{getNormalizedPinImage:c}=(0,I.Z)({pinKey:u,maxWidth:j.Wm}),p=(0,P.TH)(),{width:g=0}=(0,A.Z)()||{},f=(0,eC.t)(),_=(0,ej.Z)(),{imageContainerScrollTop:v,imageContainerScrollTopForPinId:S}=(0,ew._)(),w=(0,m.useRef)(null),[b,k]=(0,m.useState)(0),[F,C]=(0,m.useState)(0),{state:R}=p||{},{internalNavigation:T=!1}=R||{},{width:Z,height:E,url:M}=c(),K=Z+D.n,$=a?0:K+48,B=g-_-$-D.n,{viewType:N,viewParameter:U}=eF({cropSource:t}),W={commerce_data:JSON.stringify({is_product_only_feed:a})},V=()=>{let e=w.current;if(e){let{x:t,y:a}=e.getBoundingClientRect(),{scrollTop:n}=e;k(t),C(a-n)}};return(0,z.Z)(()=>{V(),w.current&&0!==v.current&&S.current===u.entityId&&(w.current.scrollTop=v.current)}),(0,O.jsx)(eP.Z,{objectId:l,view:N,children:(0,O.jsx)(eb.Z,{log:{aux_data:W,view_type:N,view_parameter:U},children:(0,O.jsxs)(y.xu,{"data-test-id":"related-products",children:[(0,O.jsx)(L.Z,{isProductPage:a,title:a?s:"",viewParameter:U,viewType:N}),!a&&(0,O.jsx)(y.xu,{ref:w,bottom:!0,dangerouslySetInlineStyle:{__style:{top:f+eI,left:_,right:_}},height:"inherit",marginBottom:3,marginStart:12,onScroll:()=>{V(),v.current=w.current?.scrollTop||0,S.current=u.entityId},overflow:"auto",position:"fixed",width:K,children:(0,O.jsx)(eh,{cropArea:e,cropSource:t,description:u.description??"",descriptorModules:r,height:E,imageContainerX:b,imageContainerY:F,imageSignature:u.imageSignature||"",imageUrl:M,pinKey:u,showAnimation:!T,trafficSource:o,viewParameter:U,viewType:N,width:Z})}),(0,O.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{top:a?0:eI,left:$,right:$}},paddingX:ek.jC,position:"relative",width:B,children:(0,O.jsx)(eS,{auxData:W,isProductOnlyFeed:a,oneBarModules:n,pinKey:u,viewParameter:U,viewType:N,visualSearchFlashlightUnifiedResource:d})})]})})})}var eZ=a(919203),eE=a(261954),eM=a(906127),eD=a(730448),eL=a(31863),eK=a(285676),eA=a(645479),e$=a(573217),ez=a(79271),eB=a(222451),eO=a(349937);let eN=(void 0!==o||(o=a(292297)).hash&&"b1061aefab46af37d4c9716916386af2"!==o.hash&&console.error("The definition of 'VisualSearchCarousel_story' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o);function eU({componentType:e,hasActionCTA:t,legacyStory:a,searchIdentifier:n,storyKey:i,trafficSource:l,viewParameter:r,viewType:s}){(0,m.useEffect)(()=>{(0,h.Z)("VisualSearchCarousel","/app/www/VisualSearch/VisualSearchCarousel.tsx")},[]);let o=(0,P.TH)(),d=(0,x.Z)(eN,i),u=(0,ez.ZP)({clientTrackingParams:d?.trackingParams,componentType:e,contextLogData:{story_id:d?.storyId,story_type:d?.storyType,content_ids:d?.contentIds},impressionType:"Story",loggingId:d?.storyId,slotIndex:0,viewParameter:r,viewType:s}),c=(0,m.useCallback)(({item:e,index:a})=>{if(t&&d.objects&&a===d.objects.length-1){let t=e.images?.["236x"]?.url,a=o.pathname+"products/"+o.search;return t&&(0,O.jsx)(eB.Z,{buttonText:d.action?.text||"See more",component:14339,dataTestId:"shop-action-item-button",element:179,imageWidth:e$.Z,previewImageSrc:t,storyId:d.storyId??void 0,storyType:d.storyType,url:a,view:s,viewParameter:r})}return(0,O.jsx)(eK.r,{componentType:14339,isInDesktopCarousel:!0,pinId:e.id||"",pinImageCrop:{width:e$.Z,height:e$.Z},pinKey:null,slotIndex:a,surface:"VisualInspirationShoppingPin",trafficSource:l,viewData:{search_identifier:n},viewParameter:r,viewType:s})},[t,d.objects,d.action?.text,d.storyId,d.storyType,l,n,r,s,o.pathname,o.search]),p=a?.objects?.filter(e=>"pin"===e.type);return p&&0!==p.length?(0,O.jsx)(y.xu,{ref:u,"data-test-id":"visual-search-carousel",children:(0,O.jsx)(eO.Z,{items:p,itemWidth:e$.Z,renderItem:c,showBorder:!0,showMarkers:!0,storyKey:d,view:s,viewParameter:r})}):null}function eW({auxData:e,isProductOnlyFeed:t,oneBarModules:a,trafficSource:n,viewParameter:i,viewType:l,visualSearchFlashlightUnifiedResource:r}){(0,m.useEffect)(()=>{(0,h.Z)("VisualSearchFeed","/app/www/VisualSearch/VisualSearchFeed.tsx")},[]);let s=(0,v.Z)(),{logContextEvent:o}=(0,$.u)(),d=(0,m.useRef)(!1),u=(0,m.useRef)(null),{checkExperiment:c}=(0,J.Z)(),p=c("web_pin_grid_last_visited").anyEnabled,g=!t&&a&&a.length>0,{data:f,isFetching:x,fetchMore:_,isAtEnd:S}=r,{results:w=[],search_identifier:b}=f||{};e_({itemCount:w.length});let{action:k,objects:P}=w.find(e=>"story"===e.type&&"stela_shop"===e.story_type)||{},{text:F,url:C}=k||{},j=P?.length||0,I=!!(F&&C),R=(0,eD.Z)(()=>{d.current||(o({event_type:110,view_type:l,view_parameter:i}),d.current=!0)},1e3),T=(0,m.useCallback)(({data:a,itemIdx:r})=>{if("story"===a.type)return"unified_entry_point_flashlight_header"===a.story_type?null:(0,O.jsx)(eU,{auxData:e,componentType:14339,hasActionCTA:I,legacyStory:a,searchIdentifier:b,storyKey:{type:"Legacy",data:a},trafficSource:n,viewParameter:i,viewType:l});if("pin"===a.type){let s=+!!I,o=(0,O.jsx)(eK.r,{auxData:e,componentType:0,pinId:a.id,pinKey:null,slotIndex:r+j-s,surface:t?"ShoppingDynamicHeightGrid":"SearchItem",trafficSource:n,viewData:{search_identifier:b},viewParameter:i,viewType:l});return p?(0,O.jsx)(eA.Z,{children:o}):o}return null},[e,b,n,l,i,I,j,t,p]),Z=(0,m.useCallback)(e=>"story"!==e.type,[]);return(0,O.jsxs)(m.Fragment,{children:[g&&(0,O.jsx)(eL.Z,{position:"sticky",shouldShowShadow:!0,children:(0,O.jsx)(ex.v,{children:(0,O.jsx)(ey.f,{children:(0,O.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{paddingInlineEnd:"8px"}},children:(0,O.jsx)(em.default,{itemHeight:48,marginBottom:0,oneBarModulesKey:null,oneBarModulesRest:a,paddingBottom:12,paddingX:3})})})})}),(0,O.jsx)(y.xu,{ref:u,"data-test-id":"visual-search-feed",onScroll:R,overflow:"hidden",children:(0,O.jsx)(eM.Z,{isAtEndOfFeed:S,itemCount:w.length,children:(0,O.jsx)(eE.default,{align:t?"center":"start",getColumnSpanConfig:e=>{let t="story"===e.type&&e.display_options?.num_columns_requested;return 0===t?1/0:t||1},isFetching:x,isLoadedAccessibilityLabel:s._('Visual search results loaded', 'visualSearch.masonry.loaded.label', 'Accessibility label when masonry has finished loading'),isLoadingAccessibilityLabel:s._('Loading visual search results', 'visualSearch.masonry.loading.label', 'Accessibility label for masonry loading state'),isLoadingStateEnabled:!0,items:w,layout:"basic",loadItems:_,minCols:1,renderItem:T,scrollContainer:()=>u.current??window,virtualize:Z})})})]})}var eV=a(911953);let eH=(void 0!==d||(d=a(97004)).hash&&"8250aa2ed9c603023c2f2a226d0b9fbb"!==d.hash&&console.error("The definition of 'VisualSearchImageContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),d);function eG({cropArea:e,cropSource:t,descriptorModules:a,pinKey:n,trafficSource:i,viewParameter:l,viewType:r}){(0,m.useEffect)(()=>{(0,h.Z)("VisualSearchImageContainer","/app/www/VisualSearch/VisualSearchImageContainer.tsx")},[]);let s=(0,eC.t)(),o=(0,ej.Z)(),{imageContainerScrollTop:d,imageContainerScrollTopForPinId:u}=(0,ew._)(),c=(0,m.useRef)(null),p=(0,m.useRef)(null),[g,f]=(0,m.useState)(0),[_,v]=(0,m.useState)(0),[S,w]=(0,m.useState)(0),{scrollCropperInView:b}=(0,eV.Z)({scrollContainerRef:c}),k=(0,x.Z)(eH,n),{defaultColor:P,selectedColor:F,hoveredColor:C,pressedColor:j}=(0,G.Z)(k.dominantColor),I=E.M/(k?.image?.width??1)*(k?.image?.height??1),R=k?.image?.url??"",T=E.M+E.nn,{onImageLoad:Z}=X({containerRef:p}),{isDescriptorAvailable:M,descriptorModuleHeight:D,descriptorBottomBorderRadius:L}=function({imageContainerRef:e,descriptorModules:t}){let a=!!t?.length,n=64*!!a;return a&&e.current?{isDescriptorAvailable:a,descriptorModuleHeight:n,descriptorBottomBorderRadius:function(e){let t=e.scrollTop,a=e.scrollHeight-e.clientHeight-t;return 24*(61<a&&a<67)}(e.current)}:{isDescriptorAvailable:a,descriptorModuleHeight:n,descriptorBottomBorderRadius:0}}({imageContainerRef:c,descriptorModules:a}),A=(0,m.useCallback)(()=>{let e=c.current;if(e){let{x:t,y:a}=e.getBoundingClientRect();f(t),v(a-e.scrollTop)}w(16*(I>=window.innerHeight-s&&!M))},[s,I,M]),$=(0,m.useCallback)(()=>{A(),d.current=c.current?.scrollTop||0,u.current=k.entityId},[A,k.entityId,d,u]);return(0,z.Z)(()=>{let e=c.current;if(!e)return;let t=d.current,a=u.current;return 0!==t&&a===k.entityId&&(e.scrollTop=t),A(),window.addEventListener("mousemove",b),()=>{window.removeEventListener("mousemove",b)}}),(0,O.jsxs)(m.Fragment,{children:[(0,O.jsx)(y.xu,{ref:c,bottom:!0,dangerouslySetInlineStyle:{__style:{top:s,insetInlineStart:o,height:`min(${I}px, calc(100vh - ${s}px))`,paddingBottom:`${S}px`}},"data-test-id":"visual-search-image-container",marginStart:E.tX,onScroll:$,overflow:"auto",position:"fixed",width:T,children:(0,O.jsx)(y.xu,{"data-test-id":"flashlight-enabled-image",height:I+D,width:E.M,children:(0,O.jsxs)(y.zd,{height:I,rounding:E.$V,width:E.M,children:[(0,O.jsx)(K.Z,{_enableViewTransitions:!0,type:"image",children:(0,O.jsx)(y.xu,{ref:p,children:(0,O.jsx)(y.Ee,{alt:k.description??"",naturalHeight:I,naturalWidth:E.M,onLoad:Z,src:R})})}),(0,O.jsx)(ep,{cropArea:e,cropSource:t,imageContainerX:g,imageContainerY:_,imageSize:{height:I,width:E.M},pinKey:k,trafficSource:i,viewParameter:l,viewType:r})]})})}),(0,O.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{top:s,insetInlineStart:o}},"data-test-id":"visual-search-cancel-button-container",marginStart:E.Qs,marginTop:E.qN,position:"fixed",children:(0,O.jsx)(q.Z,{defaultPillColor:P,hoveredPillColor:C,pressedPillColor:j,viewParameter:l,viewType:r})}),M&&(0,O.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{top:`min(${s+I-D}px, calc(100vh - ${D}px))`,insetInlineStart:o,borderRadius:`0 0 ${L}px ${L}px`}},"data-test-id":"visual-search-descriptor-container",height:D,marginStart:E.tX,overflow:"hidden",position:"fixed",width:E.M,children:(0,O.jsx)(H,{defaultPillColor:P,descriptorModules:a??[],hoveredPillColor:C,isWebImageSearchRedesign:!0,pinKey:k,pressedPillColor:j,selectedPillColor:F})}),(0,O.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{boxSizing:"content-box"}},"data-test-id":"visual-search-image-container-placeholder",height:1,marginStart:E.tX,minWidth:T})]})}let eY=(void 0!==u||(u=a(716635)).hash&&"3c3f391c3bf9eec79c18ed9a3fe63800"!==u.hash&&console.error("The definition of 'VisualSearchLayout_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),u);function eX({cropArea:e,cropSource:t,isProductPage:a,oneBarModules:n,pinKey:i,searchId:l,descriptorModules:r,trafficSource:s,visualSearchFlashlightUnifiedResource:o}){(0,m.useEffect)(()=>{(0,h.Z)("VisualSearchLayout","/app/www/VisualSearch/VisualSearchLayout.tsx")},[]);let d=(0,x.Z)(eY,i),u=(0,v.Z)(),c=u._('Shop similar', 'visualSearch.productPage.header', 'Shop similar visual searched items.'),{viewType:p,viewParameter:g}=eF({cropSource:t}),f={commerce_data:JSON.stringify({is_product_only_feed:a})};return(0,O.jsx)(eP.Z,{objectId:l,view:p,children:(0,O.jsxs)(eb.Z,{log:{aux_data:f,view_type:p,view_parameter:g},children:[a?(0,O.jsx)(L.Z,{isProductPage:!0,title:c,viewParameter:g,viewType:p}):(0,O.jsx)(eZ.Z,{text:u._('Image Search Page', 'imageSearch.accessibilityHiddenHeading', 'Accessibility label for image search page')}),(0,O.jsxs)(y.kC,{children:[!a&&(0,O.jsx)(eG,{cropArea:e,cropSource:t,descriptorModules:r,pinKey:d,trafficSource:s,viewParameter:g,viewType:p}),(0,O.jsx)(y.kC.Item,{flex:"grow",children:(0,O.jsx)(eW,{auxData:f,isProductOnlyFeed:a,oneBarModules:n,trafficSource:s,viewParameter:g,viewType:p,visualSearchFlashlightUnifiedResource:o})})]})]})})}let eq=(void 0!==c||(c=a(261717)).hash&&"ece11b62e2de551b92d24a2389316249"!==c.hash&&console.error("The definition of 'VisualSearchPageWithPinData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),c);function eQ({pinKey:e}){let t,a,n=(0,P.TH)(),i=(0,x.Z)(eq,e),l=(0,M.D)(),{getNormalizedPinImage:r}=(0,I.Z)({pinKey:i,maxWidth:l?E.M:j.Wm}),{cropSource:s,entrypoint:o,full_feed_title:d="",filters:u,hybrid_search_param:c,journey_depth:p,search_query:g,source_module_id:h,selected_descriptors:y,requestParams:f,rs:_}=(0,R.mB)(n.search);if(l)a=E.M/(i?.image?.width??1)*(i?.image?.height??1),t=E.M;else{let{height:e,width:n}=r();a=e,t=n}let v=(0,m.useMemo)(()=>(0,F.Z)(n,t,a)??{x:0,y:0,w:t,h:a},[n,t,a]),S=(0,T.Z)(Number(s))||5,w=n.pathname.includes("/products"),{searchId:b,visualSearchFlashlightUnifiedResource:k,oneBarModules:D,descriptorModules:L}=(0,C.Z)({resourceOptions:{crop:(0,Z.Z)({cropArea:v,scaledWidth:t,scaledHeight:a}),crop_source:S,entry_source:w?"shopping":"flashlight",entrypoint:o||w&&"feed_module"||null,field_set_key:"shopping_grid_item",image_signature:i.imageSignature||void 0,is_shopping:w,pin_id:i.entityId,request_params:f,source:_,filters:u,hybrid_search_param:c,selected_descriptors:y,journey_depth:parseInt(p,10)||void 0,search_query:g,source_module_id:h}});return i?(0,O.jsx)(l?eX:eT,{cropArea:v,cropSource:S,descriptorModules:L,isProductPage:w,oneBarModules:D,pinKey:i,searchId:b,title:d,trafficSource:_,visualSearchFlashlightUnifiedResource:k}):null}function eJ({pinKey:e}){return(0,m.useEffect)(()=>{(0,h.Z)("VisualSearchPageWithPinData","/app/www/VisualSearch/VisualSearchPageWithPinData.tsx")},[]),(0,O.jsx)(M.h,{children:(0,O.jsx)(eQ,{pinKey:e})})}var e0=a(520803);let e1=(void 0!==p||(p=a(579174)).hash&&"0f7b98a1f02dbf8528df0452aa26efd4"!==p.hash&&console.error("The definition of 'RelatedProductsPageQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),p),e2=(void 0!==g||(g=a(271128)).hash&&"91d05676e413b7b47653c2f8fa609093"!==g.hash&&console.error("The definition of 'RelatedProductsPage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),g);function e6({pinId:e,relatedProductsDataRef:t}){let a=(0,v.Z)(),n=(0,_.Z)({strategy:"Legacy",query:e1,variables:{pinId:e},useGetLegacyData:()=>{let{data:e}=(0,S.Z)(t);return e}}),i=n?.v3GetPinQuery?.__typename==="V3GetPin"?n.v3GetPinQuery.data:null,l=(0,x.Z)(e2,i);return(0,O.jsx)(m.Suspense,{fallback:(0,O.jsx)(y.xH,{accessibilityLabel:a._('Loading Pin data', 'RelatedProductsPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0}),children:l&&(0,O.jsx)(eJ,{pinKey:l})})}function e3(){(0,m.useEffect)(()=>{(0,h.Z)("RelatedProductsPage","/app/www/pages/authDesktop/RelatedProductsPage.tsx")},[]);let e=(0,e0.Z)(),{pinId:t}=(0,b.Z)(e.params.id||""),{ref:a}=(0,w.Z)({name:"PinResource",options:{id:t,field_set_key:"detailed"}});return(0,O.jsx)(f.Z,{name:"RelatedProductsPage_RelatedProductsPageWrapper",children:(0,O.jsx)(m.Suspense,{fallback:(0,O.jsx)(k.Z,{}),children:(0,O.jsx)(e6,{pinId:t,relatedProductsDataRef:a})})})}},658337:function(e,t,a){a.d(t,{J:()=>h,Z:()=>x});var n=a(250026),i=a(184661),l=a(42676),r=a(830949),s=a(407775),o=a(210730),d=a(438274);let u=new Set(["PinResource","RepinResource"]),c={ApiResource:e=>e?.url==="/v3/orientation/nux_creator_recommendations/"?"nux-creator-recommendations":e?.url==="/v3/users/me/interests/"?`recommended-interests:${e.data?.blend_type}`:e?.url===`/v3/usecases/${e.data?.use_case_id}/feed/`?"useCaseFeed":e?.url===`/v3/boards/${e.data?.board_id}/automagical/pins/`?`automagical-board-feed:${e.data?.board_id}`:e?.url===`/v3/aggregated_pin_data/${e.data?.aggregated_pin_data}/comments/`?`aggregated-comments:${e.data?.aggregated_pin_data}`:e?.url==="/v3/users/me/boards/archived/"?"archived-boards":"",AggregatedActivityFeedResource:e=>`trieditfeed:${e.aggregated_pin_data_id}`,AggregatedCommentReplyFeedResource:e=>`${d.Z.AGGREGATED_COMMENT_REPLIES}:${e.objectId}`,BoardlessPinsResource:e=>`boardless-pins:${e.userId}`,BestPinsFeedAltResource:e=>`idea-page-best-pins:${e.interest}`,BoardContentRecommendationResource:e=>`recommendation-feed:${e.id}`,BoardFeedResource:e=>`boardfeed:${e.board_id}`,BoardSectionsRepinResource:e=>`board-sections:${e.board_id}`,BoardSectionsResource:e=>`board-sections:${e.board_id}`,BoardSectionPinsResource:e=>`board-section-pins:${e.section_id}`,BoardsFeedResource:e=>`profile-boards:${e.username}`,BoardToolsFeedResource:e=>`board-tools:${e.boardId}`,ConversationsResource:()=>"conversations",DidItUserFeedResource:e=>`profile-tried:${e.username}`,InterestResource:e=>`klp-pins:${e.interest}`,MoreIdeasTabsBoardsResource:()=>"homefeed-more-ideas-tabs",NewsHubResource:()=>"notifications",NewsHubDetailsResource:e=>`newshubdetail:${e.news_id}`,NuxInterestsResource:()=>"nuxTopics",PinsFromBrandResource:e=>`brand-pins:${e.pin}`,ReactionsResource:e=>`reactions:${e.pin_id}`,RelatedArticlesResource:e=>`related-articles:${e.article_id}`,RelatedModulesResource:e=>`related-modules:${e.pin_id}`,RelatedPinFeedResource:e=>`related-pins:${e.pin}`,RelatedStreamResource:e=>`related-story-pins:${e.pinId}`,SearchResource:e=>`search:${(0,l.Tb)(e)}`,BaseSearchResource:e=>`search:${(0,l.Tb)(e)}`,SectionToolsFeedResource:e=>`section-tools:${e.sectionId}`,ShareSuggestionsTypeaheadResource:e=>`share-suggestions:${e.board||e.user}:${e.term}`,StoryFeedResource:e=>`story-feed:${e.feed_type}:${e.request_params}`,StoryPinTaggedProductsResource:()=>"story-pin-tagged-products",TodayArticleFeedResource:e=>`today-article:${e.id}`,TodayTabInterestFeedResource:e=>`today-article-interestfeed:${e.interest_id}`,TodayTabResource:()=>"today-tab",SeoTier1CandidateResource:()=>"tier1-feed",UnifiedCommentsResource:e=>`unified-comments:${e.aggregated_pin_id}`,UserActivityPinsResource:e=>`profile-pins-feed:${e.user_id}`,UserHomefeedResource:e=>e.pin_quiz?"pin-quiz":"homefeed",UserFollowingResource:e=>`user-following:${e.username}`,UserRecentActivityResource:e=>`user-recent-activity:${e.filter_type}`,UserStoryPinsFeedResource:e=>`story-pins-feed:${e.user_id}`,VisualLiveSearchResource:e=>`visual-search:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualLiveSearchProductFeedResource:e=>`visual-search-products:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualSearchFlashlightUnifiedResource:e=>`related-products-unified:${e.pin_id}`,InterestFollowingResource:e=>`topic-following:${e.username}`,UserPinsResource:e=>`profile-pins:${e.username}`,TopicFeedResource:e=>e.best_pins?`best-topic-pins:${e.interest}`:`topic-pins:${e.interest}`},p={AggregatedActivityFeedResource:({options:{aggregated_pin_data_id:e}})=>({type:d.Z.TRIED_IT_FEED,id:e}),AggregatedCommentReplyFeedResource:({options:{isUnifiedComment:e,objectId:t}})=>({type:e?d.Z.AGGREGATED_COMMENT_REPLIES:d.Z.AGGREGATED_COMMENTS,id:t,reversed:!0}),ApiResource:({options:{url:e,data:t}})=>e===`/v3/usecases/${t?.use_case_id}/feed/`?{type:d.Z.USE_CASE_TAB,id:t.use_case_id}:e===`/v3/boards/${t?.board_id}/automagical/pins/`?{type:d.Z.AUTOMAGICAL_BOARD_FEED,id:t.board_id}:e===`/v3/aggregated_comments/${t.aggregated_comment}/replies/`?{type:t.isUnifiedComment?d.Z.AGGREGATED_COMMENT_REPLIES:d.Z.AGGREGATED_COMMENTS,id:t.aggregated_comment,reversed:!0}:e===`/v3/aggregated_pin_data/${t?.aggregated_pin_data}/comments/`?{type:d.Z.AGGREGATED_COMMENTS,id:t.aggregated_pin_data}:null,BoardFeedResource:({options:{board_id:e}})=>({type:d.Z.BOARDFEED,id:e}),BoardlessPinsResource:({options:{userId:e}})=>({type:d.Z.BOARDLESS_PINS,id:e}),BoardSectionPinsResource:({options:{section_id:e}})=>({type:d.Z.BOARD_SECTION_PINS,id:e}),BoardSectionsResource:({options:{board_id:e}})=>({type:d.Z.BOARD_SECTIONS,id:e}),BoardsResource:({options:{username:e,sort:t,filter_types:a}})=>({type:d.Z.PROFILE_BOARDS,id:(0,r.Z)(e,t,a)}),BaseSearchResource:({options:e,response:t})=>({type:d.Z.SEARCH_PINS,id:(0,l.Tb)(e),items:t.resource_response.data?.results||[]}),DidItCommentsResource:({options:{objectId:e}})=>({type:d.Z.AGGREGATED_COMMENTS,id:e,reversed:!0}),DidItUserFeedResource:({options:{username:e}})=>({type:d.Z.TRIED_IT_FEED,id:e}),RelatedArticlesResource:({options:{article_id:e}})=>({type:d.Z.TODAY_TAB,id:e}),StoryPinDraftsResource:({options:{userId:e}})=>({type:d.Z.STORY_PIN_DATA,id:e}),TodayTabInterestFeedResource:({options:{interest_id:e}})=>({type:d.Z.TODAY_ARTICLE_INTEREST_FEED,id:e}),TodayTabResource:()=>({type:d.Z.TODAY_TAB,id:"todayTab"}),UnifiedCommentsPreviewResource:({options:{aggregated_pin_id:e}})=>({type:d.Z.UNIFIED_COMMENTS,id:e}),UnifiedCommentsResource:({options:{aggregated_pin_id:e,is_reversed:t}})=>({type:d.Z.UNIFIED_COMMENTS,id:e,reversed:t}),UserActivityPinsResource:({options:{user_id:e}})=>({type:d.Z.PROFILE_PINS_FEED,id:e}),UserStoryPinsFeedResource:({response:e,options:{user_id:t}})=>({type:d.Z.STORY_PINS_FEED,id:t,items:e.resource_response.data||[]})},g=(e,{pinId:t,oldFeedId:a,newFeedId:n})=>a===n?e:((e,{pinId:t,feedId:a})=>e[a]?{...e,[a]:[{type:"pin",id:t},...e[a]]}:e)(((e,{pinId:t,feedId:a})=>e[a]?{...e,[a]:e[a].filter(e=>"pin"!==e.type||e.id!==t)}:e)(e,{pinId:t,feedId:a}),{pinId:t,feedId:n}),h=(e,t)=>e in c?c[e](t):null,m=(e,t)=>t?`board-section-pins:${t}`:`boardfeed:${e}`,y=(e,t)=>e.map(e=>{let{id:a,schema:n,type:i}=e;return"home_feed_tabs"===i?e:n?{id:a,type:n,trackingParams:"pin"===n?t.pins[a].tracking_params:void 0,user_id:void 0}:null}).filter(Boolean),f=(e,t,a)=>Object.keys(e).reduce((n,i)=>{let l=e[i]||[],r=l.filter(e=>{if(e.type!==t)return!0;if("reaction"===t){let t=e.id.lastIndexOf(":");return e.id.substring(0,t)!==a}return e.id!==a});return l.length!==r.length&&(n[i]=r),n},{...e}),x=(e={},t)=>{switch(t.type){case i.zP:case i.aW:{let{payload:a}=t,{resource:n,options:l,normalizedResponse:r,schema:u}=a;if(r&&n in c){let a=((e,t,a)=>{let n=a||s.Z[e];if(n===o.LR)return t.result;if(n===o.sN)return t.result.map(e=>({id:e,schema:"board"}));if(n===o.Gn)return t.result.map(e=>({id:e,schema:"user"}));if(n===o.Ht)return t.result.map(e=>({id:e,schema:"invite"}));if(n===o.fE)return t.result.map(e=>({id:e,schema:"reaction"}));if("object"==typeof n){let e=Object.entries(n).find(([,e])=>e===o.LR);if(e)return t.result[e[0]]}return null})(n,r,u);if(a&&Array.isArray(a)){let s=c[n](l);if("BoardToolsFeedResource"===n||"SectionToolsFeedResource"===n)return{...e,[s]:a};if("UnifiedCommentsResource"===n){let n=y(a,r.entities);if(e[s]&&(i.zP||i.aW===t.type))return{...e,[s]:[...e[s],...n]};return{...e,[s]:n}}{let n=[...t.type===i.aW&&e[s]||[],...y(a,r.entities)];return{...e,[s]:n}}}}else{let{data:n}=a.response.resource_response;if(!a.options?.redux_normalize_feed)return e;let l=p[a.resource]({options:a.options,response:a.response});if(l){let{type:a,id:r,items:s,reversed:o}=l,u=(s||n||[]).filter(Boolean).map(e=>((e,t)=>{switch(e.type){case"story":return{id:e.id??"",type:"story",story_type:e.story_type??""};case"module":return{id:e.id,type:"module",name:e.name};case"user":return{id:e.id,type:"user"};case"board":return t===d.Z.PROFILE_BOARDS?{id:e.id,type:"board",onProfile:!0,profileGroup:e.archived_by_me_at?"archived":e.privacy||"public"}:{id:e.id,type:"board",onProfile:!1};case"board_section":return{type:"boardsection",id:e.id};case"triedit":return{type:"triedit",id:e.id};case"aggregatedcomment":return{type:"aggregatedcomment",id:e.id};case"home_feed_tab":return{type:"home_feed_tab",id:e.id,name:e.name};case"storypindata":return{id:e.id,type:"storypindata"};case"todayarticle":return{type:"todayarticle",id:e.id};case"unifiedcommentspreview":return"userdiditdata"===e.unified_comment.type?{type:"triedit",id:e.unified_comment.id}:{type:"aggregatedcomment",id:e.unified_comment.id};default:let a="useCaseFeed"===t&&"tracking_params"in e;return{type:"pin",id:e.id??"",...a&&{trackingParams:e.tracking_params}}}})(e,a));o&&(u=u.reverse());let c=`${a}:${r}`,p=e[c];if(p||t.type!==i.aW){let a=p||[],n=u;return t.type===i.aW&&(n=o?u.concat(a):a.concat(u)),{...e,[c]:n}}}}break}case"FEED_ITEM_REORDERED":{let{payload:{feedType:a,feedId:i,itemType:l,targetItemId:r,sourceItemId:s}}=t,o=`${a}:${i}`,u=e[o]||[],c=-1,p=-1;if([d.Z.BOARDFEED,d.Z.BOARD_SECTION_PINS,d.Z.BOARD_SECTIONS,"profileBoards"].includes(a)&&(c=u.findIndex(e=>e.type===l&&e.id===s),p=u.findIndex(e=>e.type===l&&e.id===r)),-1!==c&&-1!==p)return{...e,[o]:(0,n.Z)(u,c,p)};break}case"FEED_ITEMS_REMOVED":{let{payload:{feedType:a,feedId:n,inverseSelection:i,itemType:l,itemIds:r=[]}}=t,s=`${a}:${n}`,o=e[s]||[];if(o&&o.length>0&&(a===d.Z.BOARD_SECTION_PINS||a===d.Z.BOARDFEED)){let t=o.filter(e=>{let t=r.includes(e.id);return!(e.type===l&&(i&&!t||!i&&t))}),a=!!t.find(e=>"pin"===e.type);return{...e,[s]:a?t:[]}}if(o&&o.length>0&&a===d.Z.BOARD_SECTIONS||o&&o.length>0&&(a===d.Z.AGGREGATED_COMMENTS||a===d.Z.BOARDLESS_PINS||a===d.Z.PROFILE_PINS_FEED||a===d.Z.STORY_PINS_FEED||a===d.Z.UNIFIED_COMMENTS||a===d.Z.TRIED_IT_FEED||a===d.Z.STORY_PIN_DATA)){let t=o.filter(e=>{let t=r.includes(e.id);return!(e.type===l&&t)});return{...e,[s]:t}}break}case"FEED_ITEMS_ADDED":{let{payload:{feedType:a,feedId:n,itemType:i,itemIds:l=[],prepend:r}}=t,s=`${a}:${n}`,o=e[s]||[];if(o&&(a===d.Z.BOARD_SECTION_PINS||a===d.Z.BOARDFEED||a===d.Z.BOARDLESS_PINS)){let t=l.map(e=>({id:e,type:i})),a=0;"story"===(o[0]||{}).type&&(a=1),"story"===(o[1]||{}).type&&(a=2);let n=[...o.slice(0,a),...t,...o.slice(a)];return{...e,[s]:n}}if(o&&a===d.Z.BOARD_SECTIONS){let t=[...l].reverse().map(e=>({id:e,type:"boardsection"})),a=o?[...t,...o]:[...t];return{...e,[s]:a}}if(a===d.Z.AGGREGATED_COMMENTS||a===d.Z.AGGREGATED_COMMENT_REPLIES||a===d.Z.PROFILE_PINS_FEED||a===d.Z.STORY_PINS_FEED||a===d.Z.UNIFIED_COMMENTS){let t=l.map(e=>({id:e,type:i})),a=o?[...r?t:o,...r?o:t]:t;return{...e,[s]:a}}if(a===d.Z.TRIED_IT_FEED){let t=l.map(e=>({id:e,type:i})),a=o?[...t,...o]:t;return{...e,[s]:a}}break}case"FEED_INVALIDATE":{let{payload:{feedType:a,feedId:n}}=t,i=`${a}:${n}`;return e[i],{...e,[i]:null}}case"APPEND_FEED_ITEMS":{let{payload:{id:a,items:n,options:i}}=t,l=e[a];if(!l)return{...e,[a]:n};{let t;return t=i.isPrepend?l[0]&&"story"===l[0].type?[].concat(l[0],n,l.slice(1)):n.concat(l):l.concat(n),{...e,[a]:t}}}case"PIN_DELETE":{let{payload:{pinId:a}}=t;return f(e,"pin",a)}case"BOARD_ARCHIVE":{let{payload:{boardId:a,username:n}}=t,i=`profile-boards:${n??""}`;if(e[i])return{...e,[i]:e[i].filter(e=>e.id!==a)};break}case"BOARD_UNARCHIVE":{let{payload:{boardId:a}}=t,n="archived-boards";if(e[n])return{...e,[n]:e[n].filter(e=>e.id!==a)};break}case"BOARD_DELETE":{let{payload:{boardId:a}}=t;return f(e,"board",a)}case"BOARD_SECTION_DELETE":{let{payload:{boardSectionId:a}}=t;return f(e,"boardsection",a)}case"PINS_MOVE":{let{payload:{source:a,target:n,pinIds:i,userId:l}}=t,r=a.boardlessPins&&l&&`boardless-pins:${l}`||a.boardId&&m(a.boardId,a.sectionId),s=m(n.boardId,n.sectionId);return i.reduce((e,t)=>g(e,{pinId:t,oldFeedId:r,newFeedId:s}),e)}case"PINS_MOVE_ALL":{let{payload:{source:a,target:n,excludePinIds:i}}=t,l=m(a.boardId,a.sectionId),r=m(n.boardId,n.sectionId),s={...e,[l]:i.map(e=>({type:"pin",id:e}))};return delete s[r],s}case"PIN_EDIT":{let{payload:{pinId:a,boardId:n,sectionId:i="",source:{boardId:l,sectionId:r}}}=t;return g(e,{pinId:a,oldFeedId:m(l,r),newFeedId:m(n,i)})}case i.AF:if(u.has(t.payload.resource)){let a,n=t.payload.response.resource_response.data,{board:i}=n;if("quick_saves"===i.layout)a=`boardless-pins:${t.payload.options.user_id}`;else{let e=t.payload.options.section;a=e?`board-section-pins:${e}`:`boardfeed:${i.id}`}if(e[a]){let t={...e},i={id:n.id,type:"pin",trackingParams:n?.tracking_params};return t[a]=[i].concat(e[a]),t}}if("BoardSectionResource"===t.payload.resource&&t.payload.normalizedResponse){let a=t.payload.normalizedResponse.result,n=t.payload.normalizedResponse.entities.boardsections[a].board,i=`board-sections:${n}`;if(e[i]){let t={...e};return t[i]=[{id:a,type:"boardsection"}].concat(e[i]),t}}if("AggregatedCommentResource"===t.payload.resource&&t.payload.normalizedResponse){let a={id:t.payload.normalizedResponse.result,type:"aggregatedcomment"},n={...e};for(let i of["aggregated-comments","unified-comments"]){let l=`${i}:${t.payload.options.objectId}`;e[l]&&(n={...n,[l]:[a].concat(n[l])})}return n}if("AggregatedCommentReplyResource"===t.payload.resource&&t.payload.normalizedResponse){let a=`${d.Z.AGGREGATED_COMMENT_REPLIES}:${t.payload.options.objectId}`;return{...e,[a]:[...e[a]||[],{id:t.payload.normalizedResponse.result,type:"aggregatedComment"}]}}if("ReactionsResource"===t.payload.resource&&t.payload.normalizedResponse){let{reaction_pin_id:a,reaction_type:n}=t.payload.options;if("reaction"===t.payload.options.action_type){let i=`reactions:${t.payload.options.pin_id}`,l={...e},r={id:`${a}:${t.payload.options.user_id}:${n}`,type:"reaction",trackingParams:void 0};return l[i]=[r].concat(e[i]),l}if("unreaction"===t.payload.options.action_type)return f(e,"reaction",`${a}:${t.payload.options.user_id}`)}}return e}},254889:function(e,t,a){a.r(t),a.d(t,{default:()=>_});var n=a(686659),i=a(667294),l=a(581722),r=a(312048),s=a(740097),o=a(4533),d=a(104999),u=a(746868),c=a(351736),p=a(24246),g=a(173874),h=a(34550),m=a(935833),y=a(736328),f=a(739405),x=a(785893);function _({alignIconLeft:e,bgColor:t,color:a,disableRedirect:_=!1,fallbackUrl:v,icon:S="arrow-back",onTouch:w,padding:b,placement:k,shouldUseFallbackUrl:P,size:F="lg",viewParameter:C,viewType:j,isVisualSearch:I}){(0,i.useEffect)(()=>{(0,n.Z)("BackButton","/app/www/routing/BackButton.tsx")},[]);let R=(0,p.Z)(),T=(0,r.s0)(),Z=(0,r.TH)(),E=(0,f.HG)(),M=(0,l.v9)(e=>e.session.isAuthenticated),D=(0,d.Z)(),L=(0,y.Z)(),K=(0,c.vs)(),{viewType:A,viewParameter:$}=(0,u.SU)(),[z,B]=j?[j,C]:[A,$],O=()=>{let e=(0,h.M0)().getItem(o.pm);Z.key||"/ideas"!==v?(0,m.My)(`pinner_conversion.back_button.${String(e?.[0].pageType)}`):(0,m.My)("pinner_conversion.back_button.no_history"),(0,m.My)(`web_back_button_click.${String(k)}.is_auth_${String(M)}`),L({action:"click",item:"back-button"}),z&&D({view_type:z,view_parameter:B,element:34,event_type:102}),w&&w(),_||((!Z.key||Z.state&&"redirect"===Z.state.referrer||P)&&v?T(v):Z.pathname.includes("/password/reset/")&&Z.search&&Z.search.includes("?nativeShouldDismiss=true")?T("/login/?dismissWebview=true"):T(-1))},N=K?c.t4:"white",U=(0,g.isBoardPage)(Z)||I||"white"===a;return(0,x.jsx)(s.xu,{"data-test-id":"back-button",children:e?(0,x.jsx)(s.xu,{alignItems:"center",display:"flex",height:48,marginStart:"cancel"===S?-1:-2,width:48,children:(0,x.jsx)(s.hU,{accessibilityLabel:R._('Back', 'navigation button', 'navigation button'),bgColor:t,icon:S,iconColor:!a&&(!t||["white","lightGray","transparent"].includes(t))?"subtle":a,onClick:O,padding:"auto"!==b?b:2,size:F})}):(0,x.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:E||U||t?"":N,width:K&&!U?"fit-content":""}},rounding:"circle",children:(0,x.jsx)(s.hU,{accessibilityLabel:R._('Back', 'navigation button', 'navigation button'),bgColor:t||E?t:"transparent",icon:S,iconColor:!a&&(!t||["white","lightGray","transparent"].includes(t))?"subtle":a,onClick:O,padding:"auto"!==b?b:2,size:F})})})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/51059-5ddbe2b852a44039.mjs.map